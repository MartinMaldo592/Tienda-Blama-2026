{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 4, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/Martin/Desktop/PROYECTOS/Tienda-Blama-2026/components/ui/card.tsx"],"sourcesContent":["import * as React from \"react\"\r\n\r\nimport { cn } from \"@/lib/utils\"\r\n\r\nfunction Card({ className, ...props }: React.ComponentProps<\"div\">) {\r\n  return (\r\n    <div\r\n      data-slot=\"card\"\r\n      className={cn(\r\n        \"bg-card text-card-foreground flex flex-col gap-6 rounded-xl border py-6 shadow-sm\",\r\n        className\r\n      )}\r\n      {...props}\r\n    />\r\n  )\r\n}\r\n\r\nfunction CardHeader({ className, ...props }: React.ComponentProps<\"div\">) {\r\n  return (\r\n    <div\r\n      data-slot=\"card-header\"\r\n      className={cn(\r\n        \"@container/card-header grid auto-rows-min grid-rows-[auto_auto] items-start gap-2 px-6 has-data-[slot=card-action]:grid-cols-[1fr_auto] [.border-b]:pb-6\",\r\n        className\r\n      )}\r\n      {...props}\r\n    />\r\n  )\r\n}\r\n\r\nfunction CardTitle({ className, ...props }: React.ComponentProps<\"div\">) {\r\n  return (\r\n    <div\r\n      data-slot=\"card-title\"\r\n      className={cn(\"leading-none font-semibold\", className)}\r\n      {...props}\r\n    />\r\n  )\r\n}\r\n\r\nfunction CardDescription({ className, ...props }: React.ComponentProps<\"div\">) {\r\n  return (\r\n    <div\r\n      data-slot=\"card-description\"\r\n      className={cn(\"text-muted-foreground text-sm\", className)}\r\n      {...props}\r\n    />\r\n  )\r\n}\r\n\r\nfunction CardAction({ className, ...props }: React.ComponentProps<\"div\">) {\r\n  return (\r\n    <div\r\n      data-slot=\"card-action\"\r\n      className={cn(\r\n        \"col-start-2 row-span-2 row-start-1 self-start justify-self-end\",\r\n        className\r\n      )}\r\n      {...props}\r\n    />\r\n  )\r\n}\r\n\r\nfunction CardContent({ className, ...props }: React.ComponentProps<\"div\">) {\r\n  return (\r\n    <div\r\n      data-slot=\"card-content\"\r\n      className={cn(\"px-6\", className)}\r\n      {...props}\r\n    />\r\n  )\r\n}\r\n\r\nfunction CardFooter({ className, ...props }: React.ComponentProps<\"div\">) {\r\n  return (\r\n    <div\r\n      data-slot=\"card-footer\"\r\n      className={cn(\"flex items-center px-6 [.border-t]:pt-6\", className)}\r\n      {...props}\r\n    />\r\n  )\r\n}\r\n\r\nexport {\r\n  Card,\r\n  CardHeader,\r\n  CardFooter,\r\n  CardTitle,\r\n  CardAction,\r\n  CardDescription,\r\n  CardContent,\r\n}\r\n"],"names":[],"mappings":";;;;;;;;;;;;;;;;;AAEA;;;AAEA,SAAS,KAAK,EAAE,SAAS,EAAE,GAAG,OAAoC;IAChE,qBACE,8OAAC;QACC,aAAU;QACV,WAAW,IAAA,kHAAE,EACX,qFACA;QAED,GAAG,KAAK;;;;;;AAGf;AAEA,SAAS,WAAW,EAAE,SAAS,EAAE,GAAG,OAAoC;IACtE,qBACE,8OAAC;QACC,aAAU;QACV,WAAW,IAAA,kHAAE,EACX,4JACA;QAED,GAAG,KAAK;;;;;;AAGf;AAEA,SAAS,UAAU,EAAE,SAAS,EAAE,GAAG,OAAoC;IACrE,qBACE,8OAAC;QACC,aAAU;QACV,WAAW,IAAA,kHAAE,EAAC,8BAA8B;QAC3C,GAAG,KAAK;;;;;;AAGf;AAEA,SAAS,gBAAgB,EAAE,SAAS,EAAE,GAAG,OAAoC;IAC3E,qBACE,8OAAC;QACC,aAAU;QACV,WAAW,IAAA,kHAAE,EAAC,iCAAiC;QAC9C,GAAG,KAAK;;;;;;AAGf;AAEA,SAAS,WAAW,EAAE,SAAS,EAAE,GAAG,OAAoC;IACtE,qBACE,8OAAC;QACC,aAAU;QACV,WAAW,IAAA,kHAAE,EACX,kEACA;QAED,GAAG,KAAK;;;;;;AAGf;AAEA,SAAS,YAAY,EAAE,SAAS,EAAE,GAAG,OAAoC;IACvE,qBACE,8OAAC;QACC,aAAU;QACV,WAAW,IAAA,kHAAE,EAAC,QAAQ;QACrB,GAAG,KAAK;;;;;;AAGf;AAEA,SAAS,WAAW,EAAE,SAAS,EAAE,GAAG,OAAoC;IACtE,qBACE,8OAAC;QACC,aAAU;QACV,WAAW,IAAA,kHAAE,EAAC,2CAA2C;QACxD,GAAG,KAAK;;;;;;AAGf"}},
    {"offset": {"line": 106, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/Martin/Desktop/PROYECTOS/Tienda-Blama-2026/components/product-image-carousel.tsx"],"sourcesContent":["\"use client\"\r\n\r\nimport { useEffect, useMemo, useRef, useState } from \"react\"\r\nimport type { PointerEvent as ReactPointerEvent } from \"react\"\r\nimport Image from \"next/image\"\r\nimport { cn } from \"@/lib/utils\"\r\nimport { ChevronLeft, ChevronRight } from \"lucide-react\"\r\n\r\ninterface ProductImageCarouselProps {\r\n  images: string[]\r\n  alt: string\r\n  className?: string\r\n  autoPlay?: boolean\r\n  intervalMs?: number\r\n  showControls?: boolean\r\n  priority?: boolean\r\n  sizes?: string\r\n  quality?: number\r\n}\r\n\r\nexport function ProductImageCarousel({\r\n  images,\r\n  alt,\r\n  className,\r\n  autoPlay = false,\r\n  intervalMs = 2500,\r\n  showControls = true,\r\n  priority = false,\r\n  sizes,\r\n  quality,\r\n}: ProductImageCarouselProps) {\r\n  const isLikelyImageUrl = (url: string) => {\r\n    const u = String(url || \"\").trim().toLowerCase()\r\n    if (!u) return false\r\n    if (u.startsWith(\"data:\")) return u.startsWith(\"data:image/\")\r\n    return !(\r\n      u.endsWith(\".mp4\") ||\r\n      u.endsWith(\".webm\") ||\r\n      u.endsWith(\".mov\") ||\r\n      u.endsWith(\".m4v\") ||\r\n      u.endsWith(\".avi\") ||\r\n      u.endsWith(\".mkv\")\r\n    )\r\n  }\r\n\r\n  const cleanImages = useMemo(() => {\r\n    const unique: string[] = []\r\n    for (const img of images || []) {\r\n      const v = String(img || \"\").trim()\r\n      if (!v) continue\r\n      if (!isLikelyImageUrl(v)) continue\r\n      if (!unique.includes(v)) unique.push(v)\r\n      if (unique.length >= 10) break\r\n    }\r\n    return unique\r\n  }, [images])\r\n\r\n  const [index, setIndex] = useState(0)\r\n\r\n  const containerRef = useRef<HTMLDivElement | null>(null)\r\n  const [isDragging, setIsDragging] = useState(false)\r\n  const [dragX, setDragX] = useState(0)\r\n\r\n  const pointerIdRef = useRef<number | null>(null)\r\n  const pointerStartXRef = useRef<number | null>(null)\r\n  const pointerStartYRef = useRef<number | null>(null)\r\n  const pointerMovedRef = useRef(false)\r\n  const pointerLastXRef = useRef<number | null>(null)\r\n  const pointerLastTRef = useRef<number | null>(null)\r\n  const pointerVxRef = useRef(0)\r\n\r\n  useEffect(() => {\r\n    setIndex(0)\r\n    setDragX(0)\r\n    setIsDragging(false)\r\n  }, [cleanImages.join(\"|\")])\r\n\r\n  useEffect(() => {\r\n    if (!autoPlay) return\r\n    if (cleanImages.length <= 1) return\r\n    if (isDragging) return\r\n\r\n    const id = window.setInterval(() => {\r\n      setIndex((prev) => {\r\n        if (prev >= cleanImages.length - 1) return 0\r\n        return prev + 1\r\n      })\r\n    }, intervalMs)\r\n\r\n    return () => window.clearInterval(id)\r\n  }, [autoPlay, cleanImages.length, intervalMs, isDragging])\r\n\r\n  if (cleanImages.length === 0) return null\r\n\r\n  const lastIndex = Math.max(0, cleanImages.length - 1)\r\n\r\n  const rubberBand = (dx: number, width: number) => {\r\n    if (!width) return dx * 0.35\r\n    const constant = 0.55\r\n    const abs = Math.abs(dx)\r\n    const sign = dx < 0 ? -1 : 1\r\n    return sign * (width * constant * abs) / (width + constant * abs)\r\n  }\r\n\r\n  const prev = () => {\r\n    setDragX(0)\r\n    setIndex((i) => Math.max(0, i - 1))\r\n  }\r\n\r\n  const next = () => {\r\n    setDragX(0)\r\n    setIndex((i) => Math.min(lastIndex, i + 1))\r\n  }\r\n\r\n  const onPointerDown = (e: ReactPointerEvent<HTMLDivElement>) => {\r\n    if (cleanImages.length <= 1) return\r\n    pointerIdRef.current = e.pointerId\r\n    pointerStartXRef.current = e.clientX\r\n    pointerStartYRef.current = e.clientY\r\n    pointerLastXRef.current = e.clientX\r\n    pointerLastTRef.current = Date.now()\r\n    pointerVxRef.current = 0\r\n    pointerMovedRef.current = false\r\n    setIsDragging(true)\r\n    setDragX(0)\r\n    try {\r\n      e.currentTarget.setPointerCapture(e.pointerId)\r\n    } catch (err) {\r\n    }\r\n  }\r\n\r\n  const onPointerMove = (e: ReactPointerEvent<HTMLDivElement>) => {\r\n    const sx = pointerStartXRef.current\r\n    const sy = pointerStartYRef.current\r\n    if (sx == null || sy == null) return\r\n\r\n    const dx = e.clientX - sx\r\n    const dy = e.clientY - sy\r\n\r\n    // Solo consideramos swipe si el movimiento es mayormente horizontal.\r\n    if (Math.abs(dx) > 8 && Math.abs(dx) > Math.abs(dy)) {\r\n      pointerMovedRef.current = true\r\n      // Evita selección/drag de la imagen cuando se intenta deslizar.\r\n      if ((e as any).cancelable) e.preventDefault()\r\n\r\n      const now = Date.now()\r\n      const lx = pointerLastXRef.current\r\n      const lt = pointerLastTRef.current\r\n      if (lx != null && lt != null) {\r\n        const dt = Math.max(1, now - lt)\r\n        pointerVxRef.current = (e.clientX - lx) / dt\r\n      }\r\n      pointerLastXRef.current = e.clientX\r\n      pointerLastTRef.current = now\r\n\r\n      const width = containerRef.current?.getBoundingClientRect().width || 0\r\n      if (index === 0 && dx > 0) setDragX(rubberBand(dx, width))\r\n      else if (index === lastIndex && dx < 0) setDragX(rubberBand(dx, width))\r\n      else setDragX(dx)\r\n    }\r\n  }\r\n\r\n  const onPointerUp = (e: ReactPointerEvent<HTMLDivElement>) => {\r\n    const sx = pointerStartXRef.current\r\n    const sy = pointerStartYRef.current\r\n    const pid = pointerIdRef.current\r\n    pointerStartXRef.current = null\r\n    pointerStartYRef.current = null\r\n    pointerIdRef.current = null\r\n    setIsDragging(false)\r\n\r\n    if (sx == null || sy == null) return\r\n    if (!pointerMovedRef.current) {\r\n      setDragX(0)\r\n      if (pid != null) {\r\n        try {\r\n          e.currentTarget.releasePointerCapture(pid)\r\n        } catch (err) {\r\n        }\r\n      }\r\n      return\r\n    }\r\n\r\n    const dx = e.clientX - sx\r\n    const dy = e.clientY - sy\r\n\r\n    const width = containerRef.current?.getBoundingClientRect().width || 0\r\n    const distanceThreshold = Math.max(60, width * 0.18)\r\n    const velocity = pointerVxRef.current\r\n    const velocityThreshold = 0.7\r\n\r\n    const shouldSnapByVelocity = Math.abs(velocity) >= velocityThreshold && Math.abs(dx) >= 10\r\n    const shouldSnapByDistance = Math.abs(dx) >= distanceThreshold\r\n\r\n    if ((!shouldSnapByVelocity && !shouldSnapByDistance) || Math.abs(dx) < Math.abs(dy)) {\r\n      setDragX(0)\r\n      if (pid != null) {\r\n        try {\r\n          e.currentTarget.releasePointerCapture(pid)\r\n        } catch (err) {\r\n        }\r\n      }\r\n      return\r\n    }\r\n    const dir = shouldSnapByVelocity ? (velocity > 0 ? 1 : -1) : (dx > 0 ? 1 : -1)\r\n    if (dir > 0) prev()\r\n    else next()\r\n\r\n    setDragX(0)\r\n    if (pid != null) {\r\n      try {\r\n        e.currentTarget.releasePointerCapture(pid)\r\n      } catch (err) {\r\n      }\r\n    }\r\n  }\r\n\r\n  return (\r\n    <div\r\n      ref={containerRef}\r\n      className={cn(\"group relative h-full w-full overflow-hidden select-none touch-pan-y\", className)}\r\n      onPointerDown={onPointerDown}\r\n      onPointerMove={onPointerMove}\r\n      onPointerUp={onPointerUp}\r\n      onPointerCancel={onPointerUp}\r\n    >\r\n      <div\r\n        className={cn(\r\n          \"flex h-full w-full\",\r\n          isDragging ? \"\" : \"transition-transform duration-300 ease-out\"\r\n        )}\r\n        style={{\r\n          transform: `translate3d(calc(${-index * 100}% + ${dragX}px), 0, 0)`,\r\n        }}\r\n      >\r\n        {cleanImages.map((src, i) => (\r\n          <div key={src} className=\"relative h-full w-full flex-none\">\r\n            <Image\r\n              src={src}\r\n              alt={alt}\r\n              fill\r\n              className=\"absolute inset-0 object-cover\"\r\n              priority={priority && i === 0}\r\n              sizes={sizes || \"(max-width: 640px) 50vw, (max-width: 1024px) 33vw, 20vw\"}\r\n              quality={quality}\r\n              draggable={false}\r\n              unoptimized={true}\r\n            />\r\n\r\n          </div>\r\n        ))}\r\n      </div>\r\n\r\n      {showControls && cleanImages.length > 1 && (\r\n        <>\r\n          <button\r\n            type=\"button\"\r\n            aria-label=\"Imagen anterior\"\r\n            onClick={(e) => {\r\n              e.preventDefault()\r\n              e.stopPropagation()\r\n              prev()\r\n            }}\r\n            className=\"absolute left-2 top-1/2 -translate-y-1/2 h-10 w-10 rounded-full bg-background/85 backdrop-blur border border-border shadow-md flex items-center justify-center opacity-100 md:opacity-0 md:group-hover:opacity-100 focus-visible:opacity-100 transition-opacity\"\r\n          >\r\n            <ChevronLeft className=\"h-5 w-5\" />\r\n          </button>\r\n\r\n          <button\r\n            type=\"button\"\r\n            aria-label=\"Imagen siguiente\"\r\n            onClick={(e) => {\r\n              e.preventDefault()\r\n              e.stopPropagation()\r\n              next()\r\n            }}\r\n            className=\"absolute right-2 top-1/2 -translate-y-1/2 h-10 w-10 rounded-full bg-background/85 backdrop-blur border border-border shadow-md flex items-center justify-center opacity-100 md:opacity-0 md:group-hover:opacity-100 focus-visible:opacity-100 transition-opacity\"\r\n          >\r\n            <ChevronRight className=\"h-5 w-5\" />\r\n          </button>\r\n\r\n          <div className=\"absolute bottom-2 left-1/2 -translate-x-1/2 flex items-center gap-1.5 opacity-100 md:opacity-0 md:group-hover:opacity-100 transition-opacity\">\r\n            {cleanImages.map((_, dotIndex) => (\r\n              <button\r\n                key={dotIndex}\r\n                type=\"button\"\r\n                aria-label={`Ir a imagen ${dotIndex + 1}`}\r\n                onClick={(e) => {\r\n                  e.preventDefault()\r\n                  e.stopPropagation()\r\n                  setIndex(dotIndex)\r\n                  setDragX(0)\r\n                }}\r\n                className={cn(\r\n                  \"h-1.5 w-1.5 rounded-full\",\r\n                  dotIndex === index ? \"bg-primary\" : \"bg-foreground/30\"\r\n                )}\r\n              />\r\n            ))}\r\n          </div>\r\n        </>\r\n      )}\r\n    </div>\r\n  )\r\n}\r\n"],"names":[],"mappings":"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"}},
    {"offset": {"line": 399, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/Martin/Desktop/PROYECTOS/Tienda-Blama-2026/components/product-card.tsx"],"sourcesContent":["\r\n\"use client\"\r\n\r\nimport Link from \"next/link\"\r\nimport { Button } from \"@/components/ui/button\"\r\nimport { Card, CardContent, CardFooter } from \"@/components/ui/card\"\r\nimport { Plus, Image as ImageIcon } from \"lucide-react\"\r\nimport { formatCurrency, slugify } from \"@/lib/utils\"\r\nimport { Database } from \"@/types/database.types\"\r\nimport { useCartStore } from \"@/features/cart\"\r\nimport { useState, useRef } from \"react\"\r\nimport { ProductImageCarousel } from \"@/components/product-image-carousel\"\r\nimport { useCartAnimationStore } from \"@/features/cart/cart-animation\"\r\n\r\ntype Product = Database['public']['Tables']['productos']['Row']\r\n\r\ninterface ProductCardProps {\r\n    product: Product\r\n    imagePriority?: boolean\r\n}\r\n\r\nexport function ProductCard({ product, imagePriority = false }: ProductCardProps) {\r\n    const addItem = useCartStore((state) => state.addItem)\r\n    const startAnimation = useCartAnimationStore((state) => state.startAnimation)\r\n    const imageRef = useRef<HTMLDivElement>(null)\r\n    const [isAdded, setIsAdded] = useState(false)\r\n\r\n    const currentPrice = Number((product as any)?.precio ?? 0)\r\n    const beforePrice = Number((product as any)?.precio_antes ?? 0)\r\n    const hasSale = Number.isFinite(beforePrice) && beforePrice > 0 && Number.isFinite(currentPrice) && currentPrice > 0 && beforePrice > currentPrice\r\n    const discountPercent = hasSale ? Math.round((1 - currentPrice / beforePrice) * 100) : 0\r\n\r\n    const images = (\r\n        (Array.isArray((product as any).imagenes) ? ((product as any).imagenes as string[]) : [])\r\n            .filter(Boolean)\r\n            .filter((u) => {\r\n                const s = String(u || '').toLowerCase()\r\n                return !(s.endsWith('.mp4') || s.endsWith('.webm') || s.endsWith('.mov') || s.endsWith('.m4v'))\r\n            })\r\n            .slice(0, 10)\r\n    )\r\n    const fallbackImages = images.length > 0 ? images : product.imagen_url ? [product.imagen_url] : []\r\n\r\n    const setCartOpen = useCartAnimationStore((state) => state.setCartOpen)\r\n\r\n    const handleAddToCart = (e: React.MouseEvent) => {\r\n        e.preventDefault() // Link wrapper might trigger navigation if we are not careful, but Button handles click.\r\n\r\n        addItem(product)\r\n        setCartOpen(true)\r\n\r\n        if (imageRef.current && fallbackImages.length > 0) {\r\n            const rect = imageRef.current.getBoundingClientRect()\r\n            startAnimation(fallbackImages[0], rect)\r\n        }\r\n\r\n        // Feedback visual simple\r\n        setIsAdded(true)\r\n        setTimeout(() => setIsAdded(false), 1000)\r\n    }\r\n\r\n    const productHref = `/productos/${slugify(product.nombre)}-${product.id}`\r\n\r\n    return (\r\n        <Card className=\"group overflow-hidden border-none shadow-sm hover:shadow-md transition-all duration-300 bg-card flex flex-col rounded-xl\">\r\n            <Link href={productHref} className=\"block\">\r\n                <div className=\"aspect-square bg-popover relative overflow-hidden\" ref={imageRef}>\r\n                    {fallbackImages.length > 0 ? (\r\n                        <ProductImageCarousel\r\n                            images={fallbackImages}\r\n                            alt={product.nombre}\r\n                            className=\"group-hover:scale-105 transition-transform duration-300\"\r\n                            autoPlay\r\n                            intervalMs={2500}\r\n                            priority={imagePriority}\r\n                            sizes=\"(max-width: 640px) 50vw, (max-width: 1024px) 33vw, 20vw\"\r\n                            quality={70}\r\n                        />\r\n                    ) : (\r\n                        <div className=\"absolute inset-0 flex items-center justify-center text-muted-foreground group-hover:scale-110 transition-transform duration-300\">\r\n                            <ImageIcon className=\"h-10 w-10 opacity-50\" />\r\n                        </div>\r\n                    )}\r\n                    {/* Quick Action Overlay */}\r\n                    <div className=\"absolute inset-0 bg-foreground/5 opacity-0 group-hover:opacity-100 transition-opacity\" />\r\n\r\n                    {hasSale && (\r\n                        <div className=\"absolute left-2 top-2 flex items-center gap-2\">\r\n                            <span className=\"inline-flex items-center rounded-full bg-gradient-to-r from-rose-600 to-orange-500 px-2.5 py-1 text-xs font-extrabold text-white shadow-md ring-1 ring-white/30 backdrop-blur\">\r\n                                -{discountPercent}%\r\n                            </span>\r\n                        </div>\r\n                    )}\r\n                </div>\r\n            </Link>\r\n\r\n            <CardContent className=\"p-3 flex-1 flex flex-col justify-between\">\r\n                <div>\r\n                    <Link href={productHref} className=\"hover:underline\">\r\n                        <h4 className=\"font-medium text-sm line-clamp-2 leading-tight mb-1 text-foreground\">{product.nombre}</h4>\r\n                    </Link>\r\n                </div>\r\n                <div className=\"mt-1\" data-nosnippet>\r\n                    <div className=\"flex items-baseline gap-2\">\r\n                        <p className=\"text-lg font-extrabold text-primary tracking-tight\">{formatCurrency(currentPrice)}</p>\r\n                        {hasSale && (\r\n                            <div className=\"flex items-baseline gap-2\">\r\n                                <p className=\"text-sm text-muted-foreground line-through\">{formatCurrency(beforePrice)}</p>\r\n                            </div>\r\n                        )}\r\n                    </div>\r\n                </div>\r\n            </CardContent>\r\n\r\n            <CardFooter className=\"p-3 pt-0\">\r\n                <Button\r\n                    onClick={handleAddToCart}\r\n                    className={`w-full h-9 font-semibold rounded-lg transition-all shadow-sm flex items-center justify-center gap-2 ${isAdded ? 'bg-green-600 hover:bg-green-700' : 'bg-primary text-primary-foreground hover:bg-primary/90'}`}\r\n                >\r\n                    {isAdded ? (\r\n                        <span>¡Agregado!</span>\r\n                    ) : (\r\n                        <>\r\n                            <Plus className=\"h-4 w-4\" />\r\n                            <span>Agregar</span>\r\n                        </>\r\n                    )}\r\n                </Button>\r\n            </CardFooter>\r\n        </Card>\r\n    )\r\n}\r\n"],"names":[],"mappings":"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"}}]
}