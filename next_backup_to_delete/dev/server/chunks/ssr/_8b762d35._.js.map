{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 4, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/Martin/Desktop/PROYECTOS/Tienda-Blama-2026/components/ui/card.tsx"],"sourcesContent":["import * as React from \"react\"\r\n\r\nimport { cn } from \"@/lib/utils\"\r\n\r\nfunction Card({ className, ...props }: React.ComponentProps<\"div\">) {\r\n  return (\r\n    <div\r\n      data-slot=\"card\"\r\n      className={cn(\r\n        \"bg-card text-card-foreground flex flex-col gap-6 rounded-xl border py-6 shadow-sm\",\r\n        className\r\n      )}\r\n      {...props}\r\n    />\r\n  )\r\n}\r\n\r\nfunction CardHeader({ className, ...props }: React.ComponentProps<\"div\">) {\r\n  return (\r\n    <div\r\n      data-slot=\"card-header\"\r\n      className={cn(\r\n        \"@container/card-header grid auto-rows-min grid-rows-[auto_auto] items-start gap-2 px-6 has-data-[slot=card-action]:grid-cols-[1fr_auto] [.border-b]:pb-6\",\r\n        className\r\n      )}\r\n      {...props}\r\n    />\r\n  )\r\n}\r\n\r\nfunction CardTitle({ className, ...props }: React.ComponentProps<\"div\">) {\r\n  return (\r\n    <div\r\n      data-slot=\"card-title\"\r\n      className={cn(\"leading-none font-semibold\", className)}\r\n      {...props}\r\n    />\r\n  )\r\n}\r\n\r\nfunction CardDescription({ className, ...props }: React.ComponentProps<\"div\">) {\r\n  return (\r\n    <div\r\n      data-slot=\"card-description\"\r\n      className={cn(\"text-muted-foreground text-sm\", className)}\r\n      {...props}\r\n    />\r\n  )\r\n}\r\n\r\nfunction CardAction({ className, ...props }: React.ComponentProps<\"div\">) {\r\n  return (\r\n    <div\r\n      data-slot=\"card-action\"\r\n      className={cn(\r\n        \"col-start-2 row-span-2 row-start-1 self-start justify-self-end\",\r\n        className\r\n      )}\r\n      {...props}\r\n    />\r\n  )\r\n}\r\n\r\nfunction CardContent({ className, ...props }: React.ComponentProps<\"div\">) {\r\n  return (\r\n    <div\r\n      data-slot=\"card-content\"\r\n      className={cn(\"px-6\", className)}\r\n      {...props}\r\n    />\r\n  )\r\n}\r\n\r\nfunction CardFooter({ className, ...props }: React.ComponentProps<\"div\">) {\r\n  return (\r\n    <div\r\n      data-slot=\"card-footer\"\r\n      className={cn(\"flex items-center px-6 [.border-t]:pt-6\", className)}\r\n      {...props}\r\n    />\r\n  )\r\n}\r\n\r\nexport {\r\n  Card,\r\n  CardHeader,\r\n  CardFooter,\r\n  CardTitle,\r\n  CardAction,\r\n  CardDescription,\r\n  CardContent,\r\n}\r\n"],"names":[],"mappings":";;;;;;;;;;;;;;;;;AAEA;;;AAEA,SAAS,KAAK,EAAE,SAAS,EAAE,GAAG,OAAoC;IAChE,qBACE,8OAAC;QACC,aAAU;QACV,WAAW,IAAA,kHAAE,EACX,qFACA;QAED,GAAG,KAAK;;;;;;AAGf;AAEA,SAAS,WAAW,EAAE,SAAS,EAAE,GAAG,OAAoC;IACtE,qBACE,8OAAC;QACC,aAAU;QACV,WAAW,IAAA,kHAAE,EACX,4JACA;QAED,GAAG,KAAK;;;;;;AAGf;AAEA,SAAS,UAAU,EAAE,SAAS,EAAE,GAAG,OAAoC;IACrE,qBACE,8OAAC;QACC,aAAU;QACV,WAAW,IAAA,kHAAE,EAAC,8BAA8B;QAC3C,GAAG,KAAK;;;;;;AAGf;AAEA,SAAS,gBAAgB,EAAE,SAAS,EAAE,GAAG,OAAoC;IAC3E,qBACE,8OAAC;QACC,aAAU;QACV,WAAW,IAAA,kHAAE,EAAC,iCAAiC;QAC9C,GAAG,KAAK;;;;;;AAGf;AAEA,SAAS,WAAW,EAAE,SAAS,EAAE,GAAG,OAAoC;IACtE,qBACE,8OAAC;QACC,aAAU;QACV,WAAW,IAAA,kHAAE,EACX,kEACA;QAED,GAAG,KAAK;;;;;;AAGf;AAEA,SAAS,YAAY,EAAE,SAAS,EAAE,GAAG,OAAoC;IACvE,qBACE,8OAAC;QACC,aAAU;QACV,WAAW,IAAA,kHAAE,EAAC,QAAQ;QACrB,GAAG,KAAK;;;;;;AAGf;AAEA,SAAS,WAAW,EAAE,SAAS,EAAE,GAAG,OAAoC;IACtE,qBACE,8OAAC;QACC,aAAU;QACV,WAAW,IAAA,kHAAE,EAAC,2CAA2C;QACxD,GAAG,KAAK;;;;;;AAGf"}},
    {"offset": {"line": 112, "column": 0}, "map": {"version":3,"sources":[],"names":[],"mappings":""}},
    {"offset": {"line": 118, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/Martin/Desktop/PROYECTOS/Tienda-Blama-2026/features/admin/services/dashboard.client.ts"],"sourcesContent":["import { supabase } from \"@/lib/supabaseClient\"\r\n\r\nimport type { AdminDashboardStats, AdminRole } from \"@/features/admin/types\"\r\n\r\nexport async function fetchAdminDashboardStats(args: { role: AdminRole | string; currentUserId: string }): Promise<AdminDashboardStats> {\r\n  const role = String(args.role || \"worker\")\r\n  const currentUserId = String(args.currentUserId || \"\")\r\n\r\n  const { data: pedidos } = await supabase\r\n    .from(\"pedidos\")\r\n    .select(\"id, total, status, asignado_a, created_at\")\r\n\r\n  const deliveredSales = (pedidos || []).filter((p: any) => p.status === \"Entregado\")\r\n  const totalVentasReales = deliveredSales.reduce((sum: number, p: any) => sum + (Number(p.total) || 0), 0)\r\n\r\n  const today = new Date()\r\n  const yyyy = today.getFullYear()\r\n  const mm = String(today.getMonth() + 1).padStart(2, \"0\")\r\n  const dd = String(today.getDate()).padStart(2, \"0\")\r\n  const todayPrefix = `${yyyy}-${mm}-${dd}`\r\n\r\n  const ventasHoy = deliveredSales\r\n    .filter((p: any) => typeof p.created_at === \"string\" && p.created_at.startsWith(todayPrefix))\r\n    .reduce((sum: number, p: any) => sum + (Number(p.total) || 0), 0)\r\n\r\n  const pedidosPendientes = (pedidos || []).filter((p: any) => p.status === \"Pendiente\").length\r\n  const pedidosEnProceso = (pedidos || []).filter((p: any) => [\"Confirmado\", \"Preparando\", \"Enviado\"].includes(p.status)).length\r\n  const pedidosEntregados = deliveredSales.length\r\n\r\n  const pedidosAsignados = (pedidos || []).filter(\r\n    (p: any) => p.asignado_a === currentUserId && ![\"Fallido\", \"Devuelto\", \"Entregado\"].includes(p.status)\r\n  ).length\r\n\r\n  let totalClientes = 0\r\n  if (role === \"admin\") {\r\n    const { count } = await supabase.from(\"clientes\").select(\"*\", { count: \"exact\", head: true })\r\n    totalClientes = count || 0\r\n  }\r\n\r\n  let productosLowStock = 0\r\n  if (role === \"admin\") {\r\n    const { count } = await supabase.from(\"productos\").select(\"*\", { count: \"exact\", head: true }).lt(\"stock\", 5)\r\n    productosLowStock = count || 0\r\n  }\r\n\r\n  return {\r\n    totalVentasReales,\r\n    ventasHoy,\r\n    pedidosPendientes,\r\n    pedidosEnProceso,\r\n    pedidosEntregados,\r\n    pedidosAsignados,\r\n    totalClientes,\r\n    productosLowStock,\r\n  }\r\n}\r\n\r\nexport async function fetchAdminVentasEntregadas(args: { from: string; to: string }) {\r\n  const fromIso = args.from ? `${args.from}T00:00:00.000Z` : undefined\r\n  const toIso = args.to ? `${args.to}T23:59:59.999Z` : undefined\r\n\r\n  let query = supabase\r\n    .from(\"pedidos\")\r\n    .select(\"id, total, status, created_at, clientes (nombre, telefono, dni)\")\r\n    .eq(\"status\", \"Entregado\")\r\n    .order(\"created_at\", { ascending: false })\r\n\r\n  if (fromIso) query = query.gte(\"created_at\", fromIso)\r\n  if (toIso) query = query.lte(\"created_at\", toIso)\r\n\r\n  const { data, error } = await query\r\n  if (error) throw error\r\n  return (data as any[]) || []\r\n}\r\n\r\nexport async function fetchAdminStockBajo(args: { threshold: number }) {\r\n  const th = Number(args.threshold)\r\n  const { data, error } = await supabase\r\n    .from(\"productos\")\r\n    .select(\"id, nombre, precio, stock, imagen_url\")\r\n    .lt(\"stock\", th)\r\n    .order(\"stock\", { ascending: true })\r\n\r\n  if (error) throw error\r\n  return (data as any[]) || []\r\n}\r\n\r\nexport async function fetchAdminPedidosPendientes() {\r\n  const { data, error } = await supabase\r\n    .from(\"pedidos\")\r\n    .select(\"id, total, status, created_at, clientes (nombre, telefono, dni)\")\r\n    .eq(\"status\", \"Pendiente\")\r\n    .order(\"created_at\", { ascending: false })\r\n\r\n  if (error) throw error\r\n  return (data as any[]) || []\r\n}\r\n\r\nconst PROCESS_STATUSES = [\"Confirmado\", \"Preparando\", \"Enviado\"] as const\r\ntype ProcessStatus = (typeof PROCESS_STATUSES)[number]\r\ntype StatusFilter = ProcessStatus | \"all\"\r\n\r\nexport async function fetchAdminPedidosEnProceso(args: { status: StatusFilter; from: string; to: string }) {\r\n  const fromIso = args.from ? `${args.from}T00:00:00.000Z` : undefined\r\n  const toIso = args.to ? `${args.to}T23:59:59.999Z` : undefined\r\n\r\n  let query = supabase\r\n    .from(\"pedidos\")\r\n    .select(\"id, total, status, created_at, asignado_a, clientes (nombre, telefono, dni)\")\r\n    .in(\"status\", PROCESS_STATUSES as unknown as string[])\r\n    .order(\"created_at\", { ascending: false })\r\n\r\n  if (args.status !== \"all\") query = query.eq(\"status\", args.status)\r\n  if (fromIso) query = query.gte(\"created_at\", fromIso)\r\n  if (toIso) query = query.lte(\"created_at\", toIso)\r\n\r\n  const { data, error } = await query\r\n  if (error) throw error\r\n  return (data as any[]) || []\r\n}\r\n"],"names":[],"mappings":"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"}},
    {"offset": {"line": 232, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/Martin/Desktop/PROYECTOS/Tienda-Blama-2026/features/admin/services/pedidos.client.ts"],"sourcesContent":["import { supabase } from \"@/lib/supabaseClient\"\r\n\r\nimport type { AdminRole, PedidoItemRow, PedidoRow, ProfileRow } from \"@/features/admin/types\"\r\n\r\nexport async function fetchAdminWorkers() {\r\n  const { data, error } = await supabase.from(\"profiles\").select(\"id, email, nombre, role\").eq(\"role\", \"worker\")\r\n  if (error) throw error\r\n  return ((data as any[]) || []) as ProfileRow[]\r\n}\r\n\r\nexport async function fetchPedidosForRole(args: { role: AdminRole | string; currentUserId: string }) {\r\n  const role = String(args.role || \"worker\")\r\n  const currentUserId = String(args.currentUserId || \"\")\r\n\r\n  let query = supabase\r\n    .from(\"pedidos\")\r\n    .select(\r\n      `\r\n        *,\r\n        clientes (nombre, telefono, dni)\r\n      `\r\n    )\r\n    .order(\"created_at\", { ascending: false })\r\n\r\n  if (role === \"worker\") {\r\n    query = query.eq(\"asignado_a\", currentUserId)\r\n  }\r\n\r\n  const { data, error } = await query\r\n\r\n  if (error) {\r\n    if (String(error.message || \"\").includes(\"asignado_a\")) {\r\n      const { data: fallbackData } = await supabase\r\n        .from(\"pedidos\")\r\n        .select(`*, clientes (nombre, telefono, dni)`)\r\n        .order(\"created_at\", { ascending: false })\r\n      return ((fallbackData as any[]) || []) as PedidoRow[]\r\n    }\r\n    throw error\r\n  }\r\n\r\n  const rows = ((data as any[]) || []) as PedidoRow[]\r\n\r\n  const withWorkers = await Promise.all(\r\n    rows.map(async (pedido: any) => {\r\n      if (pedido.asignado_a) {\r\n        const { data: workerProfile } = await supabase\r\n          .from(\"profiles\")\r\n          .select(\"id, email, nombre\")\r\n          .eq(\"id\", pedido.asignado_a)\r\n          .single()\r\n        return { ...pedido, asignado_perfil: (workerProfile as any) || null }\r\n      }\r\n      return { ...pedido, asignado_perfil: null }\r\n    })\r\n  )\r\n\r\n  return withWorkers as PedidoRow[]\r\n}\r\n\r\nexport async function assignPedidoToWorker(args: { pedidoId: number; workerId: string | null }) {\r\n  const assignValue = args.workerId ? String(args.workerId) : null\r\n  const { error } = await supabase\r\n    .from(\"pedidos\")\r\n    .update({\r\n      asignado_a: assignValue,\r\n      fecha_asignacion: assignValue ? new Date().toISOString() : null,\r\n    })\r\n    .eq(\"id\", args.pedidoId)\r\n\r\n  if (error) throw error\r\n}\r\n\r\nexport async function fetchPedidoDetail(pedidoId: number) {\r\n  const { data: pedidoData, error } = await supabase\r\n    .from(\"pedidos\")\r\n    .select(\r\n      `\r\n        *,\r\n        clientes (*)\r\n      `\r\n    )\r\n    .eq(\"id\", pedidoId)\r\n    .single()\r\n\r\n  if (error) throw error\r\n\r\n  let asignadoPerfil: any = null\r\n  if ((pedidoData as any)?.asignado_a) {\r\n    const { data: workerProfile } = await supabase\r\n      .from(\"profiles\")\r\n      .select(\"id, email, nombre\")\r\n      .eq(\"id\", (pedidoData as any).asignado_a)\r\n      .single()\r\n    asignadoPerfil = workerProfile\r\n  }\r\n\r\n  const pedido = { ...(pedidoData as any), asignado_perfil: asignadoPerfil } as PedidoRow\r\n\r\n  const { data: itemsData, error: itemsErr } = await supabase\r\n    .from(\"pedido_items\")\r\n    .select(\r\n      `\r\n        *,\r\n        productos (nombre, precio, imagen_url)\r\n      `\r\n    )\r\n    .eq(\"pedido_id\", pedidoId)\r\n\r\n  if (itemsErr) throw itemsErr\r\n\r\n  return {\r\n    pedido,\r\n    items: ((itemsData as any[]) || []) as PedidoItemRow[],\r\n  }\r\n}\r\n\r\nexport async function updatePedidoStatusWithStock(args: { pedidoId: number; nextStatus: string; stockDescontado: boolean }) {\r\n  const pedidoId = Number(args.pedidoId)\r\n  const nextStatus = String(args.nextStatus || \"\")\r\n\r\n  if (nextStatus === \"Confirmado\" && !args.stockDescontado) {\r\n    const { data: itemsData, error: itemsError } = await supabase\r\n      .from(\"pedido_items\")\r\n      .select(\"producto_id, producto_variante_id, cantidad\")\r\n      .eq(\"pedido_id\", pedidoId)\r\n\r\n    if (itemsError) throw itemsError\r\n\r\n    const safeItems = (itemsData || []).filter((it: any) => it.producto_id)\r\n\r\n    for (const it of safeItems) {\r\n      const productoId = Number(it.producto_id)\r\n      const varianteId = it.producto_variante_id != null ? Number(it.producto_variante_id) : null\r\n      const qty = Number(it.cantidad || 0)\r\n      if (!productoId || qty <= 0) continue\r\n\r\n      if (varianteId) {\r\n        const { data: variante, error: varError } = await supabase\r\n          .from(\"producto_variantes\")\r\n          .select(\"stock\")\r\n          .eq(\"id\", varianteId)\r\n          .single()\r\n\r\n        if (varError) throw varError\r\n\r\n        const currentStock = Number((variante as any)?.stock ?? 0)\r\n        const newStock = Math.max(0, currentStock - qty)\r\n\r\n        const { error: updError } = await supabase.from(\"producto_variantes\").update({ stock: newStock }).eq(\"id\", varianteId)\r\n\r\n        if (updError) throw updError\r\n      } else {\r\n        const { data: producto, error: prodError } = await supabase.from(\"productos\").select(\"stock\").eq(\"id\", productoId).single()\r\n\r\n        if (prodError) throw prodError\r\n\r\n        const currentStock = Number((producto as any)?.stock ?? 0)\r\n        const newStock = Math.max(0, currentStock - qty)\r\n\r\n        const { error: updError } = await supabase.from(\"productos\").update({ stock: newStock }).eq(\"id\", productoId)\r\n\r\n        if (updError) throw updError\r\n      }\r\n    }\r\n\r\n    const { error: markError } = await supabase.from(\"pedidos\").update({ stock_descontado: true }).eq(\"id\", pedidoId)\r\n    if (markError) throw markError\r\n  }\r\n\r\n  const { error } = await supabase.from(\"pedidos\").update({ status: nextStatus }).eq(\"id\", pedidoId)\r\n  if (error) throw error\r\n}\r\n"],"names":[],"mappings":"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"}},
    {"offset": {"line": 368, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/Martin/Desktop/PROYECTOS/Tienda-Blama-2026/features/admin/services/productos.client.ts"],"sourcesContent":["import { supabase } from \"@/lib/supabaseClient\"\r\n\r\nexport async function fetchAdminProductos() {\r\n  const { data, error } = await supabase.from(\"productos\").select(\"*\").order(\"id\", { ascending: true })\r\n  if (error) throw error\r\n  return (data as any[]) || []\r\n}\r\n\r\nexport async function fetchAdminProductoById(id: number) {\r\n  const { data, error } = await supabase.from(\"productos\").select(\"*\").eq(\"id\", id).single()\r\n  if (error) throw error\r\n  return data as any\r\n}\r\n\r\nexport async function fetchAdminCategorias() {\r\n  const { data, error } = await supabase.from(\"categorias\").select(\"*\")\r\n  if (error) throw error\r\n  return (data as any[]) || []\r\n}\r\n\r\nexport async function createAdminCategoria(args: { nombre: string }) {\r\n  const nombre = String(args.nombre || \"\").trim()\r\n  const slug = nombre.toLowerCase().replace(/ /g, \"-\").replace(/[^\\w-]+/g, \"\")\r\n  const { data, error } = await supabase.from(\"categorias\").insert({ nombre, slug }).select().single()\r\n  if (error) throw error\r\n  return data as any\r\n}\r\n\r\nexport async function fetchProductoSpecsAndVariants(productId: number) {\r\n  const [specRes, varRes] = await Promise.all([\r\n    supabase.from(\"producto_especificaciones\").select(\"*\").eq(\"producto_id\", productId).order(\"orden\", { ascending: true }).order(\"id\", { ascending: true }),\r\n    supabase.from(\"producto_variantes\").select(\"*\").eq(\"producto_id\", productId).order(\"id\", { ascending: true }),\r\n  ])\r\n\r\n  return {\r\n    specs: (specRes.data as any[]) || [],\r\n    variants: (varRes.data as any[]) || [],\r\n  }\r\n}\r\n\r\nexport async function uploadProductImages(args: { files: File[] }) {\r\n  const files = Array.isArray(args.files) ? args.files : []\r\n  const uploadedUrls: string[] = []\r\n\r\n  for (const file of files) {\r\n    const fileExt = file.name.split(\".\").pop() || \"jpg\"\r\n    const fileName = `${Date.now()}-${Math.random().toString(16).slice(2)}.${fileExt}`\r\n    const filePath = `imagenes/${fileName}`\r\n\r\n    const { error: uploadError } = await supabase.storage.from(\"productos\").upload(filePath, file)\r\n    if (uploadError) throw uploadError\r\n\r\n    const { data } = supabase.storage.from(\"productos\").getPublicUrl(filePath)\r\n    if (data?.publicUrl) uploadedUrls.push(data.publicUrl)\r\n  }\r\n\r\n  return uploadedUrls\r\n}\r\n\r\nexport async function uploadProductVideos(args: { files: File[] }) {\r\n  const files = Array.isArray(args.files) ? args.files : []\r\n  const uploadedUrls: string[] = []\r\n\r\n  for (const file of files) {\r\n    const fileExt = file.name.split(\".\").pop() || \"mp4\"\r\n    const fileName = `${Date.now()}-${Math.random().toString(16).slice(2)}.${fileExt}`\r\n    const filePath = `videos/${fileName}`\r\n\r\n    const { error: uploadError } = await supabase.storage\r\n      .from(\"productos\")\r\n      .upload(filePath, file, { upsert: false, contentType: file.type || \"video/mp4\" })\r\n\r\n    if (uploadError) throw uploadError\r\n\r\n    const { data } = supabase.storage.from(\"productos\").getPublicUrl(filePath)\r\n    if (data?.publicUrl) uploadedUrls.push(data.publicUrl)\r\n  }\r\n\r\n  return uploadedUrls\r\n}\r\n\r\nexport async function saveAdminProductoViaApi(args: { accessToken: string; method: \"POST\" | \"PUT\"; body: unknown }) {\r\n  const res = await fetch(\"/api/admin/productos\", {\r\n    method: args.method,\r\n    headers: {\r\n      \"Content-Type\": \"application/json\",\r\n      Authorization: `Bearer ${args.accessToken}`,\r\n    },\r\n    body: JSON.stringify(args.body),\r\n  })\r\n\r\n  let json: any = null\r\n  try {\r\n    json = await res.json()\r\n  } catch (err) {\r\n    json = null\r\n  }\r\n\r\n  if (!res.ok || !json?.ok) {\r\n    throw new Error(String(json?.error || \"No se pudo guardar el producto\"))\r\n  }\r\n\r\n  return json\r\n}\r\n\r\nexport async function deleteAdminProductoViaApi(args: { accessToken: string; id: number }) {\r\n  const res = await fetch(\"/api/admin/productos\", {\r\n    method: \"DELETE\",\r\n    headers: {\r\n      \"Content-Type\": \"application/json\",\r\n      Authorization: `Bearer ${args.accessToken}`,\r\n    },\r\n    body: JSON.stringify({ id: args.id }),\r\n  })\r\n\r\n  let json: any = null\r\n  try {\r\n    json = await res.json()\r\n  } catch (err) {\r\n    json = null\r\n  }\r\n\r\n  if (!res.ok || !json?.ok) {\r\n    throw new Error(String(json?.error || \"No se pudo eliminar\"))\r\n  }\r\n\r\n  return json\r\n}\r\n"],"names":[],"mappings":"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"}},
    {"offset": {"line": 510, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/Martin/Desktop/PROYECTOS/Tienda-Blama-2026/features/admin/services/usuarios.client.ts"],"sourcesContent":["import { supabase } from \"@/lib/supabaseClient\"\r\n\r\nimport type { ProfileRow } from \"@/features/admin/types\"\r\n\r\nexport async function fetchAdminProfiles() {\r\n  const { data, error } = await supabase.from(\"profiles\").select(\"id, email, nombre, role, created_at\").order(\"created_at\", { ascending: false })\r\n  if (error) throw error\r\n  return ((data as any[]) || []) as ProfileRow[]\r\n}\r\n\r\nexport async function createWorkerViaApi(args: { accessToken: string; email: string; nombre: string; password: string | null }) {\r\n  const res = await fetch(\"/api/admin/create-worker\", {\r\n    method: \"POST\",\r\n    headers: {\r\n      \"Content-Type\": \"application/json\",\r\n      Authorization: `Bearer ${args.accessToken}`,\r\n    },\r\n    body: JSON.stringify({\r\n      email: args.email,\r\n      nombre: args.nombre,\r\n      password: args.password,\r\n    }),\r\n  })\r\n\r\n  const json = await res.json()\r\n  if (!res.ok) {\r\n    throw new Error(String(json?.error || \"Error\"))\r\n  }\r\n\r\n  return json as any\r\n}\r\n"],"names":[],"mappings":";;;;;;AAAA;;AAIO,eAAe;IACpB,MAAM,EAAE,IAAI,EAAE,KAAK,EAAE,GAAG,MAAM,iIAAQ,CAAC,IAAI,CAAC,YAAY,MAAM,CAAC,uCAAuC,KAAK,CAAC,cAAc;QAAE,WAAW;IAAM;IAC7I,IAAI,OAAO,MAAM;IACjB,OAAQ,AAAC,QAAkB,EAAE;AAC/B;AAEO,eAAe,mBAAmB,IAAqF;IAC5H,MAAM,MAAM,MAAM,MAAM,4BAA4B;QAClD,QAAQ;QACR,SAAS;YACP,gBAAgB;YAChB,eAAe,CAAC,OAAO,EAAE,KAAK,WAAW,EAAE;QAC7C;QACA,MAAM,KAAK,SAAS,CAAC;YACnB,OAAO,KAAK,KAAK;YACjB,QAAQ,KAAK,MAAM;YACnB,UAAU,KAAK,QAAQ;QACzB;IACF;IAEA,MAAM,OAAO,MAAM,IAAI,IAAI;IAC3B,IAAI,CAAC,IAAI,EAAE,EAAE;QACX,MAAM,IAAI,MAAM,OAAO,MAAM,SAAS;IACxC;IAEA,OAAO;AACT"}},
    {"offset": {"line": 548, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/Martin/Desktop/PROYECTOS/Tienda-Blama-2026/features/admin/services/cupones.client.ts"],"sourcesContent":["import { supabase } from \"@/lib/supabaseClient\"\r\n\r\nexport async function fetchAdminCupones() {\r\n  const { data, error } = await supabase.from(\"cupones\").select(\"*\").order(\"created_at\", { ascending: false })\r\n  if (error) throw error\r\n  return (data as any[]) || []\r\n}\r\n\r\nexport async function createAdminCupon(payload: any) {\r\n  const { error } = await supabase.from(\"cupones\").insert(payload)\r\n  if (error) throw error\r\n}\r\n\r\nexport async function updateAdminCupon(id: number, payload: any) {\r\n  const { error } = await supabase.from(\"cupones\").update(payload).eq(\"id\", id)\r\n  if (error) throw error\r\n}\r\n\r\nexport async function deleteAdminCupon(id: number) {\r\n  const { error } = await supabase.from(\"cupones\").delete().eq(\"id\", id)\r\n  if (error) throw error\r\n}\r\n"],"names":[],"mappings":";;;;;;;;;;AAAA;;AAEO,eAAe;IACpB,MAAM,EAAE,IAAI,EAAE,KAAK,EAAE,GAAG,MAAM,iIAAQ,CAAC,IAAI,CAAC,WAAW,MAAM,CAAC,KAAK,KAAK,CAAC,cAAc;QAAE,WAAW;IAAM;IAC1G,IAAI,OAAO,MAAM;IACjB,OAAO,AAAC,QAAkB,EAAE;AAC9B;AAEO,eAAe,iBAAiB,OAAY;IACjD,MAAM,EAAE,KAAK,EAAE,GAAG,MAAM,iIAAQ,CAAC,IAAI,CAAC,WAAW,MAAM,CAAC;IACxD,IAAI,OAAO,MAAM;AACnB;AAEO,eAAe,iBAAiB,EAAU,EAAE,OAAY;IAC7D,MAAM,EAAE,KAAK,EAAE,GAAG,MAAM,iIAAQ,CAAC,IAAI,CAAC,WAAW,MAAM,CAAC,SAAS,EAAE,CAAC,MAAM;IAC1E,IAAI,OAAO,MAAM;AACnB;AAEO,eAAe,iBAAiB,EAAU;IAC/C,MAAM,EAAE,KAAK,EAAE,GAAG,MAAM,iIAAQ,CAAC,IAAI,CAAC,WAAW,MAAM,GAAG,EAAE,CAAC,MAAM;IACnE,IAAI,OAAO,MAAM;AACnB"}},
    {"offset": {"line": 583, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/Martin/Desktop/PROYECTOS/Tienda-Blama-2026/features/admin/services/banners.client.ts"],"sourcesContent":["import { supabase } from \"@/lib/supabaseClient\"\r\n\r\nexport async function fetchHomeBanners() {\r\n  const { data, error } = await supabase.from(\"home_banners\").select(\"*\").order(\"orden\", { ascending: true }).order(\"id\", { ascending: true })\r\n  if (error) throw error\r\n  return (data as any[]) || []\r\n}\r\n\r\nexport async function saveHomeBanner(args: { id?: number | null; payload: any }) {\r\n  if (args.id != null) {\r\n    const { error } = await supabase.from(\"home_banners\").update(args.payload).eq(\"id\", args.id)\r\n    if (error) throw error\r\n    return\r\n  }\r\n\r\n  const { error } = await supabase.from(\"home_banners\").insert(args.payload)\r\n  if (error) throw error\r\n}\r\n\r\nexport async function deleteHomeBanner(id: number) {\r\n  const { error } = await supabase.from(\"home_banners\").delete().eq(\"id\", id)\r\n  if (error) throw error\r\n}\r\n"],"names":[],"mappings":";;;;;;;;AAAA;;AAEO,eAAe;IACpB,MAAM,EAAE,IAAI,EAAE,KAAK,EAAE,GAAG,MAAM,iIAAQ,CAAC,IAAI,CAAC,gBAAgB,MAAM,CAAC,KAAK,KAAK,CAAC,SAAS;QAAE,WAAW;IAAK,GAAG,KAAK,CAAC,MAAM;QAAE,WAAW;IAAK;IAC1I,IAAI,OAAO,MAAM;IACjB,OAAO,AAAC,QAAkB,EAAE;AAC9B;AAEO,eAAe,eAAe,IAA0C;IAC7E,IAAI,KAAK,EAAE,IAAI,MAAM;QACnB,MAAM,EAAE,KAAK,EAAE,GAAG,MAAM,iIAAQ,CAAC,IAAI,CAAC,gBAAgB,MAAM,CAAC,KAAK,OAAO,EAAE,EAAE,CAAC,MAAM,KAAK,EAAE;QAC3F,IAAI,OAAO,MAAM;QACjB;IACF;IAEA,MAAM,EAAE,KAAK,EAAE,GAAG,MAAM,iIAAQ,CAAC,IAAI,CAAC,gBAAgB,MAAM,CAAC,KAAK,OAAO;IACzE,IAAI,OAAO,MAAM;AACnB;AAEO,eAAe,iBAAiB,EAAU;IAC/C,MAAM,EAAE,KAAK,EAAE,GAAG,MAAM,iIAAQ,CAAC,IAAI,CAAC,gBAAgB,MAAM,GAAG,EAAE,CAAC,MAAM;IACxE,IAAI,OAAO,MAAM;AACnB"}},
    {"offset": {"line": 619, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/Martin/Desktop/PROYECTOS/Tienda-Blama-2026/features/admin/services/announcement-bar.client.ts"],"sourcesContent":["import { supabase } from \"@/lib/supabaseClient\"\r\n\r\nexport type AnnouncementBarConfig = {\r\n  enabled: boolean\r\n  interval_ms: number\r\n  messages: string[]\r\n}\r\n\r\nasync function getAccessToken() {\r\n  const res = await supabase.auth.getSession()\r\n  const token = res?.data?.session?.access_token || \"\"\r\n  return token\r\n}\r\n\r\nexport async function fetchAnnouncementBarConfigViaApi() {\r\n  const token = await getAccessToken()\r\n  if (!token) throw new Error(\"No autorizado\")\r\n\r\n  const res = await fetch(\"/api/admin/announcement-bar\", {\r\n    method: \"GET\",\r\n    headers: {\r\n      Authorization: `Bearer ${token}`,\r\n    },\r\n  })\r\n\r\n  let json: any = null\r\n  try {\r\n    json = await res.json()\r\n  } catch (e) {\r\n    json = null\r\n  }\r\n\r\n  if (!res.ok || !json?.ok) {\r\n    throw new Error(String(json?.error || \"No se pudo obtener la configuraciÃ³n\"))\r\n  }\r\n\r\n  const data = (json?.data || {}) as any\r\n  return {\r\n    enabled: Boolean(data.enabled),\r\n    interval_ms: Number(data.interval_ms) || 3500,\r\n    messages: Array.isArray(data.messages) ? (data.messages as string[]) : [],\r\n  } as AnnouncementBarConfig\r\n}\r\n\r\nexport async function saveAnnouncementBarConfigViaApi(config: AnnouncementBarConfig) {\r\n  const token = await getAccessToken()\r\n  if (!token) throw new Error(\"No autorizado\")\r\n\r\n  const res = await fetch(\"/api/admin/announcement-bar\", {\r\n    method: \"PUT\",\r\n    headers: {\r\n      \"Content-Type\": \"application/json\",\r\n      Authorization: `Bearer ${token}`,\r\n    },\r\n    body: JSON.stringify(config),\r\n  })\r\n\r\n  let json: any = null\r\n  try {\r\n    json = await res.json()\r\n  } catch (e) {\r\n    json = null\r\n  }\r\n\r\n  if (!res.ok || !json?.ok) {\r\n    throw new Error(String(json?.error || \"No se pudo guardar\"))\r\n  }\r\n\r\n  return json\r\n}\r\n"],"names":[],"mappings":";;;;;;AAAA;;AAQA,eAAe;IACb,MAAM,MAAM,MAAM,iIAAQ,CAAC,IAAI,CAAC,UAAU;IAC1C,MAAM,QAAQ,KAAK,MAAM,SAAS,gBAAgB;IAClD,OAAO;AACT;AAEO,eAAe;IACpB,MAAM,QAAQ,MAAM;IACpB,IAAI,CAAC,OAAO,MAAM,IAAI,MAAM;IAE5B,MAAM,MAAM,MAAM,MAAM,+BAA+B;QACrD,QAAQ;QACR,SAAS;YACP,eAAe,CAAC,OAAO,EAAE,OAAO;QAClC;IACF;IAEA,IAAI,OAAY;IAChB,IAAI;QACF,OAAO,MAAM,IAAI,IAAI;IACvB,EAAE,OAAO,GAAG;QACV,OAAO;IACT;IAEA,IAAI,CAAC,IAAI,EAAE,IAAI,CAAC,MAAM,IAAI;QACxB,MAAM,IAAI,MAAM,OAAO,MAAM,SAAS;IACxC;IAEA,MAAM,OAAQ,MAAM,QAAQ,CAAC;IAC7B,OAAO;QACL,SAAS,QAAQ,KAAK,OAAO;QAC7B,aAAa,OAAO,KAAK,WAAW,KAAK;QACzC,UAAU,MAAM,OAAO,CAAC,KAAK,QAAQ,IAAK,KAAK,QAAQ,GAAgB,EAAE;IAC3E;AACF;AAEO,eAAe,gCAAgC,MAA6B;IACjF,MAAM,QAAQ,MAAM;IACpB,IAAI,CAAC,OAAO,MAAM,IAAI,MAAM;IAE5B,MAAM,MAAM,MAAM,MAAM,+BAA+B;QACrD,QAAQ;QACR,SAAS;YACP,gBAAgB;YAChB,eAAe,CAAC,OAAO,EAAE,OAAO;QAClC;QACA,MAAM,KAAK,SAAS,CAAC;IACvB;IAEA,IAAI,OAAY;IAChB,IAAI;QACF,OAAO,MAAM,IAAI,IAAI;IACvB,EAAE,OAAO,GAAG;QACV,OAAO;IACT;IAEA,IAAI,CAAC,IAAI,EAAE,IAAI,CAAC,MAAM,IAAI;QACxB,MAAM,IAAI,MAAM,OAAO,MAAM,SAAS;IACxC;IAEA,OAAO;AACT"}},
    {"offset": {"line": 683, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/Martin/Desktop/PROYECTOS/Tienda-Blama-2026/features/admin/services/incidencias.client.ts"],"sourcesContent":["import { supabase } from \"@/lib/supabaseClient\"\r\n\r\nexport async function fetchPedidosForIncidencias() {\r\n  const { data, error } = await supabase\r\n    .from(\"pedidos\")\r\n    .select(\"id, status, created_at, clientes (nombre, telefono)\")\r\n    .order(\"created_at\", { ascending: false })\r\n    .limit(200)\r\n\r\n  if (error) throw error\r\n  return (data as any[]) || []\r\n}\r\n\r\nexport async function fetchIncidencias() {\r\n  const { data, error } = await supabase\r\n    .from(\"incidencias\")\r\n    .select(\"*, pedidos (id, status, created_at, clientes (nombre, telefono))\")\r\n    .order(\"created_at\", { ascending: false })\r\n\r\n  if (error) throw error\r\n  return (data as any[]) || []\r\n}\r\n\r\nexport async function uploadIncidenciaImages(args: { pedidoId: string; files: File[] }) {\r\n  const pedidoId = String(args.pedidoId || \"\").trim()\r\n  const files = Array.isArray(args.files) ? args.files : []\r\n\r\n  const uploadedUrls: string[] = []\r\n\r\n  for (const file of files) {\r\n    const fileExt = file.name.split(\".\").pop() || \"jpg\"\r\n    const fileName = `${Date.now()}-${Math.random().toString(16).slice(2)}.${fileExt}`\r\n    const folder = pedidoId ? `incidencias/${pedidoId}` : \"incidencias\"\r\n    const filePath = `${folder}/${fileName}`\r\n\r\n    const { error: uploadError } = await supabase.storage.from(\"productos\").upload(filePath, file)\r\n    if (uploadError) throw uploadError\r\n\r\n    const { data } = supabase.storage.from(\"productos\").getPublicUrl(filePath)\r\n    if (data?.publicUrl) uploadedUrls.push(data.publicUrl)\r\n  }\r\n\r\n  return uploadedUrls\r\n}\r\n\r\nexport async function createIncidencia(payload: any) {\r\n  async function save(withFotos: boolean) {\r\n    const p: any = { ...payload }\r\n    if (!withFotos) delete p.fotos\r\n    return supabase.from(\"incidencias\").insert(p)\r\n  }\r\n\r\n  const first = await save(true)\r\n  let error = first.error\r\n  if (error && typeof (error as any).message === \"string\" && (error as any).message.toLowerCase().includes(\"fotos\")) {\r\n    const second = await save(false)\r\n    error = second.error\r\n  }\r\n\r\n  if (error) throw new Error((error as any).message)\r\n}\r\n\r\nexport async function deleteIncidencia(id: number) {\r\n  const { error } = await supabase.from(\"incidencias\").delete().eq(\"id\", id)\r\n  if (error) throw error\r\n}\r\n"],"names":[],"mappings":";;;;;;;;;;;;AAAA;;AAEO,eAAe;IACpB,MAAM,EAAE,IAAI,EAAE,KAAK,EAAE,GAAG,MAAM,iIAAQ,CACnC,IAAI,CAAC,WACL,MAAM,CAAC,uDACP,KAAK,CAAC,cAAc;QAAE,WAAW;IAAM,GACvC,KAAK,CAAC;IAET,IAAI,OAAO,MAAM;IACjB,OAAO,AAAC,QAAkB,EAAE;AAC9B;AAEO,eAAe;IACpB,MAAM,EAAE,IAAI,EAAE,KAAK,EAAE,GAAG,MAAM,iIAAQ,CACnC,IAAI,CAAC,eACL,MAAM,CAAC,oEACP,KAAK,CAAC,cAAc;QAAE,WAAW;IAAM;IAE1C,IAAI,OAAO,MAAM;IACjB,OAAO,AAAC,QAAkB,EAAE;AAC9B;AAEO,eAAe,uBAAuB,IAAyC;IACpF,MAAM,WAAW,OAAO,KAAK,QAAQ,IAAI,IAAI,IAAI;IACjD,MAAM,QAAQ,MAAM,OAAO,CAAC,KAAK,KAAK,IAAI,KAAK,KAAK,GAAG,EAAE;IAEzD,MAAM,eAAyB,EAAE;IAEjC,KAAK,MAAM,QAAQ,MAAO;QACxB,MAAM,UAAU,KAAK,IAAI,CAAC,KAAK,CAAC,KAAK,GAAG,MAAM;QAC9C,MAAM,WAAW,GAAG,KAAK,GAAG,GAAG,CAAC,EAAE,KAAK,MAAM,GAAG,QAAQ,CAAC,IAAI,KAAK,CAAC,GAAG,CAAC,EAAE,SAAS;QAClF,MAAM,SAAS,WAAW,CAAC,YAAY,EAAE,UAAU,GAAG;QACtD,MAAM,WAAW,GAAG,OAAO,CAAC,EAAE,UAAU;QAExC,MAAM,EAAE,OAAO,WAAW,EAAE,GAAG,MAAM,iIAAQ,CAAC,OAAO,CAAC,IAAI,CAAC,aAAa,MAAM,CAAC,UAAU;QACzF,IAAI,aAAa,MAAM;QAEvB,MAAM,EAAE,IAAI,EAAE,GAAG,iIAAQ,CAAC,OAAO,CAAC,IAAI,CAAC,aAAa,YAAY,CAAC;QACjE,IAAI,MAAM,WAAW,aAAa,IAAI,CAAC,KAAK,SAAS;IACvD;IAEA,OAAO;AACT;AAEO,eAAe,iBAAiB,OAAY;IACjD,eAAe,KAAK,SAAkB;QACpC,MAAM,IAAS;YAAE,GAAG,OAAO;QAAC;QAC5B,IAAI,CAAC,WAAW,OAAO,EAAE,KAAK;QAC9B,OAAO,iIAAQ,CAAC,IAAI,CAAC,eAAe,MAAM,CAAC;IAC7C;IAEA,MAAM,QAAQ,MAAM,KAAK;IACzB,IAAI,QAAQ,MAAM,KAAK;IACvB,IAAI,SAAS,OAAO,AAAC,MAAc,OAAO,KAAK,YAAY,AAAC,MAAc,OAAO,CAAC,WAAW,GAAG,QAAQ,CAAC,UAAU;QACjH,MAAM,SAAS,MAAM,KAAK;QAC1B,QAAQ,OAAO,KAAK;IACtB;IAEA,IAAI,OAAO,MAAM,IAAI,MAAM,AAAC,MAAc,OAAO;AACnD;AAEO,eAAe,iBAAiB,EAAU;IAC/C,MAAM,EAAE,KAAK,EAAE,GAAG,MAAM,iIAAQ,CAAC,IAAI,CAAC,eAAe,MAAM,GAAG,EAAE,CAAC,MAAM;IACvE,IAAI,OAAO,MAAM;AACnB"}},
    {"offset": {"line": 751, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/Martin/Desktop/PROYECTOS/Tienda-Blama-2026/features/admin/services/preguntas.client.ts"],"sourcesContent":["import { supabase } from \"@/lib/supabaseClient\"\r\n\r\nexport async function fetchAdminQuestions() {\r\n  const { data, error } = await supabase\r\n    .from(\"product_questions\")\r\n    .select(\r\n      \"id, product_id, question, asker_name, asker_phone, published, created_at, productos(nombre), product_answers(id, answer, answered_by, created_at, published)\"\r\n    )\r\n    .order(\"created_at\", { ascending: false })\r\n    .limit(200)\r\n\r\n  if (error) throw error\r\n  return (data as any[]) || []\r\n}\r\n\r\nexport async function setQuestionPublished(args: { id: number; published: boolean }) {\r\n  const { error } = await supabase.from(\"product_questions\").update({ published: args.published }).eq(\"id\", args.id)\r\n  if (error) throw error\r\n}\r\n\r\nexport async function saveQuestionAnswer(args: { questionId: number; answer: string }) {\r\n  const answer = String(args.answer || \"\").trim()\r\n\r\n  const { data: sessionRes } = await supabase.auth.getSession()\r\n  const userId = (sessionRes as any)?.session?.user?.id || null\r\n\r\n  let answeredBy: string | null = null\r\n  if (userId) {\r\n    const { data: profile } = await supabase.from(\"profiles\").select(\"email, nombre\").eq(\"id\", userId).maybeSingle()\r\n    answeredBy = String((profile as any)?.nombre || (profile as any)?.email || \"Admin\")\r\n  }\r\n\r\n  const { data: current } = await supabase\r\n    .from(\"product_questions\")\r\n    .select(\"id, product_answers(id)\")\r\n    .eq(\"id\", args.questionId)\r\n    .maybeSingle()\r\n\r\n  const existingId =\r\n    current && Array.isArray((current as any).product_answers) && (current as any).product_answers.length > 0\r\n      ? Number((current as any).product_answers[0]?.id)\r\n      : null\r\n\r\n  if (existingId) {\r\n    const { error } = await supabase\r\n      .from(\"product_answers\")\r\n      .update({ answer, answered_by: answeredBy, published: true })\r\n      .eq(\"id\", existingId)\r\n    if (error) throw error\r\n  } else {\r\n    const { error } = await supabase\r\n      .from(\"product_answers\")\r\n      .insert({ question_id: args.questionId, answer, answered_by: answeredBy, published: true })\r\n    if (error) throw error\r\n  }\r\n\r\n  const { error: pubErr } = await supabase.from(\"product_questions\").update({ published: true }).eq(\"id\", args.questionId)\r\n  if (pubErr) throw pubErr\r\n}\r\n"],"names":[],"mappings":";;;;;;;;AAAA;;AAEO,eAAe;IACpB,MAAM,EAAE,IAAI,EAAE,KAAK,EAAE,GAAG,MAAM,iIAAQ,CACnC,IAAI,CAAC,qBACL,MAAM,CACL,gKAED,KAAK,CAAC,cAAc;QAAE,WAAW;IAAM,GACvC,KAAK,CAAC;IAET,IAAI,OAAO,MAAM;IACjB,OAAO,AAAC,QAAkB,EAAE;AAC9B;AAEO,eAAe,qBAAqB,IAAwC;IACjF,MAAM,EAAE,KAAK,EAAE,GAAG,MAAM,iIAAQ,CAAC,IAAI,CAAC,qBAAqB,MAAM,CAAC;QAAE,WAAW,KAAK,SAAS;IAAC,GAAG,EAAE,CAAC,MAAM,KAAK,EAAE;IACjH,IAAI,OAAO,MAAM;AACnB;AAEO,eAAe,mBAAmB,IAA4C;IACnF,MAAM,SAAS,OAAO,KAAK,MAAM,IAAI,IAAI,IAAI;IAE7C,MAAM,EAAE,MAAM,UAAU,EAAE,GAAG,MAAM,iIAAQ,CAAC,IAAI,CAAC,UAAU;IAC3D,MAAM,SAAS,AAAC,YAAoB,SAAS,MAAM,MAAM;IAEzD,IAAI,aAA4B;IAChC,IAAI,QAAQ;QACV,MAAM,EAAE,MAAM,OAAO,EAAE,GAAG,MAAM,iIAAQ,CAAC,IAAI,CAAC,YAAY,MAAM,CAAC,iBAAiB,EAAE,CAAC,MAAM,QAAQ,WAAW;QAC9G,aAAa,OAAO,AAAC,SAAiB,UAAW,SAAiB,SAAS;IAC7E;IAEA,MAAM,EAAE,MAAM,OAAO,EAAE,GAAG,MAAM,iIAAQ,CACrC,IAAI,CAAC,qBACL,MAAM,CAAC,2BACP,EAAE,CAAC,MAAM,KAAK,UAAU,EACxB,WAAW;IAEd,MAAM,aACJ,WAAW,MAAM,OAAO,CAAC,AAAC,QAAgB,eAAe,KAAK,AAAC,QAAgB,eAAe,CAAC,MAAM,GAAG,IACpG,OAAO,AAAC,QAAgB,eAAe,CAAC,EAAE,EAAE,MAC5C;IAEN,IAAI,YAAY;QACd,MAAM,EAAE,KAAK,EAAE,GAAG,MAAM,iIAAQ,CAC7B,IAAI,CAAC,mBACL,MAAM,CAAC;YAAE;YAAQ,aAAa;YAAY,WAAW;QAAK,GAC1D,EAAE,CAAC,MAAM;QACZ,IAAI,OAAO,MAAM;IACnB,OAAO;QACL,MAAM,EAAE,KAAK,EAAE,GAAG,MAAM,iIAAQ,CAC7B,IAAI,CAAC,mBACL,MAAM,CAAC;YAAE,aAAa,KAAK,UAAU;YAAE;YAAQ,aAAa;YAAY,WAAW;QAAK;QAC3F,IAAI,OAAO,MAAM;IACnB;IAEA,MAAM,EAAE,OAAO,MAAM,EAAE,GAAG,MAAM,iIAAQ,CAAC,IAAI,CAAC,qBAAqB,MAAM,CAAC;QAAE,WAAW;IAAK,GAAG,EAAE,CAAC,MAAM,KAAK,UAAU;IACvH,IAAI,QAAQ,MAAM;AACpB"}},
    {"offset": {"line": 810, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/Martin/Desktop/PROYECTOS/Tienda-Blama-2026/features/admin/services/resenas.client.ts"],"sourcesContent":["import { supabase } from \"@/lib/supabaseClient\"\r\n\r\nexport async function fetchAdminReviews() {\r\n  const { data, error } = await supabase\r\n    .from(\"product_reviews\")\r\n    .select(\"id, product_id, rating, title, body, customer_name, customer_city, verified, approved, created_at, productos(nombre)\")\r\n    .order(\"created_at\", { ascending: false })\r\n    .limit(200)\r\n\r\n  if (error) throw error\r\n  return (data as any[]) || []\r\n}\r\n\r\nexport async function setReviewApproved(args: { id: number; approved: boolean }) {\r\n  const { error } = await supabase.from(\"product_reviews\").update({ approved: args.approved }).eq(\"id\", args.id)\r\n  if (error) throw error\r\n}\r\n\r\nexport async function deleteReview(id: number) {\r\n  const { error } = await supabase.from(\"product_reviews\").delete().eq(\"id\", id)\r\n  if (error) throw error\r\n}\r\n"],"names":[],"mappings":";;;;;;;;AAAA;;AAEO,eAAe;IACpB,MAAM,EAAE,IAAI,EAAE,KAAK,EAAE,GAAG,MAAM,iIAAQ,CACnC,IAAI,CAAC,mBACL,MAAM,CAAC,wHACP,KAAK,CAAC,cAAc;QAAE,WAAW;IAAM,GACvC,KAAK,CAAC;IAET,IAAI,OAAO,MAAM;IACjB,OAAO,AAAC,QAAkB,EAAE;AAC9B;AAEO,eAAe,kBAAkB,IAAuC;IAC7E,MAAM,EAAE,KAAK,EAAE,GAAG,MAAM,iIAAQ,CAAC,IAAI,CAAC,mBAAmB,MAAM,CAAC;QAAE,UAAU,KAAK,QAAQ;IAAC,GAAG,EAAE,CAAC,MAAM,KAAK,EAAE;IAC7G,IAAI,OAAO,MAAM;AACnB;AAEO,eAAe,aAAa,EAAU;IAC3C,MAAM,EAAE,KAAK,EAAE,GAAG,MAAM,iIAAQ,CAAC,IAAI,CAAC,mBAAmB,MAAM,GAAG,EAAE,CAAC,MAAM;IAC3E,IAAI,OAAO,MAAM;AACnB"}},
    {"offset": {"line": 841, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/Martin/Desktop/PROYECTOS/Tienda-Blama-2026/features/admin/services/clientes.client.ts"],"sourcesContent":["import { supabase } from \"@/lib/supabaseClient\"\r\n\r\nexport async function fetchAdminClientes() {\r\n  const { data, error } = await supabase.from(\"clientes\").select(\"*\").order(\"id\", { ascending: false })\r\n  if (error) throw error\r\n  return (data as any[]) || []\r\n}\r\n"],"names":[],"mappings":";;;;AAAA;;AAEO,eAAe;IACpB,MAAM,EAAE,IAAI,EAAE,KAAK,EAAE,GAAG,MAAM,iIAAQ,CAAC,IAAI,CAAC,YAAY,MAAM,CAAC,KAAK,KAAK,CAAC,MAAM;QAAE,WAAW;IAAM;IACnG,IAAI,OAAO,MAAM;IACjB,OAAO,AAAC,QAAkB,EAAE;AAC9B"}},
    {"offset": {"line": 858, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/Martin/Desktop/PROYECTOS/Tienda-Blama-2026/features/admin/index.ts"],"sourcesContent":["export * from \"@/features/admin/types\"\r\nexport * from \"@/features/admin/services/dashboard.client\"\r\nexport * from \"@/features/admin/services/pedidos.client\"\r\nexport * from \"@/features/admin/services/productos.client\"\r\nexport * from \"@/features/admin/services/usuarios.client\"\r\nexport * from \"@/features/admin/services/cupones.client\"\r\nexport * from \"@/features/admin/services/banners.client\"\r\nexport * from \"@/features/admin/services/announcement-bar.client\"\r\nexport * from \"@/features/admin/services/incidencias.client\"\r\nexport * from \"@/features/admin/services/preguntas.client\"\r\nexport * from \"@/features/admin/services/resenas.client\"\r\nexport * from \"@/features/admin/services/clientes.client\"\r\n"],"names":[],"mappings":";AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA"}},
    {"offset": {"line": 887, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/Martin/Desktop/PROYECTOS/Tienda-Blama-2026/app/admin/productos/%5Bid%5D/editar/page.tsx"],"sourcesContent":["\"use client\"\r\n\r\nimport { useEffect, useState } from \"react\"\r\nimport Link from \"next/link\"\r\nimport { useParams, useRouter } from \"next/navigation\"\r\nimport { Button } from \"@/components/ui/button\"\r\nimport { Card, CardContent } from \"@/components/ui/card\"\r\nimport { ProductForm } from \"@/components/admin/product-form\"\r\nimport { ArrowLeft } from \"lucide-react\"\r\nimport { useRoleGuard } from \"@/lib/use-role-guard\"\r\nimport { AccessDenied } from \"@/components/admin/access-denied\"\r\nimport { fetchAdminProductoById, fetchAdminCategorias } from \"@/features/admin\"\r\n\r\nexport default function EditarProductoPage() {\r\n    const router = useRouter()\r\n    const params = useParams()\r\n    const id = params.id as string\r\n\r\n    const guard = useRoleGuard({ allowedRoles: ['admin'] })\r\n\r\n    const [loading, setLoading] = useState(true)\r\n    const [producto, setProducto] = useState<any>(null)\r\n    const [categories, setCategories] = useState<any[]>([])\r\n\r\n    useEffect(() => {\r\n        if (guard.loading || guard.accessDenied) return\r\n        loadProducto()\r\n        // eslint-disable-next-line react-hooks/exhaustive-deps\r\n    }, [id, guard.loading, guard.accessDenied])\r\n\r\n    async function loadProducto() {\r\n        setLoading(true)\r\n\r\n        const numericId = Number(id)\r\n        if (!numericId) {\r\n            setProducto(null)\r\n            setLoading(false)\r\n            return\r\n        }\r\n\r\n        try {\r\n            const [prodData, catData] = await Promise.all([\r\n                fetchAdminProductoById(numericId),\r\n                fetchAdminCategorias()\r\n            ])\r\n            setProducto(prodData)\r\n            setCategories(catData || [])\r\n        } catch (err) {\r\n            console.error(err)\r\n            setProducto(null)\r\n            setCategories([])\r\n        }\r\n\r\n        setLoading(false)\r\n    }\r\n\r\n    if (guard.accessDenied) return <AccessDenied />\r\n\r\n    if (guard.loading) {\r\n        return <div className=\"p-6 text-muted-foreground\">Cargando...</div>\r\n    }\r\n\r\n    if (loading) {\r\n        return <div className=\"p-6 text-muted-foreground\">Cargando...</div>\r\n    }\r\n\r\n    if (!producto) {\r\n        return (\r\n            <div className=\"space-y-4\">\r\n                <Button variant=\"ghost\" className=\"gap-2\" asChild>\r\n                    <Link href=\"/admin/productos\">\r\n                        <ArrowLeft className=\"h-4 w-4\" /> Volver\r\n                    </Link>\r\n                </Button>\r\n                <Card className=\"bg-white rounded-xl shadow-sm border\">\r\n                    <CardContent className=\"p-6\">\r\n                        <div className=\"text-lg font-bold text-gray-900\">Producto no encontrado</div>\r\n                        <div className=\"text-sm text-gray-500\">Puede que haya sido eliminado o no exista.</div>\r\n                    </CardContent>\r\n                </Card>\r\n            </div>\r\n        )\r\n    }\r\n\r\n    return (\r\n        <div className=\"space-y-6\">\r\n            <div className=\"flex items-center justify-between gap-3\">\r\n                <Button variant=\"ghost\" className=\"gap-2\" asChild>\r\n                    <Link href=\"/admin/productos\">\r\n                        <ArrowLeft className=\"h-4 w-4\" /> Volver\r\n                    </Link>\r\n                </Button>\r\n                <div>\r\n                    <h1 className=\"text-3xl font-bold text-gray-900\">Editar Producto</h1>\r\n                    <p className=\"text-gray-500\">Actualiza la informaciÃ³n del producto.</p>\r\n                </div>\r\n                <div />\r\n            </div>\r\n\r\n            <Card className=\"bg-white rounded-xl shadow-sm border\">\r\n                <CardContent className=\"p-6\">\r\n                    <ProductForm\r\n                        productToEdit={producto}\r\n                        categories={categories}\r\n                        onSuccess={() => router.push('/admin/productos')}\r\n                        onCancel={() => router.push('/admin/productos')}\r\n                    />\r\n                </CardContent>\r\n            </Card>\r\n        </div>\r\n    )\r\n}\r\n"],"names":[],"mappings":";;;;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAAA;AAXA;;;;;;;;;;;;AAae,SAAS;IACpB,MAAM,SAAS,IAAA,+IAAS;IACxB,MAAM,SAAS,IAAA,+IAAS;IACxB,MAAM,KAAK,OAAO,EAAE;IAEpB,MAAM,QAAQ,IAAA,2IAAY,EAAC;QAAE,cAAc;YAAC;SAAQ;IAAC;IAErD,MAAM,CAAC,SAAS,WAAW,GAAG,IAAA,iNAAQ,EAAC;IACvC,MAAM,CAAC,UAAU,YAAY,GAAG,IAAA,iNAAQ,EAAM;IAC9C,MAAM,CAAC,YAAY,cAAc,GAAG,IAAA,iNAAQ,EAAQ,EAAE;IAEtD,IAAA,kNAAS,EAAC;QACN,IAAI,MAAM,OAAO,IAAI,MAAM,YAAY,EAAE;QACzC;IACA,uDAAuD;IAC3D,GAAG;QAAC;QAAI,MAAM,OAAO;QAAE,MAAM,YAAY;KAAC;IAE1C,eAAe;QACX,WAAW;QAEX,MAAM,YAAY,OAAO;QACzB,IAAI,CAAC,WAAW;YACZ,YAAY;YACZ,WAAW;YACX;QACJ;QAEA,IAAI;YACA,MAAM,CAAC,UAAU,QAAQ,GAAG,MAAM,QAAQ,GAAG,CAAC;gBAC1C,IAAA,8KAAsB,EAAC;gBACvB,IAAA,4KAAoB;aACvB;YACD,YAAY;YACZ,cAAc,WAAW,EAAE;QAC/B,EAAE,OAAO,KAAK;YACV,QAAQ,KAAK,CAAC;YACd,YAAY;YACZ,cAAc,EAAE;QACpB;QAEA,WAAW;IACf;IAEA,IAAI,MAAM,YAAY,EAAE,qBAAO,8OAAC,wJAAY;;;;;IAE5C,IAAI,MAAM,OAAO,EAAE;QACf,qBAAO,8OAAC;YAAI,WAAU;sBAA4B;;;;;;IACtD;IAEA,IAAI,SAAS;QACT,qBAAO,8OAAC;YAAI,WAAU;sBAA4B;;;;;;IACtD;IAEA,IAAI,CAAC,UAAU;QACX,qBACI,8OAAC;YAAI,WAAU;;8BACX,8OAAC,qIAAM;oBAAC,SAAQ;oBAAQ,WAAU;oBAAQ,OAAO;8BAC7C,cAAA,8OAAC,uKAAI;wBAAC,MAAK;;0CACP,8OAAC,6NAAS;gCAAC,WAAU;;;;;;4BAAY;;;;;;;;;;;;8BAGzC,8OAAC,iIAAI;oBAAC,WAAU;8BACZ,cAAA,8OAAC,wIAAW;wBAAC,WAAU;;0CACnB,8OAAC;gCAAI,WAAU;0CAAkC;;;;;;0CACjD,8OAAC;gCAAI,WAAU;0CAAwB;;;;;;;;;;;;;;;;;;;;;;;IAK3D;IAEA,qBACI,8OAAC;QAAI,WAAU;;0BACX,8OAAC;gBAAI,WAAU;;kCACX,8OAAC,qIAAM;wBAAC,SAAQ;wBAAQ,WAAU;wBAAQ,OAAO;kCAC7C,cAAA,8OAAC,uKAAI;4BAAC,MAAK;;8CACP,8OAAC,6NAAS;oCAAC,WAAU;;;;;;gCAAY;;;;;;;;;;;;kCAGzC,8OAAC;;0CACG,8OAAC;gCAAG,WAAU;0CAAmC;;;;;;0CACjD,8OAAC;gCAAE,WAAU;0CAAgB;;;;;;;;;;;;kCAEjC,8OAAC;;;;;;;;;;;0BAGL,8OAAC,iIAAI;gBAAC,WAAU;0BACZ,cAAA,8OAAC,wIAAW;oBAAC,WAAU;8BACnB,cAAA,8OAAC,sJAAW;wBACR,eAAe;wBACf,YAAY;wBACZ,WAAW,IAAM,OAAO,IAAI,CAAC;wBAC7B,UAAU,IAAM,OAAO,IAAI,CAAC;;;;;;;;;;;;;;;;;;;;;;AAMpD"}}]
}