{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 4, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/Martin/Desktop/PROYECTOS/Tienda-Blama-2026/components/ui/card.tsx"],"sourcesContent":["import * as React from \"react\"\r\n\r\nimport { cn } from \"@/lib/utils\"\r\n\r\nfunction Card({ className, ...props }: React.ComponentProps<\"div\">) {\r\n  return (\r\n    <div\r\n      data-slot=\"card\"\r\n      className={cn(\r\n        \"bg-card text-card-foreground flex flex-col gap-6 rounded-xl border py-6 shadow-sm\",\r\n        className\r\n      )}\r\n      {...props}\r\n    />\r\n  )\r\n}\r\n\r\nfunction CardHeader({ className, ...props }: React.ComponentProps<\"div\">) {\r\n  return (\r\n    <div\r\n      data-slot=\"card-header\"\r\n      className={cn(\r\n        \"@container/card-header grid auto-rows-min grid-rows-[auto_auto] items-start gap-2 px-6 has-data-[slot=card-action]:grid-cols-[1fr_auto] [.border-b]:pb-6\",\r\n        className\r\n      )}\r\n      {...props}\r\n    />\r\n  )\r\n}\r\n\r\nfunction CardTitle({ className, ...props }: React.ComponentProps<\"div\">) {\r\n  return (\r\n    <div\r\n      data-slot=\"card-title\"\r\n      className={cn(\"leading-none font-semibold\", className)}\r\n      {...props}\r\n    />\r\n  )\r\n}\r\n\r\nfunction CardDescription({ className, ...props }: React.ComponentProps<\"div\">) {\r\n  return (\r\n    <div\r\n      data-slot=\"card-description\"\r\n      className={cn(\"text-muted-foreground text-sm\", className)}\r\n      {...props}\r\n    />\r\n  )\r\n}\r\n\r\nfunction CardAction({ className, ...props }: React.ComponentProps<\"div\">) {\r\n  return (\r\n    <div\r\n      data-slot=\"card-action\"\r\n      className={cn(\r\n        \"col-start-2 row-span-2 row-start-1 self-start justify-self-end\",\r\n        className\r\n      )}\r\n      {...props}\r\n    />\r\n  )\r\n}\r\n\r\nfunction CardContent({ className, ...props }: React.ComponentProps<\"div\">) {\r\n  return (\r\n    <div\r\n      data-slot=\"card-content\"\r\n      className={cn(\"px-6\", className)}\r\n      {...props}\r\n    />\r\n  )\r\n}\r\n\r\nfunction CardFooter({ className, ...props }: React.ComponentProps<\"div\">) {\r\n  return (\r\n    <div\r\n      data-slot=\"card-footer\"\r\n      className={cn(\"flex items-center px-6 [.border-t]:pt-6\", className)}\r\n      {...props}\r\n    />\r\n  )\r\n}\r\n\r\nexport {\r\n  Card,\r\n  CardHeader,\r\n  CardFooter,\r\n  CardTitle,\r\n  CardAction,\r\n  CardDescription,\r\n  CardContent,\r\n}\r\n"],"names":[],"mappings":";;;;;;;;;;;;;;;;;AAEA;;;AAEA,SAAS,KAAK,EAAE,SAAS,EAAE,GAAG,OAAoC;IAChE,qBACE,6LAAC;QACC,aAAU;QACV,WAAW,IAAA,qHAAE,EACX,qFACA;QAED,GAAG,KAAK;;;;;;AAGf;KAXS;AAaT,SAAS,WAAW,EAAE,SAAS,EAAE,GAAG,OAAoC;IACtE,qBACE,6LAAC;QACC,aAAU;QACV,WAAW,IAAA,qHAAE,EACX,4JACA;QAED,GAAG,KAAK;;;;;;AAGf;MAXS;AAaT,SAAS,UAAU,EAAE,SAAS,EAAE,GAAG,OAAoC;IACrE,qBACE,6LAAC;QACC,aAAU;QACV,WAAW,IAAA,qHAAE,EAAC,8BAA8B;QAC3C,GAAG,KAAK;;;;;;AAGf;MARS;AAUT,SAAS,gBAAgB,EAAE,SAAS,EAAE,GAAG,OAAoC;IAC3E,qBACE,6LAAC;QACC,aAAU;QACV,WAAW,IAAA,qHAAE,EAAC,iCAAiC;QAC9C,GAAG,KAAK;;;;;;AAGf;MARS;AAUT,SAAS,WAAW,EAAE,SAAS,EAAE,GAAG,OAAoC;IACtE,qBACE,6LAAC;QACC,aAAU;QACV,WAAW,IAAA,qHAAE,EACX,kEACA;QAED,GAAG,KAAK;;;;;;AAGf;MAXS;AAaT,SAAS,YAAY,EAAE,SAAS,EAAE,GAAG,OAAoC;IACvE,qBACE,6LAAC;QACC,aAAU;QACV,WAAW,IAAA,qHAAE,EAAC,QAAQ;QACrB,GAAG,KAAK;;;;;;AAGf;MARS;AAUT,SAAS,WAAW,EAAE,SAAS,EAAE,GAAG,OAAoC;IACtE,qBACE,6LAAC;QACC,aAAU;QACV,WAAW,IAAA,qHAAE,EAAC,2CAA2C;QACxD,GAAG,KAAK;;;;;;AAGf;MARS"}},
    {"offset": {"line": 124, "column": 0}, "map": {"version":3,"sources":[],"names":[],"mappings":""}},
    {"offset": {"line": 133, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/Martin/Desktop/PROYECTOS/Tienda-Blama-2026/features/admin/services/dashboard.client.ts"],"sourcesContent":["import { supabase } from \"@/lib/supabaseClient\"\r\n\r\nimport type { AdminDashboardStats, AdminRole } from \"@/features/admin/types\"\r\n\r\nexport async function fetchAdminDashboardStats(args: { role: AdminRole | string; currentUserId: string }): Promise<AdminDashboardStats> {\r\n  const role = String(args.role || \"worker\")\r\n  const currentUserId = String(args.currentUserId || \"\")\r\n\r\n  const { data: pedidos } = await supabase\r\n    .from(\"pedidos\")\r\n    .select(\"id, total, status, asignado_a, created_at\")\r\n\r\n  const deliveredSales = (pedidos || []).filter((p: any) => p.status === \"Entregado\")\r\n  const totalVentasReales = deliveredSales.reduce((sum: number, p: any) => sum + (Number(p.total) || 0), 0)\r\n\r\n  const today = new Date()\r\n  const yyyy = today.getFullYear()\r\n  const mm = String(today.getMonth() + 1).padStart(2, \"0\")\r\n  const dd = String(today.getDate()).padStart(2, \"0\")\r\n  const todayPrefix = `${yyyy}-${mm}-${dd}`\r\n\r\n  const ventasHoy = deliveredSales\r\n    .filter((p: any) => typeof p.created_at === \"string\" && p.created_at.startsWith(todayPrefix))\r\n    .reduce((sum: number, p: any) => sum + (Number(p.total) || 0), 0)\r\n\r\n  const pedidosPendientes = (pedidos || []).filter((p: any) => p.status === \"Pendiente\").length\r\n  const pedidosEnProceso = (pedidos || []).filter((p: any) => [\"Confirmado\", \"Preparando\", \"Enviado\"].includes(p.status)).length\r\n  const pedidosEntregados = deliveredSales.length\r\n\r\n  const pedidosAsignados = (pedidos || []).filter(\r\n    (p: any) => p.asignado_a === currentUserId && ![\"Fallido\", \"Devuelto\", \"Entregado\"].includes(p.status)\r\n  ).length\r\n\r\n  let totalClientes = 0\r\n  if (role === \"admin\") {\r\n    const { count } = await supabase.from(\"clientes\").select(\"*\", { count: \"exact\", head: true })\r\n    totalClientes = count || 0\r\n  }\r\n\r\n  let productosLowStock = 0\r\n  if (role === \"admin\") {\r\n    const { count } = await supabase.from(\"productos\").select(\"*\", { count: \"exact\", head: true }).lt(\"stock\", 5)\r\n    productosLowStock = count || 0\r\n  }\r\n\r\n  return {\r\n    totalVentasReales,\r\n    ventasHoy,\r\n    pedidosPendientes,\r\n    pedidosEnProceso,\r\n    pedidosEntregados,\r\n    pedidosAsignados,\r\n    totalClientes,\r\n    productosLowStock,\r\n  }\r\n}\r\n\r\nexport async function fetchAdminVentasEntregadas(args: { from: string; to: string }) {\r\n  const fromIso = args.from ? `${args.from}T00:00:00.000Z` : undefined\r\n  const toIso = args.to ? `${args.to}T23:59:59.999Z` : undefined\r\n\r\n  let query = supabase\r\n    .from(\"pedidos\")\r\n    .select(\"id, total, status, created_at, clientes (nombre, telefono, dni)\")\r\n    .eq(\"status\", \"Entregado\")\r\n    .order(\"created_at\", { ascending: false })\r\n\r\n  if (fromIso) query = query.gte(\"created_at\", fromIso)\r\n  if (toIso) query = query.lte(\"created_at\", toIso)\r\n\r\n  const { data, error } = await query\r\n  if (error) throw error\r\n  return (data as any[]) || []\r\n}\r\n\r\nexport async function fetchAdminStockBajo(args: { threshold: number }) {\r\n  const th = Number(args.threshold)\r\n  const { data, error } = await supabase\r\n    .from(\"productos\")\r\n    .select(\"id, nombre, precio, stock, imagen_url\")\r\n    .lt(\"stock\", th)\r\n    .order(\"stock\", { ascending: true })\r\n\r\n  if (error) throw error\r\n  return (data as any[]) || []\r\n}\r\n\r\nexport async function fetchAdminPedidosPendientes() {\r\n  const { data, error } = await supabase\r\n    .from(\"pedidos\")\r\n    .select(\"id, total, status, created_at, clientes (nombre, telefono, dni)\")\r\n    .eq(\"status\", \"Pendiente\")\r\n    .order(\"created_at\", { ascending: false })\r\n\r\n  if (error) throw error\r\n  return (data as any[]) || []\r\n}\r\n\r\nconst PROCESS_STATUSES = [\"Confirmado\", \"Preparando\", \"Enviado\"] as const\r\ntype ProcessStatus = (typeof PROCESS_STATUSES)[number]\r\ntype StatusFilter = ProcessStatus | \"all\"\r\n\r\nexport async function fetchAdminPedidosEnProceso(args: { status: StatusFilter; from: string; to: string }) {\r\n  const fromIso = args.from ? `${args.from}T00:00:00.000Z` : undefined\r\n  const toIso = args.to ? `${args.to}T23:59:59.999Z` : undefined\r\n\r\n  let query = supabase\r\n    .from(\"pedidos\")\r\n    .select(\"id, total, status, created_at, asignado_a, clientes (nombre, telefono, dni)\")\r\n    .in(\"status\", PROCESS_STATUSES as unknown as string[])\r\n    .order(\"created_at\", { ascending: false })\r\n\r\n  if (args.status !== \"all\") query = query.eq(\"status\", args.status)\r\n  if (fromIso) query = query.gte(\"created_at\", fromIso)\r\n  if (toIso) query = query.lte(\"created_at\", toIso)\r\n\r\n  const { data, error } = await query\r\n  if (error) throw error\r\n  return (data as any[]) || []\r\n}\r\n"],"names":[],"mappings":"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"}},
    {"offset": {"line": 250, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/Martin/Desktop/PROYECTOS/Tienda-Blama-2026/features/admin/services/pedidos.client.ts"],"sourcesContent":["import { supabase } from \"@/lib/supabaseClient\"\r\n\r\nimport type { AdminRole, PedidoItemRow, PedidoRow, ProfileRow } from \"@/features/admin/types\"\r\n\r\nexport async function fetchAdminWorkers() {\r\n  const { data, error } = await supabase.from(\"profiles\").select(\"id, email, nombre, role\").eq(\"role\", \"worker\")\r\n  if (error) throw error\r\n  return ((data as any[]) || []) as ProfileRow[]\r\n}\r\n\r\nexport async function fetchPedidosForRole(args: { role: AdminRole | string; currentUserId: string }) {\r\n  const role = String(args.role || \"worker\")\r\n  const currentUserId = String(args.currentUserId || \"\")\r\n\r\n  let query = supabase\r\n    .from(\"pedidos\")\r\n    .select(\r\n      `\r\n        *,\r\n        clientes (nombre, telefono, dni)\r\n      `\r\n    )\r\n    .order(\"created_at\", { ascending: false })\r\n\r\n  if (role === \"worker\") {\r\n    query = query.eq(\"asignado_a\", currentUserId)\r\n  }\r\n\r\n  const { data, error } = await query\r\n\r\n  if (error) {\r\n    if (String(error.message || \"\").includes(\"asignado_a\")) {\r\n      const { data: fallbackData } = await supabase\r\n        .from(\"pedidos\")\r\n        .select(`*, clientes (nombre, telefono, dni)`)\r\n        .order(\"created_at\", { ascending: false })\r\n      return ((fallbackData as any[]) || []) as PedidoRow[]\r\n    }\r\n    throw error\r\n  }\r\n\r\n  const rows = ((data as any[]) || []) as PedidoRow[]\r\n\r\n  const withWorkers = await Promise.all(\r\n    rows.map(async (pedido: any) => {\r\n      if (pedido.asignado_a) {\r\n        const { data: workerProfile } = await supabase\r\n          .from(\"profiles\")\r\n          .select(\"id, email, nombre\")\r\n          .eq(\"id\", pedido.asignado_a)\r\n          .single()\r\n        return { ...pedido, asignado_perfil: (workerProfile as any) || null }\r\n      }\r\n      return { ...pedido, asignado_perfil: null }\r\n    })\r\n  )\r\n\r\n  return withWorkers as PedidoRow[]\r\n}\r\n\r\nexport async function assignPedidoToWorker(args: { pedidoId: number; workerId: string | null }) {\r\n  const assignValue = args.workerId ? String(args.workerId) : null\r\n  const { error } = await supabase\r\n    .from(\"pedidos\")\r\n    .update({\r\n      asignado_a: assignValue,\r\n      fecha_asignacion: assignValue ? new Date().toISOString() : null,\r\n    })\r\n    .eq(\"id\", args.pedidoId)\r\n\r\n  if (error) throw error\r\n}\r\n\r\nexport async function fetchPedidoDetail(pedidoId: number) {\r\n  const { data: pedidoData, error } = await supabase\r\n    .from(\"pedidos\")\r\n    .select(\r\n      `\r\n        *,\r\n        clientes (*)\r\n      `\r\n    )\r\n    .eq(\"id\", pedidoId)\r\n    .single()\r\n\r\n  if (error) throw error\r\n\r\n  let asignadoPerfil: any = null\r\n  if ((pedidoData as any)?.asignado_a) {\r\n    const { data: workerProfile } = await supabase\r\n      .from(\"profiles\")\r\n      .select(\"id, email, nombre\")\r\n      .eq(\"id\", (pedidoData as any).asignado_a)\r\n      .single()\r\n    asignadoPerfil = workerProfile\r\n  }\r\n\r\n  const pedido = { ...(pedidoData as any), asignado_perfil: asignadoPerfil } as PedidoRow\r\n\r\n  const { data: itemsData, error: itemsErr } = await supabase\r\n    .from(\"pedido_items\")\r\n    .select(\r\n      `\r\n        *,\r\n        productos (nombre, precio, imagen_url)\r\n      `\r\n    )\r\n    .eq(\"pedido_id\", pedidoId)\r\n\r\n  if (itemsErr) throw itemsErr\r\n\r\n  return {\r\n    pedido,\r\n    items: ((itemsData as any[]) || []) as PedidoItemRow[],\r\n  }\r\n}\r\n\r\nexport async function updatePedidoStatusWithStock(args: { pedidoId: number; nextStatus: string; stockDescontado: boolean }) {\r\n  const pedidoId = Number(args.pedidoId)\r\n  const nextStatus = String(args.nextStatus || \"\")\r\n\r\n  if (nextStatus === \"Confirmado\" && !args.stockDescontado) {\r\n    const { data: itemsData, error: itemsError } = await supabase\r\n      .from(\"pedido_items\")\r\n      .select(\"producto_id, producto_variante_id, cantidad\")\r\n      .eq(\"pedido_id\", pedidoId)\r\n\r\n    if (itemsError) throw itemsError\r\n\r\n    const safeItems = (itemsData || []).filter((it: any) => it.producto_id)\r\n\r\n    for (const it of safeItems) {\r\n      const productoId = Number(it.producto_id)\r\n      const varianteId = it.producto_variante_id != null ? Number(it.producto_variante_id) : null\r\n      const qty = Number(it.cantidad || 0)\r\n      if (!productoId || qty <= 0) continue\r\n\r\n      if (varianteId) {\r\n        const { data: variante, error: varError } = await supabase\r\n          .from(\"producto_variantes\")\r\n          .select(\"stock\")\r\n          .eq(\"id\", varianteId)\r\n          .single()\r\n\r\n        if (varError) throw varError\r\n\r\n        const currentStock = Number((variante as any)?.stock ?? 0)\r\n        const newStock = Math.max(0, currentStock - qty)\r\n\r\n        const { error: updError } = await supabase.from(\"producto_variantes\").update({ stock: newStock }).eq(\"id\", varianteId)\r\n\r\n        if (updError) throw updError\r\n      } else {\r\n        const { data: producto, error: prodError } = await supabase.from(\"productos\").select(\"stock\").eq(\"id\", productoId).single()\r\n\r\n        if (prodError) throw prodError\r\n\r\n        const currentStock = Number((producto as any)?.stock ?? 0)\r\n        const newStock = Math.max(0, currentStock - qty)\r\n\r\n        const { error: updError } = await supabase.from(\"productos\").update({ stock: newStock }).eq(\"id\", productoId)\r\n\r\n        if (updError) throw updError\r\n      }\r\n    }\r\n\r\n    const { error: markError } = await supabase.from(\"pedidos\").update({ stock_descontado: true }).eq(\"id\", pedidoId)\r\n    if (markError) throw markError\r\n  }\r\n\r\n  const { error } = await supabase.from(\"pedidos\").update({ status: nextStatus }).eq(\"id\", pedidoId)\r\n  if (error) throw error\r\n}\r\n"],"names":[],"mappings":"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"}},
    {"offset": {"line": 389, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/Martin/Desktop/PROYECTOS/Tienda-Blama-2026/features/admin/services/productos.client.ts"],"sourcesContent":["import { supabase } from \"@/lib/supabaseClient\"\r\n\r\nexport async function fetchAdminProductos() {\r\n  const { data, error } = await supabase.from(\"productos\").select(\"*\").order(\"id\", { ascending: true })\r\n  if (error) throw error\r\n  return (data as any[]) || []\r\n}\r\n\r\nexport async function fetchAdminProductoById(id: number) {\r\n  const { data, error } = await supabase.from(\"productos\").select(\"*\").eq(\"id\", id).single()\r\n  if (error) throw error\r\n  return data as any\r\n}\r\n\r\nexport async function fetchAdminCategorias() {\r\n  const { data, error } = await supabase.from(\"categorias\").select(\"*\")\r\n  if (error) throw error\r\n  return (data as any[]) || []\r\n}\r\n\r\nexport async function createAdminCategoria(args: { nombre: string }) {\r\n  const nombre = String(args.nombre || \"\").trim()\r\n  const slug = nombre.toLowerCase().replace(/ /g, \"-\").replace(/[^\\w-]+/g, \"\")\r\n  const { data, error } = await supabase.from(\"categorias\").insert({ nombre, slug }).select().single()\r\n  if (error) throw error\r\n  return data as any\r\n}\r\n\r\nexport async function fetchProductoSpecsAndVariants(productId: number) {\r\n  const [specRes, varRes] = await Promise.all([\r\n    supabase.from(\"producto_especificaciones\").select(\"*\").eq(\"producto_id\", productId).order(\"orden\", { ascending: true }).order(\"id\", { ascending: true }),\r\n    supabase.from(\"producto_variantes\").select(\"*\").eq(\"producto_id\", productId).order(\"id\", { ascending: true }),\r\n  ])\r\n\r\n  return {\r\n    specs: (specRes.data as any[]) || [],\r\n    variants: (varRes.data as any[]) || [],\r\n  }\r\n}\r\n\r\nexport async function uploadProductImages(args: { files: File[] }) {\r\n  const files = Array.isArray(args.files) ? args.files : []\r\n  const uploadedUrls: string[] = []\r\n\r\n  for (const file of files) {\r\n    const fileExt = file.name.split(\".\").pop() || \"jpg\"\r\n    const fileName = `${Date.now()}-${Math.random().toString(16).slice(2)}.${fileExt}`\r\n    const filePath = `imagenes/${fileName}`\r\n\r\n    const { error: uploadError } = await supabase.storage.from(\"productos\").upload(filePath, file)\r\n    if (uploadError) throw uploadError\r\n\r\n    const { data } = supabase.storage.from(\"productos\").getPublicUrl(filePath)\r\n    if (data?.publicUrl) uploadedUrls.push(data.publicUrl)\r\n  }\r\n\r\n  return uploadedUrls\r\n}\r\n\r\nexport async function uploadProductVideos(args: { files: File[] }) {\r\n  const files = Array.isArray(args.files) ? args.files : []\r\n  const uploadedUrls: string[] = []\r\n\r\n  for (const file of files) {\r\n    const fileExt = file.name.split(\".\").pop() || \"mp4\"\r\n    const fileName = `${Date.now()}-${Math.random().toString(16).slice(2)}.${fileExt}`\r\n    const filePath = `videos/${fileName}`\r\n\r\n    const { error: uploadError } = await supabase.storage\r\n      .from(\"productos\")\r\n      .upload(filePath, file, { upsert: false, contentType: file.type || \"video/mp4\" })\r\n\r\n    if (uploadError) throw uploadError\r\n\r\n    const { data } = supabase.storage.from(\"productos\").getPublicUrl(filePath)\r\n    if (data?.publicUrl) uploadedUrls.push(data.publicUrl)\r\n  }\r\n\r\n  return uploadedUrls\r\n}\r\n\r\nexport async function saveAdminProductoViaApi(args: { accessToken: string; method: \"POST\" | \"PUT\"; body: unknown }) {\r\n  const res = await fetch(\"/api/admin/productos\", {\r\n    method: args.method,\r\n    headers: {\r\n      \"Content-Type\": \"application/json\",\r\n      Authorization: `Bearer ${args.accessToken}`,\r\n    },\r\n    body: JSON.stringify(args.body),\r\n  })\r\n\r\n  let json: any = null\r\n  try {\r\n    json = await res.json()\r\n  } catch (err) {\r\n    json = null\r\n  }\r\n\r\n  if (!res.ok || !json?.ok) {\r\n    throw new Error(String(json?.error || \"No se pudo guardar el producto\"))\r\n  }\r\n\r\n  return json\r\n}\r\n\r\nexport async function deleteAdminProductoViaApi(args: { accessToken: string; id: number }) {\r\n  const res = await fetch(\"/api/admin/productos\", {\r\n    method: \"DELETE\",\r\n    headers: {\r\n      \"Content-Type\": \"application/json\",\r\n      Authorization: `Bearer ${args.accessToken}`,\r\n    },\r\n    body: JSON.stringify({ id: args.id }),\r\n  })\r\n\r\n  let json: any = null\r\n  try {\r\n    json = await res.json()\r\n  } catch (err) {\r\n    json = null\r\n  }\r\n\r\n  if (!res.ok || !json?.ok) {\r\n    throw new Error(String(json?.error || \"No se pudo eliminar\"))\r\n  }\r\n\r\n  return json\r\n}\r\n"],"names":[],"mappings":"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"}},
    {"offset": {"line": 534, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/Martin/Desktop/PROYECTOS/Tienda-Blama-2026/features/admin/services/usuarios.client.ts"],"sourcesContent":["import { supabase } from \"@/lib/supabaseClient\"\r\n\r\nimport type { ProfileRow } from \"@/features/admin/types\"\r\n\r\nexport async function fetchAdminProfiles() {\r\n  const { data, error } = await supabase.from(\"profiles\").select(\"id, email, nombre, role, created_at\").order(\"created_at\", { ascending: false })\r\n  if (error) throw error\r\n  return ((data as any[]) || []) as ProfileRow[]\r\n}\r\n\r\nexport async function createWorkerViaApi(args: { accessToken: string; email: string; nombre: string; password: string | null }) {\r\n  const res = await fetch(\"/api/admin/create-worker\", {\r\n    method: \"POST\",\r\n    headers: {\r\n      \"Content-Type\": \"application/json\",\r\n      Authorization: `Bearer ${args.accessToken}`,\r\n    },\r\n    body: JSON.stringify({\r\n      email: args.email,\r\n      nombre: args.nombre,\r\n      password: args.password,\r\n    }),\r\n  })\r\n\r\n  const json = await res.json()\r\n  if (!res.ok) {\r\n    throw new Error(String(json?.error || \"Error\"))\r\n  }\r\n\r\n  return json as any\r\n}\r\n"],"names":[],"mappings":";;;;;;AAAA;;AAIO,eAAe;IACpB,MAAM,EAAE,IAAI,EAAE,KAAK,EAAE,GAAG,MAAM,oIAAQ,CAAC,IAAI,CAAC,YAAY,MAAM,CAAC,uCAAuC,KAAK,CAAC,cAAc;QAAE,WAAW;IAAM;IAC7I,IAAI,OAAO,MAAM;IACjB,OAAQ,AAAC,QAAkB,EAAE;AAC/B;AAEO,eAAe,mBAAmB,IAAqF;IAC5H,MAAM,MAAM,MAAM,MAAM,4BAA4B;QAClD,QAAQ;QACR,SAAS;YACP,gBAAgB;YAChB,eAAe,CAAC,OAAO,EAAE,KAAK,WAAW,EAAE;QAC7C;QACA,MAAM,KAAK,SAAS,CAAC;YACnB,OAAO,KAAK,KAAK;YACjB,QAAQ,KAAK,MAAM;YACnB,UAAU,KAAK,QAAQ;QACzB;IACF;IAEA,MAAM,OAAO,MAAM,IAAI,IAAI;IAC3B,IAAI,CAAC,IAAI,EAAE,EAAE;QACX,MAAM,IAAI,MAAM,OAAO,MAAM,SAAS;IACxC;IAEA,OAAO;AACT"}},
    {"offset": {"line": 575, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/Martin/Desktop/PROYECTOS/Tienda-Blama-2026/features/admin/services/cupones.client.ts"],"sourcesContent":["import { supabase } from \"@/lib/supabaseClient\"\r\n\r\nexport async function fetchAdminCupones() {\r\n  const { data, error } = await supabase.from(\"cupones\").select(\"*\").order(\"created_at\", { ascending: false })\r\n  if (error) throw error\r\n  return (data as any[]) || []\r\n}\r\n\r\nexport async function createAdminCupon(payload: any) {\r\n  const { error } = await supabase.from(\"cupones\").insert(payload)\r\n  if (error) throw error\r\n}\r\n\r\nexport async function updateAdminCupon(id: number, payload: any) {\r\n  const { error } = await supabase.from(\"cupones\").update(payload).eq(\"id\", id)\r\n  if (error) throw error\r\n}\r\n\r\nexport async function deleteAdminCupon(id: number) {\r\n  const { error } = await supabase.from(\"cupones\").delete().eq(\"id\", id)\r\n  if (error) throw error\r\n}\r\n"],"names":[],"mappings":";;;;;;;;;;AAAA;;AAEO,eAAe;IACpB,MAAM,EAAE,IAAI,EAAE,KAAK,EAAE,GAAG,MAAM,oIAAQ,CAAC,IAAI,CAAC,WAAW,MAAM,CAAC,KAAK,KAAK,CAAC,cAAc;QAAE,WAAW;IAAM;IAC1G,IAAI,OAAO,MAAM;IACjB,OAAO,AAAC,QAAkB,EAAE;AAC9B;AAEO,eAAe,iBAAiB,OAAY;IACjD,MAAM,EAAE,KAAK,EAAE,GAAG,MAAM,oIAAQ,CAAC,IAAI,CAAC,WAAW,MAAM,CAAC;IACxD,IAAI,OAAO,MAAM;AACnB;AAEO,eAAe,iBAAiB,EAAU,EAAE,OAAY;IAC7D,MAAM,EAAE,KAAK,EAAE,GAAG,MAAM,oIAAQ,CAAC,IAAI,CAAC,WAAW,MAAM,CAAC,SAAS,EAAE,CAAC,MAAM;IAC1E,IAAI,OAAO,MAAM;AACnB;AAEO,eAAe,iBAAiB,EAAU;IAC/C,MAAM,EAAE,KAAK,EAAE,GAAG,MAAM,oIAAQ,CAAC,IAAI,CAAC,WAAW,MAAM,GAAG,EAAE,CAAC,MAAM;IACnE,IAAI,OAAO,MAAM;AACnB"}},
    {"offset": {"line": 613, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/Martin/Desktop/PROYECTOS/Tienda-Blama-2026/features/admin/services/banners.client.ts"],"sourcesContent":["import { supabase } from \"@/lib/supabaseClient\"\r\n\r\nexport async function fetchHomeBanners() {\r\n  const { data, error } = await supabase.from(\"home_banners\").select(\"*\").order(\"orden\", { ascending: true }).order(\"id\", { ascending: true })\r\n  if (error) throw error\r\n  return (data as any[]) || []\r\n}\r\n\r\nexport async function saveHomeBanner(args: { id?: number | null; payload: any }) {\r\n  if (args.id != null) {\r\n    const { error } = await supabase.from(\"home_banners\").update(args.payload).eq(\"id\", args.id)\r\n    if (error) throw error\r\n    return\r\n  }\r\n\r\n  const { error } = await supabase.from(\"home_banners\").insert(args.payload)\r\n  if (error) throw error\r\n}\r\n\r\nexport async function deleteHomeBanner(id: number) {\r\n  const { error } = await supabase.from(\"home_banners\").delete().eq(\"id\", id)\r\n  if (error) throw error\r\n}\r\n"],"names":[],"mappings":";;;;;;;;AAAA;;AAEO,eAAe;IACpB,MAAM,EAAE,IAAI,EAAE,KAAK,EAAE,GAAG,MAAM,oIAAQ,CAAC,IAAI,CAAC,gBAAgB,MAAM,CAAC,KAAK,KAAK,CAAC,SAAS;QAAE,WAAW;IAAK,GAAG,KAAK,CAAC,MAAM;QAAE,WAAW;IAAK;IAC1I,IAAI,OAAO,MAAM;IACjB,OAAO,AAAC,QAAkB,EAAE;AAC9B;AAEO,eAAe,eAAe,IAA0C;IAC7E,IAAI,KAAK,EAAE,IAAI,MAAM;QACnB,MAAM,EAAE,KAAK,EAAE,GAAG,MAAM,oIAAQ,CAAC,IAAI,CAAC,gBAAgB,MAAM,CAAC,KAAK,OAAO,EAAE,EAAE,CAAC,MAAM,KAAK,EAAE;QAC3F,IAAI,OAAO,MAAM;QACjB;IACF;IAEA,MAAM,EAAE,KAAK,EAAE,GAAG,MAAM,oIAAQ,CAAC,IAAI,CAAC,gBAAgB,MAAM,CAAC,KAAK,OAAO;IACzE,IAAI,OAAO,MAAM;AACnB;AAEO,eAAe,iBAAiB,EAAU;IAC/C,MAAM,EAAE,KAAK,EAAE,GAAG,MAAM,oIAAQ,CAAC,IAAI,CAAC,gBAAgB,MAAM,GAAG,EAAE,CAAC,MAAM;IACxE,IAAI,OAAO,MAAM;AACnB"}},
    {"offset": {"line": 652, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/Martin/Desktop/PROYECTOS/Tienda-Blama-2026/features/admin/services/announcement-bar.client.ts"],"sourcesContent":["import { supabase } from \"@/lib/supabaseClient\"\r\n\r\nexport type AnnouncementBarConfig = {\r\n  enabled: boolean\r\n  interval_ms: number\r\n  messages: string[]\r\n}\r\n\r\nasync function getAccessToken() {\r\n  const res = await supabase.auth.getSession()\r\n  const token = res?.data?.session?.access_token || \"\"\r\n  return token\r\n}\r\n\r\nexport async function fetchAnnouncementBarConfigViaApi() {\r\n  const token = await getAccessToken()\r\n  if (!token) throw new Error(\"No autorizado\")\r\n\r\n  const res = await fetch(\"/api/admin/announcement-bar\", {\r\n    method: \"GET\",\r\n    headers: {\r\n      Authorization: `Bearer ${token}`,\r\n    },\r\n  })\r\n\r\n  let json: any = null\r\n  try {\r\n    json = await res.json()\r\n  } catch (e) {\r\n    json = null\r\n  }\r\n\r\n  if (!res.ok || !json?.ok) {\r\n    throw new Error(String(json?.error || \"No se pudo obtener la configuraciÃ³n\"))\r\n  }\r\n\r\n  const data = (json?.data || {}) as any\r\n  return {\r\n    enabled: Boolean(data.enabled),\r\n    interval_ms: Number(data.interval_ms) || 3500,\r\n    messages: Array.isArray(data.messages) ? (data.messages as string[]) : [],\r\n  } as AnnouncementBarConfig\r\n}\r\n\r\nexport async function saveAnnouncementBarConfigViaApi(config: AnnouncementBarConfig) {\r\n  const token = await getAccessToken()\r\n  if (!token) throw new Error(\"No autorizado\")\r\n\r\n  const res = await fetch(\"/api/admin/announcement-bar\", {\r\n    method: \"PUT\",\r\n    headers: {\r\n      \"Content-Type\": \"application/json\",\r\n      Authorization: `Bearer ${token}`,\r\n    },\r\n    body: JSON.stringify(config),\r\n  })\r\n\r\n  let json: any = null\r\n  try {\r\n    json = await res.json()\r\n  } catch (e) {\r\n    json = null\r\n  }\r\n\r\n  if (!res.ok || !json?.ok) {\r\n    throw new Error(String(json?.error || \"No se pudo guardar\"))\r\n  }\r\n\r\n  return json\r\n}\r\n"],"names":[],"mappings":";;;;;;AAAA;;AAQA,eAAe;IACb,MAAM,MAAM,MAAM,oIAAQ,CAAC,IAAI,CAAC,UAAU;IAC1C,MAAM,QAAQ,KAAK,MAAM,SAAS,gBAAgB;IAClD,OAAO;AACT;AAEO,eAAe;IACpB,MAAM,QAAQ,MAAM;IACpB,IAAI,CAAC,OAAO,MAAM,IAAI,MAAM;IAE5B,MAAM,MAAM,MAAM,MAAM,+BAA+B;QACrD,QAAQ;QACR,SAAS;YACP,eAAe,CAAC,OAAO,EAAE,OAAO;QAClC;IACF;IAEA,IAAI,OAAY;IAChB,IAAI;QACF,OAAO,MAAM,IAAI,IAAI;IACvB,EAAE,OAAO,GAAG;QACV,OAAO;IACT;IAEA,IAAI,CAAC,IAAI,EAAE,IAAI,CAAC,MAAM,IAAI;QACxB,MAAM,IAAI,MAAM,OAAO,MAAM,SAAS;IACxC;IAEA,MAAM,OAAQ,MAAM,QAAQ,CAAC;IAC7B,OAAO;QACL,SAAS,QAAQ,KAAK,OAAO;QAC7B,aAAa,OAAO,KAAK,WAAW,KAAK;QACzC,UAAU,MAAM,OAAO,CAAC,KAAK,QAAQ,IAAK,KAAK,QAAQ,GAAgB,EAAE;IAC3E;AACF;AAEO,eAAe,gCAAgC,MAA6B;IACjF,MAAM,QAAQ,MAAM;IACpB,IAAI,CAAC,OAAO,MAAM,IAAI,MAAM;IAE5B,MAAM,MAAM,MAAM,MAAM,+BAA+B;QACrD,QAAQ;QACR,SAAS;YACP,gBAAgB;YAChB,eAAe,CAAC,OAAO,EAAE,OAAO;QAClC;QACA,MAAM,KAAK,SAAS,CAAC;IACvB;IAEA,IAAI,OAAY;IAChB,IAAI;QACF,OAAO,MAAM,IAAI,IAAI;IACvB,EAAE,OAAO,GAAG;QACV,OAAO;IACT;IAEA,IAAI,CAAC,IAAI,EAAE,IAAI,CAAC,MAAM,IAAI;QACxB,MAAM,IAAI,MAAM,OAAO,MAAM,SAAS;IACxC;IAEA,OAAO;AACT"}},
    {"offset": {"line": 719, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/Martin/Desktop/PROYECTOS/Tienda-Blama-2026/features/admin/services/incidencias.client.ts"],"sourcesContent":["import { supabase } from \"@/lib/supabaseClient\"\r\n\r\nexport async function fetchPedidosForIncidencias() {\r\n  const { data, error } = await supabase\r\n    .from(\"pedidos\")\r\n    .select(\"id, status, created_at, clientes (nombre, telefono)\")\r\n    .order(\"created_at\", { ascending: false })\r\n    .limit(200)\r\n\r\n  if (error) throw error\r\n  return (data as any[]) || []\r\n}\r\n\r\nexport async function fetchIncidencias() {\r\n  const { data, error } = await supabase\r\n    .from(\"incidencias\")\r\n    .select(\"*, pedidos (id, status, created_at, clientes (nombre, telefono))\")\r\n    .order(\"created_at\", { ascending: false })\r\n\r\n  if (error) throw error\r\n  return (data as any[]) || []\r\n}\r\n\r\nexport async function uploadIncidenciaImages(args: { pedidoId: string; files: File[] }) {\r\n  const pedidoId = String(args.pedidoId || \"\").trim()\r\n  const files = Array.isArray(args.files) ? args.files : []\r\n\r\n  const uploadedUrls: string[] = []\r\n\r\n  for (const file of files) {\r\n    const fileExt = file.name.split(\".\").pop() || \"jpg\"\r\n    const fileName = `${Date.now()}-${Math.random().toString(16).slice(2)}.${fileExt}`\r\n    const folder = pedidoId ? `incidencias/${pedidoId}` : \"incidencias\"\r\n    const filePath = `${folder}/${fileName}`\r\n\r\n    const { error: uploadError } = await supabase.storage.from(\"productos\").upload(filePath, file)\r\n    if (uploadError) throw uploadError\r\n\r\n    const { data } = supabase.storage.from(\"productos\").getPublicUrl(filePath)\r\n    if (data?.publicUrl) uploadedUrls.push(data.publicUrl)\r\n  }\r\n\r\n  return uploadedUrls\r\n}\r\n\r\nexport async function createIncidencia(payload: any) {\r\n  async function save(withFotos: boolean) {\r\n    const p: any = { ...payload }\r\n    if (!withFotos) delete p.fotos\r\n    return supabase.from(\"incidencias\").insert(p)\r\n  }\r\n\r\n  const first = await save(true)\r\n  let error = first.error\r\n  if (error && typeof (error as any).message === \"string\" && (error as any).message.toLowerCase().includes(\"fotos\")) {\r\n    const second = await save(false)\r\n    error = second.error\r\n  }\r\n\r\n  if (error) throw new Error((error as any).message)\r\n}\r\n\r\nexport async function deleteIncidencia(id: number) {\r\n  const { error } = await supabase.from(\"incidencias\").delete().eq(\"id\", id)\r\n  if (error) throw error\r\n}\r\n"],"names":[],"mappings":";;;;;;;;;;;;AAAA;;AAEO,eAAe;IACpB,MAAM,EAAE,IAAI,EAAE,KAAK,EAAE,GAAG,MAAM,oIAAQ,CACnC,IAAI,CAAC,WACL,MAAM,CAAC,uDACP,KAAK,CAAC,cAAc;QAAE,WAAW;IAAM,GACvC,KAAK,CAAC;IAET,IAAI,OAAO,MAAM;IACjB,OAAO,AAAC,QAAkB,EAAE;AAC9B;AAEO,eAAe;IACpB,MAAM,EAAE,IAAI,EAAE,KAAK,EAAE,GAAG,MAAM,oIAAQ,CACnC,IAAI,CAAC,eACL,MAAM,CAAC,oEACP,KAAK,CAAC,cAAc;QAAE,WAAW;IAAM;IAE1C,IAAI,OAAO,MAAM;IACjB,OAAO,AAAC,QAAkB,EAAE;AAC9B;AAEO,eAAe,uBAAuB,IAAyC;IACpF,MAAM,WAAW,OAAO,KAAK,QAAQ,IAAI,IAAI,IAAI;IACjD,MAAM,QAAQ,MAAM,OAAO,CAAC,KAAK,KAAK,IAAI,KAAK,KAAK,GAAG,EAAE;IAEzD,MAAM,eAAyB,EAAE;IAEjC,KAAK,MAAM,QAAQ,MAAO;QACxB,MAAM,UAAU,KAAK,IAAI,CAAC,KAAK,CAAC,KAAK,GAAG,MAAM;QAC9C,MAAM,WAAW,GAAG,KAAK,GAAG,GAAG,CAAC,EAAE,KAAK,MAAM,GAAG,QAAQ,CAAC,IAAI,KAAK,CAAC,GAAG,CAAC,EAAE,SAAS;QAClF,MAAM,SAAS,WAAW,CAAC,YAAY,EAAE,UAAU,GAAG;QACtD,MAAM,WAAW,GAAG,OAAO,CAAC,EAAE,UAAU;QAExC,MAAM,EAAE,OAAO,WAAW,EAAE,GAAG,MAAM,oIAAQ,CAAC,OAAO,CAAC,IAAI,CAAC,aAAa,MAAM,CAAC,UAAU;QACzF,IAAI,aAAa,MAAM;QAEvB,MAAM,EAAE,IAAI,EAAE,GAAG,oIAAQ,CAAC,OAAO,CAAC,IAAI,CAAC,aAAa,YAAY,CAAC;QACjE,IAAI,MAAM,WAAW,aAAa,IAAI,CAAC,KAAK,SAAS;IACvD;IAEA,OAAO;AACT;AAEO,eAAe,iBAAiB,OAAY;IACjD,eAAe,KAAK,SAAkB;QACpC,MAAM,IAAS;YAAE,GAAG,OAAO;QAAC;QAC5B,IAAI,CAAC,WAAW,OAAO,EAAE,KAAK;QAC9B,OAAO,oIAAQ,CAAC,IAAI,CAAC,eAAe,MAAM,CAAC;IAC7C;IAEA,MAAM,QAAQ,MAAM,KAAK;IACzB,IAAI,QAAQ,MAAM,KAAK;IACvB,IAAI,SAAS,OAAO,AAAC,MAAc,OAAO,KAAK,YAAY,AAAC,MAAc,OAAO,CAAC,WAAW,GAAG,QAAQ,CAAC,UAAU;QACjH,MAAM,SAAS,MAAM,KAAK;QAC1B,QAAQ,OAAO,KAAK;IACtB;IAEA,IAAI,OAAO,MAAM,IAAI,MAAM,AAAC,MAAc,OAAO;AACnD;AAEO,eAAe,iBAAiB,EAAU;IAC/C,MAAM,EAAE,KAAK,EAAE,GAAG,MAAM,oIAAQ,CAAC,IAAI,CAAC,eAAe,MAAM,GAAG,EAAE,CAAC,MAAM;IACvE,IAAI,OAAO,MAAM;AACnB"}},
    {"offset": {"line": 790, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/Martin/Desktop/PROYECTOS/Tienda-Blama-2026/features/admin/services/preguntas.client.ts"],"sourcesContent":["import { supabase } from \"@/lib/supabaseClient\"\r\n\r\nexport async function fetchAdminQuestions() {\r\n  const { data, error } = await supabase\r\n    .from(\"product_questions\")\r\n    .select(\r\n      \"id, product_id, question, asker_name, asker_phone, published, created_at, productos(nombre), product_answers(id, answer, answered_by, created_at, published)\"\r\n    )\r\n    .order(\"created_at\", { ascending: false })\r\n    .limit(200)\r\n\r\n  if (error) throw error\r\n  return (data as any[]) || []\r\n}\r\n\r\nexport async function setQuestionPublished(args: { id: number; published: boolean }) {\r\n  const { error } = await supabase.from(\"product_questions\").update({ published: args.published }).eq(\"id\", args.id)\r\n  if (error) throw error\r\n}\r\n\r\nexport async function saveQuestionAnswer(args: { questionId: number; answer: string }) {\r\n  const answer = String(args.answer || \"\").trim()\r\n\r\n  const { data: sessionRes } = await supabase.auth.getSession()\r\n  const userId = (sessionRes as any)?.session?.user?.id || null\r\n\r\n  let answeredBy: string | null = null\r\n  if (userId) {\r\n    const { data: profile } = await supabase.from(\"profiles\").select(\"email, nombre\").eq(\"id\", userId).maybeSingle()\r\n    answeredBy = String((profile as any)?.nombre || (profile as any)?.email || \"Admin\")\r\n  }\r\n\r\n  const { data: current } = await supabase\r\n    .from(\"product_questions\")\r\n    .select(\"id, product_answers(id)\")\r\n    .eq(\"id\", args.questionId)\r\n    .maybeSingle()\r\n\r\n  const existingId =\r\n    current && Array.isArray((current as any).product_answers) && (current as any).product_answers.length > 0\r\n      ? Number((current as any).product_answers[0]?.id)\r\n      : null\r\n\r\n  if (existingId) {\r\n    const { error } = await supabase\r\n      .from(\"product_answers\")\r\n      .update({ answer, answered_by: answeredBy, published: true })\r\n      .eq(\"id\", existingId)\r\n    if (error) throw error\r\n  } else {\r\n    const { error } = await supabase\r\n      .from(\"product_answers\")\r\n      .insert({ question_id: args.questionId, answer, answered_by: answeredBy, published: true })\r\n    if (error) throw error\r\n  }\r\n\r\n  const { error: pubErr } = await supabase.from(\"product_questions\").update({ published: true }).eq(\"id\", args.questionId)\r\n  if (pubErr) throw pubErr\r\n}\r\n"],"names":[],"mappings":";;;;;;;;AAAA;;AAEO,eAAe;IACpB,MAAM,EAAE,IAAI,EAAE,KAAK,EAAE,GAAG,MAAM,oIAAQ,CACnC,IAAI,CAAC,qBACL,MAAM,CACL,gKAED,KAAK,CAAC,cAAc;QAAE,WAAW;IAAM,GACvC,KAAK,CAAC;IAET,IAAI,OAAO,MAAM;IACjB,OAAO,AAAC,QAAkB,EAAE;AAC9B;AAEO,eAAe,qBAAqB,IAAwC;IACjF,MAAM,EAAE,KAAK,EAAE,GAAG,MAAM,oIAAQ,CAAC,IAAI,CAAC,qBAAqB,MAAM,CAAC;QAAE,WAAW,KAAK,SAAS;IAAC,GAAG,EAAE,CAAC,MAAM,KAAK,EAAE;IACjH,IAAI,OAAO,MAAM;AACnB;AAEO,eAAe,mBAAmB,IAA4C;IACnF,MAAM,SAAS,OAAO,KAAK,MAAM,IAAI,IAAI,IAAI;IAE7C,MAAM,EAAE,MAAM,UAAU,EAAE,GAAG,MAAM,oIAAQ,CAAC,IAAI,CAAC,UAAU;IAC3D,MAAM,SAAS,AAAC,YAAoB,SAAS,MAAM,MAAM;IAEzD,IAAI,aAA4B;IAChC,IAAI,QAAQ;QACV,MAAM,EAAE,MAAM,OAAO,EAAE,GAAG,MAAM,oIAAQ,CAAC,IAAI,CAAC,YAAY,MAAM,CAAC,iBAAiB,EAAE,CAAC,MAAM,QAAQ,WAAW;QAC9G,aAAa,OAAO,AAAC,SAAiB,UAAW,SAAiB,SAAS;IAC7E;IAEA,MAAM,EAAE,MAAM,OAAO,EAAE,GAAG,MAAM,oIAAQ,CACrC,IAAI,CAAC,qBACL,MAAM,CAAC,2BACP,EAAE,CAAC,MAAM,KAAK,UAAU,EACxB,WAAW;IAEd,MAAM,aACJ,WAAW,MAAM,OAAO,CAAC,AAAC,QAAgB,eAAe,KAAK,AAAC,QAAgB,eAAe,CAAC,MAAM,GAAG,IACpG,OAAO,AAAC,QAAgB,eAAe,CAAC,EAAE,EAAE,MAC5C;IAEN,IAAI,YAAY;QACd,MAAM,EAAE,KAAK,EAAE,GAAG,MAAM,oIAAQ,CAC7B,IAAI,CAAC,mBACL,MAAM,CAAC;YAAE;YAAQ,aAAa;YAAY,WAAW;QAAK,GAC1D,EAAE,CAAC,MAAM;QACZ,IAAI,OAAO,MAAM;IACnB,OAAO;QACL,MAAM,EAAE,KAAK,EAAE,GAAG,MAAM,oIAAQ,CAC7B,IAAI,CAAC,mBACL,MAAM,CAAC;YAAE,aAAa,KAAK,UAAU;YAAE;YAAQ,aAAa;YAAY,WAAW;QAAK;QAC3F,IAAI,OAAO,MAAM;IACnB;IAEA,MAAM,EAAE,OAAO,MAAM,EAAE,GAAG,MAAM,oIAAQ,CAAC,IAAI,CAAC,qBAAqB,MAAM,CAAC;QAAE,WAAW;IAAK,GAAG,EAAE,CAAC,MAAM,KAAK,UAAU;IACvH,IAAI,QAAQ,MAAM;AACpB"}},
    {"offset": {"line": 852, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/Martin/Desktop/PROYECTOS/Tienda-Blama-2026/features/admin/services/resenas.client.ts"],"sourcesContent":["import { supabase } from \"@/lib/supabaseClient\"\r\n\r\nexport async function fetchAdminReviews() {\r\n  const { data, error } = await supabase\r\n    .from(\"product_reviews\")\r\n    .select(\"id, product_id, rating, title, body, customer_name, customer_city, verified, approved, created_at, productos(nombre)\")\r\n    .order(\"created_at\", { ascending: false })\r\n    .limit(200)\r\n\r\n  if (error) throw error\r\n  return (data as any[]) || []\r\n}\r\n\r\nexport async function setReviewApproved(args: { id: number; approved: boolean }) {\r\n  const { error } = await supabase.from(\"product_reviews\").update({ approved: args.approved }).eq(\"id\", args.id)\r\n  if (error) throw error\r\n}\r\n\r\nexport async function deleteReview(id: number) {\r\n  const { error } = await supabase.from(\"product_reviews\").delete().eq(\"id\", id)\r\n  if (error) throw error\r\n}\r\n"],"names":[],"mappings":";;;;;;;;AAAA;;AAEO,eAAe;IACpB,MAAM,EAAE,IAAI,EAAE,KAAK,EAAE,GAAG,MAAM,oIAAQ,CACnC,IAAI,CAAC,mBACL,MAAM,CAAC,wHACP,KAAK,CAAC,cAAc;QAAE,WAAW;IAAM,GACvC,KAAK,CAAC;IAET,IAAI,OAAO,MAAM;IACjB,OAAO,AAAC,QAAkB,EAAE;AAC9B;AAEO,eAAe,kBAAkB,IAAuC;IAC7E,MAAM,EAAE,KAAK,EAAE,GAAG,MAAM,oIAAQ,CAAC,IAAI,CAAC,mBAAmB,MAAM,CAAC;QAAE,UAAU,KAAK,QAAQ;IAAC,GAAG,EAAE,CAAC,MAAM,KAAK,EAAE;IAC7G,IAAI,OAAO,MAAM;AACnB;AAEO,eAAe,aAAa,EAAU;IAC3C,MAAM,EAAE,KAAK,EAAE,GAAG,MAAM,oIAAQ,CAAC,IAAI,CAAC,mBAAmB,MAAM,GAAG,EAAE,CAAC,MAAM;IAC3E,IAAI,OAAO,MAAM;AACnB"}},
    {"offset": {"line": 886, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/Martin/Desktop/PROYECTOS/Tienda-Blama-2026/features/admin/services/clientes.client.ts"],"sourcesContent":["import { supabase } from \"@/lib/supabaseClient\"\r\n\r\nexport async function fetchAdminClientes() {\r\n  const { data, error } = await supabase.from(\"clientes\").select(\"*\").order(\"id\", { ascending: false })\r\n  if (error) throw error\r\n  return (data as any[]) || []\r\n}\r\n"],"names":[],"mappings":";;;;AAAA;;AAEO,eAAe;IACpB,MAAM,EAAE,IAAI,EAAE,KAAK,EAAE,GAAG,MAAM,oIAAQ,CAAC,IAAI,CAAC,YAAY,MAAM,CAAC,KAAK,KAAK,CAAC,MAAM;QAAE,WAAW;IAAM;IACnG,IAAI,OAAO,MAAM;IACjB,OAAO,AAAC,QAAkB,EAAE;AAC9B"}},
    {"offset": {"line": 906, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/Martin/Desktop/PROYECTOS/Tienda-Blama-2026/features/admin/index.ts"],"sourcesContent":["export * from \"@/features/admin/types\"\r\nexport * from \"@/features/admin/services/dashboard.client\"\r\nexport * from \"@/features/admin/services/pedidos.client\"\r\nexport * from \"@/features/admin/services/productos.client\"\r\nexport * from \"@/features/admin/services/usuarios.client\"\r\nexport * from \"@/features/admin/services/cupones.client\"\r\nexport * from \"@/features/admin/services/banners.client\"\r\nexport * from \"@/features/admin/services/announcement-bar.client\"\r\nexport * from \"@/features/admin/services/incidencias.client\"\r\nexport * from \"@/features/admin/services/preguntas.client\"\r\nexport * from \"@/features/admin/services/resenas.client\"\r\nexport * from \"@/features/admin/services/clientes.client\"\r\n"],"names":[],"mappings":";AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA"}},
    {"offset": {"line": 938, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/Martin/Desktop/PROYECTOS/Tienda-Blama-2026/components/ui/textarea.tsx"],"sourcesContent":["import * as React from \"react\"\r\n\r\nimport { cn } from \"@/lib/utils\"\r\n\r\nfunction Textarea({ className, ...props }: React.ComponentProps<\"textarea\">) {\r\n  return (\r\n    <textarea\r\n      data-slot=\"textarea\"\r\n      className={cn(\r\n        \"border-input placeholder:text-muted-foreground focus-visible:border-ring focus-visible:ring-ring/50 aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive dark:bg-input/30 flex field-sizing-content min-h-16 w-full rounded-md border bg-transparent px-3 py-2 text-base shadow-xs transition-[color,box-shadow] outline-none focus-visible:ring-[3px] disabled:cursor-not-allowed disabled:opacity-50 md:text-sm\",\r\n        className\r\n      )}\r\n      {...props}\r\n    />\r\n  )\r\n}\r\n\r\nexport { Textarea }\r\n"],"names":[],"mappings":";;;;;AAEA;;;AAEA,SAAS,SAAS,EAAE,SAAS,EAAE,GAAG,OAAyC;IACzE,qBACE,6LAAC;QACC,aAAU;QACV,WAAW,IAAA,qHAAE,EACX,ucACA;QAED,GAAG,KAAK;;;;;;AAGf;KAXS"}},
    {"offset": {"line": 968, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/Martin/Desktop/PROYECTOS/Tienda-Blama-2026/components/ui/select.tsx"],"sourcesContent":["\"use client\"\r\n\r\nimport * as React from \"react\"\r\nimport * as SelectPrimitive from \"@radix-ui/react-select\"\r\nimport { CheckIcon, ChevronDownIcon, ChevronUpIcon } from \"lucide-react\"\r\n\r\nimport { cn } from \"@/lib/utils\"\r\n\r\nfunction Select({\r\n  ...props\r\n}: React.ComponentProps<typeof SelectPrimitive.Root>) {\r\n  return <SelectPrimitive.Root data-slot=\"select\" {...props} />\r\n}\r\n\r\nfunction SelectGroup({\r\n  ...props\r\n}: React.ComponentProps<typeof SelectPrimitive.Group>) {\r\n  return <SelectPrimitive.Group data-slot=\"select-group\" {...props} />\r\n}\r\n\r\nfunction SelectValue({\r\n  ...props\r\n}: React.ComponentProps<typeof SelectPrimitive.Value>) {\r\n  return <SelectPrimitive.Value data-slot=\"select-value\" {...props} />\r\n}\r\n\r\nfunction SelectTrigger({\r\n  className,\r\n  size = \"default\",\r\n  children,\r\n  ...props\r\n}: React.ComponentProps<typeof SelectPrimitive.Trigger> & {\r\n  size?: \"sm\" | \"default\"\r\n}) {\r\n  return (\r\n    <SelectPrimitive.Trigger\r\n      data-slot=\"select-trigger\"\r\n      data-size={size}\r\n      className={cn(\r\n        \"border-input data-[placeholder]:text-muted-foreground [&_svg:not([class*='text-'])]:text-muted-foreground focus-visible:border-ring focus-visible:ring-ring/50 aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive dark:bg-input/30 dark:hover:bg-input/50 flex w-fit items-center justify-between gap-2 rounded-md border bg-transparent px-3 py-2 text-sm whitespace-nowrap shadow-xs transition-[color,box-shadow] outline-none focus-visible:ring-[3px] disabled:cursor-not-allowed disabled:opacity-50 data-[size=default]:h-9 data-[size=sm]:h-8 *:data-[slot=select-value]:line-clamp-1 *:data-[slot=select-value]:flex *:data-[slot=select-value]:items-center *:data-[slot=select-value]:gap-2 [&_svg]:pointer-events-none [&_svg]:shrink-0 [&_svg:not([class*='size-'])]:size-4\",\r\n        className\r\n      )}\r\n      {...props}\r\n    >\r\n      {children}\r\n      <SelectPrimitive.Icon asChild>\r\n        <ChevronDownIcon className=\"size-4 opacity-50\" />\r\n      </SelectPrimitive.Icon>\r\n    </SelectPrimitive.Trigger>\r\n  )\r\n}\r\n\r\nfunction SelectContent({\r\n  className,\r\n  children,\r\n  position = \"item-aligned\",\r\n  align = \"center\",\r\n  ...props\r\n}: React.ComponentProps<typeof SelectPrimitive.Content>) {\r\n  return (\r\n    <SelectPrimitive.Portal>\r\n      <SelectPrimitive.Content\r\n        data-slot=\"select-content\"\r\n        className={cn(\r\n          \"bg-popover text-popover-foreground data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2 relative z-50 max-h-(--radix-select-content-available-height) min-w-[8rem] origin-(--radix-select-content-transform-origin) overflow-x-hidden overflow-y-auto rounded-md border shadow-md\",\r\n          position === \"popper\" &&\r\n            \"data-[side=bottom]:translate-y-1 data-[side=left]:-translate-x-1 data-[side=right]:translate-x-1 data-[side=top]:-translate-y-1\",\r\n          className\r\n        )}\r\n        position={position}\r\n        align={align}\r\n        {...props}\r\n      >\r\n        <SelectScrollUpButton />\r\n        <SelectPrimitive.Viewport\r\n          className={cn(\r\n            \"p-1\",\r\n            position === \"popper\" &&\r\n              \"h-[var(--radix-select-trigger-height)] w-full min-w-[var(--radix-select-trigger-width)] scroll-my-1\"\r\n          )}\r\n        >\r\n          {children}\r\n        </SelectPrimitive.Viewport>\r\n        <SelectScrollDownButton />\r\n      </SelectPrimitive.Content>\r\n    </SelectPrimitive.Portal>\r\n  )\r\n}\r\n\r\nfunction SelectLabel({\r\n  className,\r\n  ...props\r\n}: React.ComponentProps<typeof SelectPrimitive.Label>) {\r\n  return (\r\n    <SelectPrimitive.Label\r\n      data-slot=\"select-label\"\r\n      className={cn(\"text-muted-foreground px-2 py-1.5 text-xs\", className)}\r\n      {...props}\r\n    />\r\n  )\r\n}\r\n\r\nfunction SelectItem({\r\n  className,\r\n  children,\r\n  ...props\r\n}: React.ComponentProps<typeof SelectPrimitive.Item>) {\r\n  return (\r\n    <SelectPrimitive.Item\r\n      data-slot=\"select-item\"\r\n      className={cn(\r\n        \"focus:bg-accent focus:text-accent-foreground [&_svg:not([class*='text-'])]:text-muted-foreground relative flex w-full cursor-default items-center gap-2 rounded-sm py-1.5 pr-8 pl-2 text-sm outline-hidden select-none data-[disabled]:pointer-events-none data-[disabled]:opacity-50 [&_svg]:pointer-events-none [&_svg]:shrink-0 [&_svg:not([class*='size-'])]:size-4 *:[span]:last:flex *:[span]:last:items-center *:[span]:last:gap-2\",\r\n        className\r\n      )}\r\n      {...props}\r\n    >\r\n      <span\r\n        data-slot=\"select-item-indicator\"\r\n        className=\"absolute right-2 flex size-3.5 items-center justify-center\"\r\n      >\r\n        <SelectPrimitive.ItemIndicator>\r\n          <CheckIcon className=\"size-4\" />\r\n        </SelectPrimitive.ItemIndicator>\r\n      </span>\r\n      <SelectPrimitive.ItemText>{children}</SelectPrimitive.ItemText>\r\n    </SelectPrimitive.Item>\r\n  )\r\n}\r\n\r\nfunction SelectSeparator({\r\n  className,\r\n  ...props\r\n}: React.ComponentProps<typeof SelectPrimitive.Separator>) {\r\n  return (\r\n    <SelectPrimitive.Separator\r\n      data-slot=\"select-separator\"\r\n      className={cn(\"bg-border pointer-events-none -mx-1 my-1 h-px\", className)}\r\n      {...props}\r\n    />\r\n  )\r\n}\r\n\r\nfunction SelectScrollUpButton({\r\n  className,\r\n  ...props\r\n}: React.ComponentProps<typeof SelectPrimitive.ScrollUpButton>) {\r\n  return (\r\n    <SelectPrimitive.ScrollUpButton\r\n      data-slot=\"select-scroll-up-button\"\r\n      className={cn(\r\n        \"flex cursor-default items-center justify-center py-1\",\r\n        className\r\n      )}\r\n      {...props}\r\n    >\r\n      <ChevronUpIcon className=\"size-4\" />\r\n    </SelectPrimitive.ScrollUpButton>\r\n  )\r\n}\r\n\r\nfunction SelectScrollDownButton({\r\n  className,\r\n  ...props\r\n}: React.ComponentProps<typeof SelectPrimitive.ScrollDownButton>) {\r\n  return (\r\n    <SelectPrimitive.ScrollDownButton\r\n      data-slot=\"select-scroll-down-button\"\r\n      className={cn(\r\n        \"flex cursor-default items-center justify-center py-1\",\r\n        className\r\n      )}\r\n      {...props}\r\n    >\r\n      <ChevronDownIcon className=\"size-4\" />\r\n    </SelectPrimitive.ScrollDownButton>\r\n  )\r\n}\r\n\r\nexport {\r\n  Select,\r\n  SelectContent,\r\n  SelectGroup,\r\n  SelectItem,\r\n  SelectLabel,\r\n  SelectScrollDownButton,\r\n  SelectScrollUpButton,\r\n  SelectSeparator,\r\n  SelectTrigger,\r\n  SelectValue,\r\n}\r\n"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;AAGA;AACA;AAAA;AAAA;AAEA;AANA;;;;;AAQA,SAAS,OAAO,EACd,GAAG,OAC+C;IAClD,qBAAO,6LAAC,6KAAoB;QAAC,aAAU;QAAU,GAAG,KAAK;;;;;;AAC3D;KAJS;AAMT,SAAS,YAAY,EACnB,GAAG,OACgD;IACnD,qBAAO,6LAAC,8KAAqB;QAAC,aAAU;QAAgB,GAAG,KAAK;;;;;;AAClE;MAJS;AAMT,SAAS,YAAY,EACnB,GAAG,OACgD;IACnD,qBAAO,6LAAC,8KAAqB;QAAC,aAAU;QAAgB,GAAG,KAAK;;;;;;AAClE;MAJS;AAMT,SAAS,cAAc,EACrB,SAAS,EACT,OAAO,SAAS,EAChB,QAAQ,EACR,GAAG,OAGJ;IACC,qBACE,6LAAC,gLAAuB;QACtB,aAAU;QACV,aAAW;QACX,WAAW,IAAA,qHAAE,EACX,gzBACA;QAED,GAAG,KAAK;;YAER;0BACD,6LAAC,6KAAoB;gBAAC,OAAO;0BAC3B,cAAA,6LAAC,8OAAe;oBAAC,WAAU;;;;;;;;;;;;;;;;;AAInC;MAxBS;AA0BT,SAAS,cAAc,EACrB,SAAS,EACT,QAAQ,EACR,WAAW,cAAc,EACzB,QAAQ,QAAQ,EAChB,GAAG,OACkD;IACrD,qBACE,6LAAC,+KAAsB;kBACrB,cAAA,6LAAC,gLAAuB;YACtB,aAAU;YACV,WAAW,IAAA,qHAAE,EACX,ijBACA,aAAa,YACX,mIACF;YAEF,UAAU;YACV,OAAO;YACN,GAAG,KAAK;;8BAET,6LAAC;;;;;8BACD,6LAAC,iLAAwB;oBACvB,WAAW,IAAA,qHAAE,EACX,OACA,aAAa,YACX;8BAGH;;;;;;8BAEH,6LAAC;;;;;;;;;;;;;;;;AAIT;MAnCS;AAqCT,SAAS,YAAY,EACnB,SAAS,EACT,GAAG,OACgD;IACnD,qBACE,6LAAC,8KAAqB;QACpB,aAAU;QACV,WAAW,IAAA,qHAAE,EAAC,6CAA6C;QAC1D,GAAG,KAAK;;;;;;AAGf;MAXS;AAaT,SAAS,WAAW,EAClB,SAAS,EACT,QAAQ,EACR,GAAG,OAC+C;IAClD,qBACE,6LAAC,6KAAoB;QACnB,aAAU;QACV,WAAW,IAAA,qHAAE,EACX,6aACA;QAED,GAAG,KAAK;;0BAET,6LAAC;gBACC,aAAU;gBACV,WAAU;0BAEV,cAAA,6LAAC,sLAA6B;8BAC5B,cAAA,6LAAC,wNAAS;wBAAC,WAAU;;;;;;;;;;;;;;;;0BAGzB,6LAAC,iLAAwB;0BAAE;;;;;;;;;;;;AAGjC;MAzBS;AA2BT,SAAS,gBAAgB,EACvB,SAAS,EACT,GAAG,OACoD;IACvD,qBACE,6LAAC,kLAAyB;QACxB,aAAU;QACV,WAAW,IAAA,qHAAE,EAAC,iDAAiD;QAC9D,GAAG,KAAK;;;;;;AAGf;MAXS;AAaT,SAAS,qBAAqB,EAC5B,SAAS,EACT,GAAG,OACyD;IAC5D,qBACE,6LAAC,uLAA8B;QAC7B,aAAU;QACV,WAAW,IAAA,qHAAE,EACX,wDACA;QAED,GAAG,KAAK;kBAET,cAAA,6LAAC,wOAAa;YAAC,WAAU;;;;;;;;;;;AAG/B;MAhBS;AAkBT,SAAS,uBAAuB,EAC9B,SAAS,EACT,GAAG,OAC2D;IAC9D,qBACE,6LAAC,yLAAgC;QAC/B,aAAU;QACV,WAAW,IAAA,qHAAE,EACX,wDACA;QAED,GAAG,KAAK;kBAET,cAAA,6LAAC,8OAAe;YAAC,WAAU;;;;;;;;;;;AAGjC;MAhBS"}},
    {"offset": {"line": 1227, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/Martin/Desktop/PROYECTOS/Tienda-Blama-2026/components/admin/product-form.tsx"],"sourcesContent":["\r\n\"use client\"\r\n\r\nimport { useState, useEffect } from \"react\"\r\nimport { supabase } from \"@/lib/supabaseClient\"\r\nimport {\r\n    createAdminCategoria,\r\n    fetchAdminCategorias,\r\n    fetchProductoSpecsAndVariants,\r\n    saveAdminProductoViaApi,\r\n    uploadProductImages,\r\n    uploadProductVideos,\r\n} from \"@/features/admin\"\r\nimport { Button } from \"@/components/ui/button\"\r\nimport { Input } from \"@/components/ui/input\"\r\nimport { Label } from \"@/components/ui/label\"\r\nimport { Textarea } from \"@/components/ui/textarea\"\r\nimport { ArrowDown, ArrowUp, Loader2, Save, Star, Trash2, UploadCloud } from \"lucide-react\"\r\nimport {\r\n    Select,\r\n    SelectContent,\r\n    SelectItem,\r\n    SelectTrigger,\r\n    SelectValue,\r\n} from \"@/components/ui/select\"\r\n\r\n\r\ninterface ProductFormProps {\r\n    productToEdit?: any\r\n    categories?: any[]\r\n    onSuccess: () => void\r\n    onCancel: () => void\r\n}\r\n\r\nexport function ProductForm({ productToEdit, categories = [], onSuccess, onCancel }: ProductFormProps) {\r\n    const [loading, setLoading] = useState(false)\r\n    const [uploading, setUploading] = useState(false)\r\n    // Categories are now passed as props\r\n\r\n    // Form State\r\n    const [name, setName] = useState(\"\")\r\n    const [price, setPrice] = useState(\"\")\r\n    const [priceBefore, setPriceBefore] = useState(\"\")\r\n    const [stock, setStock] = useState(\"\")\r\n    const [calificacion, setCalificacion] = useState(\"5\")\r\n    const [imageUrl, setImageUrl] = useState(\"\")\r\n    const [galleryImages, setGalleryImages] = useState<string[]>([])\r\n    const [newGalleryUrl, setNewGalleryUrl] = useState(\"\")\r\n    const [videos, setVideos] = useState<string[]>([])\r\n    const [selectedParentId, setSelectedParentId] = useState<string>(\"default\")\r\n    const [selectedSubcategoryId, setSelectedSubcategoryId] = useState<string>(\"default\")\r\n\r\n    const [descripcion, setDescripcion] = useState(\"\")\r\n    const [materiales, setMateriales] = useState(\"\")\r\n    const [tamano, setTamano] = useState(\"\")\r\n    const [color, setColor] = useState(\"\")\r\n    const [cuidados, setCuidados] = useState(\"\")\r\n    const [uso, setUso] = useState(\"\")\r\n\r\n    const [especificaciones, setEspecificaciones] = useState<Array<{ id?: number; clave: string; valor: string; orden: number }>>([])\r\n    const [variantes, setVariantes] = useState<Array<{ id?: number; etiqueta: string; precio: string; precio_antes: string; stock: string; activo: boolean }>>([])\r\n\r\n    // NEW: Toggle for manual category change\r\n    const [changeCategoryMode, setChangeCategoryMode] = useState(false)\r\n\r\n    // Computed Category State removed (we use direct productToEdit or local state)\r\n\r\n\r\n\r\n    // Create Category State\r\n    const [isCreatingCategory, setIsCreatingCategory] = useState(false)\r\n    const [newCategoryName, setNewCategoryName] = useState(\"\")\r\n\r\n\r\n    useEffect(() => {\r\n        if (productToEdit) {\r\n            setName(productToEdit.nombre || \"\")\r\n            setPrice(productToEdit.precio?.toString() || \"\")\r\n            setPriceBefore(productToEdit.precio_antes != null ? String(productToEdit.precio_antes) : \"\")\r\n            setStock(productToEdit.stock?.toString() || \"\")\r\n            setCalificacion(productToEdit.calificacion != null ? String(productToEdit.calificacion) : \"5\")\r\n            setImageUrl(productToEdit.imagen_url || \"\")\r\n            setDescripcion(productToEdit.descripcion || \"\")\r\n            setMateriales(productToEdit.materiales || \"\")\r\n            setTamano(productToEdit.tamano || \"\")\r\n            setColor(productToEdit.color || \"\")\r\n            setCuidados(productToEdit.cuidados || \"\")\r\n            setUso(productToEdit.uso || \"\")\r\n            const fromDb = Array.isArray(productToEdit.imagenes) ? (productToEdit.imagenes as string[]) : []\r\n            const normalized = [\r\n                ...(productToEdit.imagen_url ? [productToEdit.imagen_url] : []),\r\n                ...fromDb,\r\n            ]\r\n                .map((x) => String(x || \"\").trim())\r\n                .filter(Boolean)\r\n            const unique = Array.from(new Set(normalized)).slice(0, 10)\r\n            setGalleryImages(unique)\r\n            setNewGalleryUrl(\"\")\r\n\r\n            const vFromDb = Array.isArray((productToEdit as any).videos) ? ((productToEdit as any).videos as string[]) : []\r\n            const vClean = vFromDb.map((x) => String(x || '').trim()).filter(Boolean)\r\n            setVideos(Array.from(new Set(vClean)).slice(0, 6))\r\n\r\n            // Category syncing logic:\r\n            // If editing, we DO NOT fill the selectedParentId/Sub to avoid confusing the \"New Category\" fields.\r\n            // We want \"New Category\" fields to start empty (default) so the user explicitly chooses if they want to change.\r\n            // UNLESS it's a new product or no category assigned.\r\n\r\n            const rawCatId = productToEdit.categoria_id\r\n            if (!rawCatId) {\r\n                setSelectedParentId(\"default\")\r\n                setSelectedSubcategoryId(\"default\")\r\n            }\r\n            // If rawCatId exists, we leave selected*Id as default. The UI will show the \"Current Category\" block.\r\n\r\n            ; (async () => {\r\n                try {\r\n                    const productId = Number(productToEdit.id)\r\n                    if (!productId) {\r\n                        setEspecificaciones([])\r\n                        setVariantes([])\r\n                        return\r\n                    }\r\n\r\n                    const { specs, variants } = await fetchProductoSpecsAndVariants(productId)\r\n\r\n                    const nextSpecs = Array.isArray(specs)\r\n                        ? specs.map((s: any) => ({\r\n                            id: Number(s.id),\r\n                            clave: String(s.clave || ''),\r\n                            valor: String(s.valor || ''),\r\n                            orden: Number(s.orden || 0),\r\n                        }))\r\n                        : []\r\n                    setEspecificaciones(nextSpecs)\r\n\r\n                    const nextVars = Array.isArray(variants)\r\n                        ? variants.map((v: any) => ({\r\n                            id: Number(v.id),\r\n                            etiqueta: String(v.etiqueta || ''),\r\n                            precio: v.precio != null ? String(v.precio) : '',\r\n                            precio_antes: v.precio_antes != null ? String(v.precio_antes) : '',\r\n                            stock: String(v.stock ?? 0),\r\n                            activo: Boolean(v.activo ?? true),\r\n                        }))\r\n                        : []\r\n                    setVariantes(nextVars)\r\n                } catch (err) {\r\n                    setEspecificaciones([])\r\n                    setVariantes([])\r\n                }\r\n            })()\r\n        } else {\r\n            // Reset form when not editing (or switching to new)\r\n            setName(\"\")\r\n            setPrice(\"\")\r\n            setPriceBefore(\"\")\r\n            setStock(\"\")\r\n            setCalificacion(\"5\")\r\n            setImageUrl(\"\")\r\n            setDescripcion(\"\")\r\n            setMateriales(\"\")\r\n            setTamano(\"\")\r\n            setColor(\"\")\r\n            setCuidados(\"\")\r\n            setUso(\"\")\r\n            setGalleryImages([])\r\n            setNewGalleryUrl(\"\")\r\n            setVideos([])\r\n            setSelectedParentId(\"default\")\r\n            setSelectedSubcategoryId(\"default\")\r\n            setEspecificaciones([])\r\n            setVariantes([])\r\n        }\r\n    }, [productToEdit, categories])\r\n\r\n\r\n\r\n    function normalizeImages(input: string[]) {\r\n        const unique: string[] = []\r\n        for (const raw of input) {\r\n            const v = String(raw || \"\").trim()\r\n            if (!v) continue\r\n            if (!unique.includes(v)) unique.push(v)\r\n            if (unique.length >= 10) break\r\n        }\r\n        return unique\r\n    }\r\n\r\n    function normalizeVideos(input: string[]) {\r\n        const unique: string[] = []\r\n        for (const raw of input) {\r\n            const v = String(raw || \"\").trim()\r\n            if (!v) continue\r\n            if (!unique.includes(v)) unique.push(v)\r\n            if (unique.length >= 6) break\r\n        }\r\n        return unique\r\n    }\r\n\r\n    async function handleVideoUpload(e: React.ChangeEvent<HTMLInputElement>) {\r\n        if (!e.target.files || e.target.files.length === 0) return\r\n\r\n        try {\r\n            setUploading(true)\r\n            const files = Array.from(e.target.files)\r\n            const remaining = Math.max(0, 6 - videos.length)\r\n            const toUpload = files.slice(0, remaining)\r\n\r\n            const uploadedUrls = await uploadProductVideos({ files: toUpload })\r\n\r\n            const next = normalizeVideos([...videos, ...uploadedUrls])\r\n            setVideos(next)\r\n        } catch (error: any) {\r\n            alert(\"Error subiendo video: \" + error.message)\r\n        } finally {\r\n            setUploading(false)\r\n            e.target.value = ''\r\n        }\r\n    }\r\n\r\n    function addGalleryUrl(url: string) {\r\n        const next = normalizeImages([...galleryImages, url])\r\n        setGalleryImages(next)\r\n        if (!imageUrl && next.length > 0) {\r\n            setImageUrl(next[0])\r\n        }\r\n    }\r\n\r\n    function removeGalleryUrl(url: string) {\r\n        const next = galleryImages.filter((x) => x !== url)\r\n        setGalleryImages(next)\r\n\r\n        if (imageUrl === url) {\r\n            setImageUrl(next[0] || \"\")\r\n        }\r\n    }\r\n\r\n    function makeGalleryMain(url: string) {\r\n        const next = normalizeImages([url, ...galleryImages.filter((x) => x !== url)])\r\n        setGalleryImages(next)\r\n        setImageUrl(next[0] || \"\")\r\n    }\r\n\r\n    function moveGalleryIndex(fromIndex: number, toIndex: number) {\r\n        if (fromIndex === toIndex) return\r\n        if (fromIndex < 0 || toIndex < 0) return\r\n        if (fromIndex >= galleryImages.length || toIndex >= galleryImages.length) return\r\n\r\n        const next = [...galleryImages]\r\n        const [moved] = next.splice(fromIndex, 1)\r\n        next.splice(toIndex, 0, moved)\r\n        setGalleryImages(next)\r\n        if (next.length > 0) setImageUrl(next[0])\r\n    }\r\n\r\n    function moveVideoIndex(fromIndex: number, toIndex: number) {\r\n        if (fromIndex === toIndex) return\r\n        if (fromIndex < 0 || toIndex < 0) return\r\n        if (fromIndex >= videos.length || toIndex >= videos.length) return\r\n\r\n        const next = [...videos]\r\n        const [moved] = next.splice(fromIndex, 1)\r\n        next.splice(toIndex, 0, moved)\r\n        setVideos(next)\r\n    }\r\n\r\n\r\n    async function handleCreateCategory() {\r\n        if (!newCategoryName.trim()) return\r\n\r\n        try {\r\n            setLoading(true)\r\n            const data = await createAdminCategoria({ nombre: newCategoryName })\r\n\r\n            // Add to local list and select it\r\n            // setCategories([...categories, data]) // Cannot update props locally\r\n            window.location.reload() // Force reload to fetch new category\r\n            setCategoryId(data.id.toString())\r\n            setIsCreatingCategory(false)\r\n            setNewCategoryName(\"\")\r\n\r\n        } catch (error: any) {\r\n            alert(\"Error creando categorÃ­a: \" + error.message)\r\n        } finally {\r\n            setLoading(false)\r\n        }\r\n    }\r\n\r\n    async function handleImageUpload(e: React.ChangeEvent<HTMLInputElement>) {\r\n        if (!e.target.files || e.target.files.length === 0) return;\r\n\r\n        try {\r\n            setUploading(true)\r\n            const files = Array.from(e.target.files).filter((f) => {\r\n                const t = String(f?.type || '').toLowerCase()\r\n                const n = String(f?.name || '').toLowerCase()\r\n                if (t) return t.startsWith('image/')\r\n                return n.endsWith('.png') || n.endsWith('.jpg') || n.endsWith('.jpeg') || n.endsWith('.webp') || n.endsWith('.gif')\r\n            })\r\n            const remaining = Math.max(0, 10 - galleryImages.length)\r\n            const toUpload = files.slice(0, remaining)\r\n\r\n            const uploadedUrls = await uploadProductImages({ files: toUpload })\r\n\r\n            const next = normalizeImages([...galleryImages, ...uploadedUrls])\r\n            setGalleryImages(next)\r\n\r\n            if (!imageUrl && next.length > 0) {\r\n                setImageUrl(next[0])\r\n            }\r\n\r\n        } catch (error: any) {\r\n            alert(\"Error subiendo imagen: \" + error.message)\r\n        } finally {\r\n            setUploading(false)\r\n            e.target.value = ''\r\n        }\r\n    }\r\n\r\n    async function handleSubmit(e: React.FormEvent) {\r\n        e.preventDefault()\r\n        setLoading(true)\r\n\r\n        try {\r\n            const sessionRes = await supabase.auth.getSession()\r\n            const accessToken = sessionRes?.data?.session?.access_token\r\n            if (!accessToken) {\r\n                alert('Tu sesiÃ³n expirÃ³. Vuelve a iniciar sesiÃ³n.')\r\n                setLoading(false)\r\n                return\r\n            }\r\n\r\n            // Determine final category ID\r\n            // Determine final category ID\r\n            let finalCategoryIdToSave: string | number | null = null\r\n\r\n            // LOGIC: \r\n            // 1. If Change Mode is active (explicit toggle OR no existing category), use selectedParentId.\r\n            // 2. Else, keep existing productToEdit.categoria_id.\r\n\r\n            const isChangeMode = (!productToEdit?.categoria_id) || changeCategoryMode\r\n\r\n            if (isChangeMode) {\r\n                if (!selectedParentId || selectedParentId === \"default\") {\r\n                    alert(\"Debes seleccionar una CategorÃ­a Principal.\")\r\n                    setLoading(false)\r\n                    return\r\n                }\r\n\r\n                finalCategoryIdToSave = selectedParentId\r\n\r\n                // Validate subcategory if needed\r\n                const hasSubcats = categories.some((c: any) => String(c.parent_id) === selectedParentId)\r\n                if (hasSubcats && (!selectedSubcategoryId || selectedSubcategoryId === \"default\")) {\r\n                    alert(\"Debes seleccionar una SubcategorÃ­a para la nueva categorÃ­a seleccionada.\")\r\n                    setLoading(false)\r\n                    return\r\n                }\r\n                if (selectedSubcategoryId && selectedSubcategoryId !== \"default\") {\r\n                    finalCategoryIdToSave = selectedSubcategoryId\r\n                }\r\n            } else {\r\n                // Not in change mode, preserve existing\r\n                if (productToEdit?.categoria_id) {\r\n                    finalCategoryIdToSave = productToEdit.categoria_id\r\n                } else {\r\n                    // Should not happen if logic is correct, but fallback\r\n                    alert(\"Error de lÃ³gica: No hay categorÃ­a asignada y no se seleccionÃ³ ninguna.\")\r\n                    setLoading(false)\r\n                    return\r\n                }\r\n            }\r\n\r\n            const priceNum = Number(price)\r\n            if (!Number.isFinite(priceNum) || priceNum <= 0) {\r\n                alert('Ingresa un precio actual vÃ¡lido')\r\n                setLoading(false)\r\n                return\r\n            }\r\n\r\n            const priceBeforeRaw = String(priceBefore || '').trim()\r\n            const priceBeforeNum = priceBeforeRaw ? Number(priceBeforeRaw) : null\r\n            if (priceBeforeNum != null && (!Number.isFinite(priceBeforeNum) || priceBeforeNum <= 0)) {\r\n                alert('Ingresa un precio antes vÃ¡lido o dÃ©jalo vacÃ­o')\r\n                setLoading(false)\r\n                return\r\n            }\r\n\r\n            if (priceBeforeNum != null && priceBeforeNum <= priceNum) {\r\n                alert('El precio antes debe ser mayor que el precio actual para mostrar oferta')\r\n                setLoading(false)\r\n                return\r\n            }\r\n\r\n            const stockNum = Number(stock)\r\n            if (!Number.isFinite(stockNum) || stockNum < 0) {\r\n                alert('Ingresa un stock vÃ¡lido')\r\n                setLoading(false)\r\n                return\r\n            }\r\n\r\n            const calificacionNum = Number(calificacion)\r\n            if (!Number.isFinite(calificacionNum) || calificacionNum < 0 || calificacionNum > 5) {\r\n                alert('Ingresa una calificaciÃ³n vÃ¡lida (0-5)')\r\n                setLoading(false)\r\n                return\r\n            }\r\n\r\n            const mergedImages = galleryImages.length > 0\r\n                ? normalizeImages(galleryImages)\r\n                : normalizeImages([...(imageUrl ? [imageUrl] : [])])\r\n\r\n            const imageOnly = mergedImages.filter((u) => {\r\n                const s = String(u || '').toLowerCase()\r\n                return !(s.endsWith('.mp4') || s.endsWith('.webm') || s.endsWith('.mov') || s.endsWith('.m4v'))\r\n            })\r\n\r\n            const videoFromImages = mergedImages.filter((u) => {\r\n                const s = String(u || '').toLowerCase()\r\n                return s.endsWith('.mp4') || s.endsWith('.webm') || s.endsWith('.mov') || s.endsWith('.m4v')\r\n            })\r\n\r\n            const videosFinal = normalizeVideos([...videos, ...videoFromImages])\r\n\r\n            const mainImage = imageOnly[0] || (imageUrl ? imageUrl : null)\r\n\r\n            const productData = {\r\n                nombre: name,\r\n                precio: priceNum,\r\n                precio_antes: priceBeforeNum,\r\n                stock: stockNum,\r\n                calificacion: calificacionNum,\r\n                imagen_url: mainImage,\r\n                imagenes: imageOnly,\r\n                videos: videosFinal,\r\n                descripcion: descripcion.trim() || null,\r\n                materiales: materiales.trim() || null,\r\n                tamano: tamano.trim() || null,\r\n                color: color.trim() || null,\r\n                cuidados: cuidados.trim() || null,\r\n                uso: uso.trim() || null,\r\n                categoria_id: finalCategoryIdToSave ? parseInt(finalCategoryIdToSave) : null\r\n            }\r\n\r\n            const cleanSpecs = especificaciones\r\n                .map((s) => ({\r\n                    clave: String(s.clave || '').trim(),\r\n                    valor: String(s.valor || '').trim(),\r\n                    orden: Number(s.orden || 0),\r\n                }))\r\n                .filter((s) => s.clave.length > 0)\r\n\r\n            const cleanVariants = variantes\r\n                .map((v) => ({\r\n                    etiqueta: String(v.etiqueta || '').trim(),\r\n                    precio: String(v.precio || '').trim(),\r\n                    precio_antes: String(v.precio_antes || '').trim(),\r\n                    stock: String(v.stock || '').trim(),\r\n                    activo: Boolean(v.activo),\r\n                }))\r\n                .filter((v) => v.etiqueta.length > 0)\r\n\r\n            const method = productToEdit ? 'PUT' : 'POST'\r\n            const apiBody: any = {\r\n                product: productData,\r\n                specs: cleanSpecs,\r\n                variants: cleanVariants.map((v) => ({\r\n                    etiqueta: v.etiqueta,\r\n                    precio: v.precio ? Number(v.precio) : null,\r\n                    precio_antes: v.precio_antes ? Number(v.precio_antes) : null,\r\n                    stock: Number(v.stock || 0),\r\n                    activo: v.activo,\r\n                })),\r\n            }\r\n            if (productToEdit) apiBody.id = Number(productToEdit.id)\r\n\r\n            await saveAdminProductoViaApi({\r\n                accessToken,\r\n                method: method as \"POST\" | \"PUT\",\r\n                body: apiBody,\r\n            })\r\n\r\n            onSuccess()\r\n        } catch (error: any) {\r\n            alert(\"Error al guardar: \" + error.message)\r\n        } finally {\r\n            setLoading(false)\r\n        }\r\n    }\r\n\r\n\r\n\r\n    return (\r\n        <form onSubmit={handleSubmit} className=\"space-y-6 py-4\">\r\n            <div className=\"space-y-2\">\r\n                <Label htmlFor=\"name\">Nombre del Producto</Label>\r\n                <Input\r\n                    id=\"name\"\r\n                    placeholder=\"Ej: Zapatillas Nike Air\"\r\n                    required\r\n                    value={name}\r\n                    onChange={(e) => setName(e.target.value)}\r\n                />\r\n            </div>\r\n\r\n            <div className=\"space-y-2\">\r\n                <Label htmlFor=\"descripcion\">DescripciÃ³n (general)</Label>\r\n                <Textarea\r\n                    id=\"descripcion\"\r\n                    placeholder=\"DescripciÃ³n completa del producto...\"\r\n                    value={descripcion}\r\n                    onChange={(e) => setDescripcion(e.target.value)}\r\n                />\r\n            </div>\r\n\r\n            <div className=\"grid grid-cols-1 sm:grid-cols-2 gap-4\">\r\n                <div className=\"space-y-2\">\r\n                    <Label htmlFor=\"materiales\">Materiales</Label>\r\n                    <Textarea id=\"materiales\" value={materiales} onChange={(e) => setMateriales(e.target.value)} />\r\n                </div>\r\n                <div className=\"space-y-2\">\r\n                    <Label htmlFor=\"tamano\">TamaÃ±o / Medidas</Label>\r\n                    <Textarea id=\"tamano\" value={tamano} onChange={(e) => setTamano(e.target.value)} />\r\n                </div>\r\n                <div className=\"space-y-2\">\r\n                    <Label htmlFor=\"color\">Color</Label>\r\n                    <Textarea id=\"color\" value={color} onChange={(e) => setColor(e.target.value)} />\r\n                </div>\r\n                <div className=\"space-y-2\">\r\n                    <Label htmlFor=\"cuidados\">Cuidados</Label>\r\n                    <Textarea id=\"cuidados\" value={cuidados} onChange={(e) => setCuidados(e.target.value)} />\r\n                </div>\r\n                <div className=\"space-y-2 sm:col-span-2\">\r\n                    <Label htmlFor=\"uso\">Uso recomendado</Label>\r\n                    <Textarea id=\"uso\" value={uso} onChange={(e) => setUso(e.target.value)} />\r\n                </div>\r\n            </div>\r\n\r\n            <div className=\"space-y-3\">\r\n                <div className=\"flex items-center justify-between\">\r\n                    <Label>Ficha tÃ©cnica (especificaciones)</Label>\r\n                    <Button\r\n                        type=\"button\"\r\n                        variant=\"outline\"\r\n                        size=\"sm\"\r\n                        onClick={() => setEspecificaciones((prev) => ([...prev, { clave: '', valor: '', orden: prev.length }]))}\r\n                    >\r\n                        Agregar\r\n                    </Button>\r\n                </div>\r\n\r\n                {especificaciones.length === 0 ? (\r\n                    <div className=\"text-sm text-muted-foreground\">Sin especificaciones</div>\r\n                ) : (\r\n                    <div className=\"space-y-2\">\r\n                        {especificaciones\r\n                            .slice()\r\n                            .sort((a, b) => Number(a.orden || 0) - Number(b.orden || 0))\r\n                            .map((s, idx) => (\r\n                                <div key={s.id ?? `new-${idx}`} className=\"grid grid-cols-1 sm:grid-cols-12 gap-2 rounded-lg border bg-popover p-3\">\r\n                                    <div className=\"sm:col-span-4\">\r\n                                        <Label className=\"text-xs\">Clave</Label>\r\n                                        <Input\r\n                                            value={s.clave}\r\n                                            onChange={(e) => {\r\n                                                const val = e.target.value\r\n                                                setEspecificaciones((prev) => prev.map((p) => (p === s ? { ...p, clave: val } : p)))\r\n                                            }}\r\n                                        />\r\n                                    </div>\r\n                                    <div className=\"sm:col-span-6\">\r\n                                        <Label className=\"text-xs\">Valor</Label>\r\n                                        <Input\r\n                                            value={s.valor}\r\n                                            onChange={(e) => {\r\n                                                const val = e.target.value\r\n                                                setEspecificaciones((prev) => prev.map((p) => (p === s ? { ...p, valor: val } : p)))\r\n                                            }}\r\n                                        />\r\n                                    </div>\r\n                                    <div className=\"sm:col-span-2 flex items-end gap-2\">\r\n                                        <Button\r\n                                            type=\"button\"\r\n                                            variant=\"ghost\"\r\n                                            size=\"icon\"\r\n                                            className=\"h-9 w-9\"\r\n                                            onClick={() => setEspecificaciones((prev) => prev.map((p) => (p === s ? { ...p, orden: Math.max(0, Number(p.orden || 0) - 1) } : p)))}\r\n                                        >\r\n                                            <ArrowUp className=\"h-4 w-4\" />\r\n                                        </Button>\r\n                                        <Button\r\n                                            type=\"button\"\r\n                                            variant=\"ghost\"\r\n                                            size=\"icon\"\r\n                                            className=\"h-9 w-9\"\r\n                                            onClick={() => setEspecificaciones((prev) => prev.map((p) => (p === s ? { ...p, orden: Number(p.orden || 0) + 1 } : p)))}\r\n                                        >\r\n                                            <ArrowDown className=\"h-4 w-4\" />\r\n                                        </Button>\r\n                                        <Button\r\n                                            type=\"button\"\r\n                                            variant=\"ghost\"\r\n                                            size=\"icon\"\r\n                                            className=\"h-9 w-9\"\r\n                                            onClick={() => setEspecificaciones((prev) => prev.filter((p) => p !== s))}\r\n                                        >\r\n                                            <Trash2 className=\"h-4 w-4\" />\r\n                                        </Button>\r\n                                    </div>\r\n                                </div>\r\n                            ))}\r\n                    </div>\r\n                )}\r\n            </div>\r\n\r\n            <div className=\"space-y-2\">\r\n                <div className=\"flex items-center justify-between\">\r\n                    <Label>Videos (hasta 6)</Label>\r\n                    <span className=\"text-xs text-muted-foreground\">{videos.length}/6</span>\r\n                </div>\r\n\r\n                <div className=\"flex items-center gap-3\">\r\n                    <Input\r\n                        type=\"file\"\r\n                        accept=\"video/mp4,video/webm\"\r\n                        multiple\r\n                        onChange={handleVideoUpload}\r\n                        disabled={uploading || videos.length >= 6}\r\n                    />\r\n                </div>\r\n\r\n                {videos.length > 0 && (\r\n                    <div className=\"space-y-2\">\r\n                        {videos.map((url, idx) => (\r\n                            <div key={`${url}-${idx}`} className=\"flex items-center gap-3 rounded-lg border bg-popover p-2\">\r\n                                <div className=\"h-7 w-7 rounded-md bg-primary text-primary-foreground flex items-center justify-center text-xs font-bold\">\r\n                                    {idx + 1}\r\n                                </div>\r\n\r\n                                <div className=\"min-w-0 flex-1\">\r\n                                    <p className=\"text-xs text-muted-foreground truncate\">{url}</p>\r\n                                </div>\r\n\r\n                                <div className=\"flex items-center gap-1\">\r\n                                    <Button\r\n                                        type=\"button\"\r\n                                        variant=\"ghost\"\r\n                                        size=\"icon\"\r\n                                        className=\"h-8 w-8\"\r\n                                        onClick={() => moveVideoIndex(idx, idx - 1)}\r\n                                        disabled={idx === 0}\r\n                                    >\r\n                                        <ArrowUp className=\"h-4 w-4\" />\r\n                                    </Button>\r\n\r\n                                    <Button\r\n                                        type=\"button\"\r\n                                        variant=\"ghost\"\r\n                                        size=\"icon\"\r\n                                        className=\"h-8 w-8\"\r\n                                        onClick={() => moveVideoIndex(idx, idx + 1)}\r\n                                        disabled={idx === videos.length - 1}\r\n                                    >\r\n                                        <ArrowDown className=\"h-4 w-4\" />\r\n                                    </Button>\r\n\r\n                                    <Button\r\n                                        type=\"button\"\r\n                                        variant=\"ghost\"\r\n                                        size=\"icon\"\r\n                                        className=\"h-8 w-8\"\r\n                                        onClick={() => setVideos((prev) => prev.filter((x) => x !== url))}\r\n                                    >\r\n                                        <Trash2 className=\"h-4 w-4\" />\r\n                                    </Button>\r\n                                </div>\r\n                            </div>\r\n                        ))}\r\n                    </div>\r\n                )}\r\n            </div>\r\n\r\n            <div className=\"space-y-3\">\r\n                <div className=\"flex items-center justify-between\">\r\n                    <Label>Variantes (talla / color / modelo)</Label>\r\n                    <Button\r\n                        type=\"button\"\r\n                        variant=\"outline\"\r\n                        size=\"sm\"\r\n                        onClick={() => setVariantes((prev) => ([...prev, { etiqueta: '', precio: '', precio_antes: '', stock: '0', activo: true }]))}\r\n                    >\r\n                        Agregar\r\n                    </Button>\r\n                </div>\r\n\r\n                {variantes.length === 0 ? (\r\n                    <div className=\"text-sm text-muted-foreground\">Sin variantes</div>\r\n                ) : (\r\n                    <div className=\"space-y-2\">\r\n                        {variantes.map((v, idx) => (\r\n                            <div key={v.id ?? `vnew-${idx}`} className=\"grid grid-cols-1 sm:grid-cols-12 gap-2 rounded-lg border bg-popover p-3\">\r\n                                <div className=\"sm:col-span-4\">\r\n                                    <Label className=\"text-xs\">Etiqueta</Label>\r\n                                    <Input\r\n                                        value={v.etiqueta}\r\n                                        onChange={(e) => {\r\n                                            const val = e.target.value\r\n                                            setVariantes((prev) => prev.map((p) => (p === v ? { ...p, etiqueta: val } : p)))\r\n                                        }}\r\n                                    />\r\n                                </div>\r\n                                <div className=\"sm:col-span-2\">\r\n                                    <Label className=\"text-xs\">Precio (opcional)</Label>\r\n                                    <Input\r\n                                        inputMode=\"decimal\"\r\n                                        value={v.precio}\r\n                                        onChange={(e) => {\r\n                                            const val = e.target.value\r\n                                            setVariantes((prev) => prev.map((p) => (p === v ? { ...p, precio: val } : p)))\r\n                                        }}\r\n                                    />\r\n                                </div>\r\n                                <div className=\"sm:col-span-2\">\r\n                                    <Label className=\"text-xs\">Precio antes (opcional)</Label>\r\n                                    <Input\r\n                                        inputMode=\"decimal\"\r\n                                        value={v.precio_antes}\r\n                                        onChange={(e) => {\r\n                                            const val = e.target.value\r\n                                            setVariantes((prev) => prev.map((p) => (p === v ? { ...p, precio_antes: val } : p)))\r\n                                        }}\r\n                                    />\r\n                                </div>\r\n                                <div className=\"sm:col-span-2\">\r\n                                    <Label className=\"text-xs\">Stock</Label>\r\n                                    <Input\r\n                                        inputMode=\"numeric\"\r\n                                        value={v.stock}\r\n                                        onChange={(e) => {\r\n                                            const val = e.target.value\r\n                                            setVariantes((prev) => prev.map((p) => (p === v ? { ...p, stock: val } : p)))\r\n                                        }}\r\n                                    />\r\n                                </div>\r\n                                <div className=\"sm:col-span-2 flex items-end gap-2\">\r\n                                    <Button\r\n                                        type=\"button\"\r\n                                        variant=\"outline\"\r\n                                        size=\"sm\"\r\n                                        onClick={() => setVariantes((prev) => prev.map((p) => (p === v ? { ...p, activo: !p.activo } : p)))}\r\n                                    >\r\n                                        {v.activo ? 'Activa' : 'Inactiva'}\r\n                                    </Button>\r\n                                    <Button\r\n                                        type=\"button\"\r\n                                        variant=\"ghost\"\r\n                                        size=\"icon\"\r\n                                        className=\"h-9 w-9\"\r\n                                        onClick={() => setVariantes((prev) => prev.filter((p) => p !== v))}\r\n                                    >\r\n                                        <Trash2 className=\"h-4 w-4\" />\r\n                                    </Button>\r\n                                </div>\r\n                            </div>\r\n                        ))}\r\n                    </div>\r\n                )}\r\n            </div>\r\n\r\n            <div className=\"grid grid-cols-1 sm:grid-cols-3 gap-4\">\r\n                <div className=\"space-y-2\">\r\n                    <Label htmlFor=\"price\">Precio actual (S/)</Label>\r\n                    <Input\r\n                        id=\"price\"\r\n                        type=\"number\"\r\n                        step=\"0.01\"\r\n                        required\r\n                        placeholder=\"0.00\"\r\n                        value={price}\r\n                        onChange={(e) => setPrice(e.target.value)}\r\n                    />\r\n                </div>\r\n                <div className=\"space-y-2\">\r\n                    <Label htmlFor=\"priceBefore\">Precio antes (S/) (opcional)</Label>\r\n                    <Input\r\n                        id=\"priceBefore\"\r\n                        type=\"number\"\r\n                        step=\"0.01\"\r\n                        placeholder=\"0.00\"\r\n                        value={priceBefore}\r\n                        onChange={(e) => setPriceBefore(e.target.value)}\r\n                    />\r\n                </div>\r\n                <div className=\"space-y-2\">\r\n                    <Label htmlFor=\"stock\">Stock (Unidades)</Label>\r\n                    <Input\r\n                        id=\"stock\"\r\n                        type=\"number\"\r\n                        required\r\n                        placeholder=\"10\"\r\n                        value={stock}\r\n                        onChange={(e) => setStock(e.target.value)}\r\n                    />\r\n                </div>\r\n                <div className=\"space-y-2\">\r\n                    <Label htmlFor=\"calificacion\">CalificaciÃ³n (0-5)</Label>\r\n                    <Input\r\n                        id=\"calificacion\"\r\n                        type=\"number\"\r\n                        step=\"0.1\"\r\n                        min=\"0\"\r\n                        max=\"5\"\r\n                        required\r\n                        placeholder=\"5.0\"\r\n                        value={calificacion}\r\n                        onChange={(e) => setCalificacion(e.target.value)}\r\n                    />\r\n                </div>\r\n            </div>\r\n\r\n\r\n            <div className=\"space-y-2\">\r\n                {/* Dynamic Category Section */}\r\n                {(() => {\r\n                    const hasExistingCategory = !!productToEdit?.categoria_id\r\n\r\n                    // Logic to display existing category name\r\n                    let existingParentName = \"\"\r\n                    let existingChildName = \"\"\r\n\r\n                    if (hasExistingCategory && categories.length > 0) {\r\n                        const rawId = String(productToEdit.categoria_id)\r\n                        const current = categories.find((c: any) => String(c.id) === rawId)\r\n                        if (current) {\r\n                            if (current.parent_id) {\r\n                                const p = categories.find((c: any) => String(c.id) === String(current.parent_id))\r\n                                existingParentName = p?.nombre || \"...\"\r\n                                existingChildName = current.nombre\r\n                            } else {\r\n                                existingParentName = current.nombre\r\n                            }\r\n                        }\r\n                    }\r\n\r\n                    return (\r\n                        <div className=\"space-y-4\">\r\n                            {hasExistingCategory && (\r\n                                <div className=\"p-4 border rounded-md bg-muted/40\">\r\n                                    <Label className=\"text-sm font-semibold mb-2 block\">CategorÃ­a Asignada (Actual)</Label>\r\n                                    <div className=\"flex items-center gap-2 text-sm\">\r\n                                        <span className=\"bg-primary/10 text-primary px-3 py-1 rounded-full font-medium\">\r\n                                            {existingParentName || \"Desconocida\"}\r\n                                        </span>\r\n                                        {existingChildName && (\r\n                                            <>\r\n                                                <span className=\"text-muted-foreground\">/</span>\r\n                                                <span className=\"bg-secondary text-secondary-foreground px-3 py-1 rounded-full font-medium\">\r\n                                                    {existingChildName}\r\n                                                </span>\r\n                                            </>\r\n                                        )}\r\n                                    </div>\r\n                                    <div className=\"mt-4\">\r\n                                        <div className=\"flex items-center space-x-2\">\r\n                                            <input\r\n                                                type=\"checkbox\"\r\n                                                id=\"changeCat\"\r\n                                                className=\"h-4 w-4 rounded border-gray-300 text-primary focus:ring-primary\"\r\n                                                checked={changeCategoryMode}\r\n                                                onChange={(e) => setChangeCategoryMode(e.target.checked)}\r\n                                            />\r\n                                            <Label htmlFor=\"changeCat\" className=\"font-normal cursor-pointer select-none\">\r\n                                                Quiero cambiar la categorÃ­a actual\r\n                                            </Label>\r\n                                        </div>\r\n                                    </div>\r\n                                </div>\r\n                            )}\r\n\r\n                            {(!hasExistingCategory || changeCategoryMode) && (\r\n                                <div className={`space-y-4 ${hasExistingCategory ? \"p-4 border border-dashed rounded-md bg-background animate-in fade-in zoom-in-95 duration-200\" : \"\"}`}>\r\n                                    {hasExistingCategory && <Label className=\"text-sm font-semibold text-primary\">Seleccionar Nueva CategorÃ­a</Label>}\r\n\r\n                                    <div className=\"grid grid-cols-1 md:grid-cols-2 gap-4\">\r\n                                        <div className=\"space-y-1\">\r\n                                            <Label className=\"text-xs text-muted-foreground\">CategorÃ­a Principal {hasExistingCategory ? \"(Nueva)\" : \"\"}</Label>\r\n                                            <Select\r\n                                                value={selectedParentId}\r\n                                                onValueChange={(val) => {\r\n                                                    setSelectedParentId(val)\r\n                                                    setSelectedSubcategoryId(\"default\")\r\n                                                }}>\r\n                                                <SelectTrigger>\r\n                                                    <SelectValue placeholder=\"Seleccionar Principal\" />\r\n                                                </SelectTrigger>\r\n                                                <SelectContent>\r\n                                                    <SelectItem value=\"default\">Seleccionar...</SelectItem>\r\n                                                    {categories\r\n                                                        .filter((c: any) => !c.parent_id)\r\n                                                        .sort((a: any, b: any) => a.nombre.localeCompare(b.nombre))\r\n                                                        .map((c: any) => (\r\n                                                            <SelectItem key={c.id} value={String(c.id)}>\r\n                                                                {c.nombre}\r\n                                                            </SelectItem>\r\n                                                        ))}\r\n                                                </SelectContent>\r\n                                            </Select>\r\n                                        </div>\r\n\r\n                                        <div className=\"space-y-1\">\r\n                                            <Label className=\"text-xs text-muted-foreground\">SubcategorÃ­a (Opcional)</Label>\r\n                                            <Select\r\n                                                value={selectedSubcategoryId}\r\n                                                onValueChange={setSelectedSubcategoryId}\r\n                                                disabled={selectedParentId === \"default\" || !categories.some((c: any) => String(c.parent_id) === selectedParentId)}\r\n                                            >\r\n                                                <SelectTrigger>\r\n                                                    <SelectValue placeholder=\"Seleccionar SubcategorÃ­a\" />\r\n                                                </SelectTrigger>\r\n                                                <SelectContent>\r\n                                                    <SelectItem value=\"default\">Ninguna</SelectItem>\r\n                                                    {categories\r\n                                                        .filter((c: any) => String(c.parent_id) === selectedParentId)\r\n                                                        .sort((a: any, b: any) => a.nombre.localeCompare(b.nombre))\r\n                                                        .map((c: any) => (\r\n                                                            <SelectItem key={c.id} value={String(c.id)}>\r\n                                                                {c.nombre}\r\n                                                            </SelectItem>\r\n                                                        ))}\r\n                                                </SelectContent>\r\n                                            </Select>\r\n                                        </div>\r\n                                    </div>\r\n\r\n                                    {/* Create new category shortcut (optional, kept for convenience) */}\r\n                                    {!isCreatingCategory ? (\r\n                                        <Button\r\n                                            type=\"button\"\r\n                                            variant=\"link\"\r\n                                            className=\"h-auto p-0 text-xs text-accent mt-2\"\r\n                                            onClick={() => setIsCreatingCategory(true)}\r\n                                        >\r\n                                            + Crear Nueva CategorÃ­a Global\r\n                                        </Button>\r\n                                    ) : (\r\n                                        <div className=\"flex gap-2 mt-2\">\r\n                                            <Input\r\n                                                placeholder=\"Nombre nueva categorÃ­a...\"\r\n                                                value={newCategoryName}\r\n                                                onChange={(e) => setNewCategoryName(e.target.value)}\r\n                                                className=\"flex-1\"\r\n                                            />\r\n                                            <Button\r\n                                                type=\"button\"\r\n                                                size=\"sm\"\r\n                                                onClick={handleCreateCategory}\r\n                                                disabled={!newCategoryName.trim() || loading}\r\n                                            >\r\n                                                <Save className=\"h-4 w-4\" />\r\n                                            </Button>\r\n                                            <Button\r\n                                                type=\"button\"\r\n                                                variant=\"ghost\"\r\n                                                size=\"sm\"\r\n                                                onClick={() => setIsCreatingCategory(false)}\r\n                                            >\r\n                                                Cancelar\r\n                                            </Button>\r\n                                        </div>\r\n                                    )}\r\n\r\n                                </div>\r\n                            )}\r\n                        </div>\r\n                    )\r\n                })()}\r\n            </div>\r\n\r\n            <div className=\"space-y-2\">\r\n                <Label>Imagen</Label>\r\n                <div className=\"flex gap-2 items-center\">\r\n                    <Input\r\n                        value={imageUrl}\r\n                        onChange={(e) => setImageUrl(e.target.value)}\r\n                        placeholder=\"https://...\"\r\n                        className=\"flex-1\"\r\n                    />\r\n                </div>\r\n                <p className=\"text-xs text-muted-foreground\">Pega una URL externa o sube una imagen (si tienes bucket).</p>\r\n\r\n                {/* Simple File Input for optional upload */}\r\n                <div className=\"mt-2\">\r\n                    <Label htmlFor=\"file-upload\" className=\"cursor-pointer inline-flex items-center gap-2 text-sm bg-primary text-primary-foreground px-3 py-2 rounded-md transition-colors hover:bg-primary/90 focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 shadow-sm\">\r\n                        <UploadCloud className=\"h-4 w-4\" />\r\n                        {uploading ? \"Subiendo...\" : \"Subir desde PC (puedes seleccionar varias)\"}\r\n                    </Label>\r\n                    <Input\r\n                        id=\"file-upload\"\r\n                        type=\"file\"\r\n                        accept=\"image/*\"\r\n                        multiple\r\n                        className=\"hidden\"\r\n                        onChange={handleImageUpload}\r\n                        disabled={uploading}\r\n                    />\r\n                </div>\r\n\r\n                {/* Preview */}\r\n                {imageUrl && (\r\n                    <div className=\"mt-2 h-32 w-32 rounded-lg border overflow-hidden relative bg-popover\">\r\n                        <img src={imageUrl} alt=\"Preview\" className=\"h-full w-full object-cover\" />\r\n                    </div>\r\n                )}\r\n            </div>\r\n\r\n            <div className=\"space-y-2\">\r\n                <div className=\"flex items-center justify-between\">\r\n                    <Label>GalerÃ­a (hasta 10)</Label>\r\n                    <span className=\"text-xs text-muted-foreground\">{galleryImages.length}/10</span>\r\n                </div>\r\n\r\n                <div className=\"flex gap-2\">\r\n                    <Input\r\n                        value={newGalleryUrl}\r\n                        onChange={(e) => setNewGalleryUrl(e.target.value)}\r\n                        placeholder=\"Pega otra URL de imagen...\"\r\n                        className=\"flex-1\"\r\n                    />\r\n                    <Button\r\n                        type=\"button\"\r\n                        onClick={() => {\r\n                            if (!newGalleryUrl.trim()) return\r\n                            if (galleryImages.length >= 10) return\r\n                            addGalleryUrl(newGalleryUrl)\r\n                            setNewGalleryUrl(\"\")\r\n                        }}\r\n                        disabled={!newGalleryUrl.trim() || galleryImages.length >= 10}\r\n                    >\r\n                        Agregar\r\n                    </Button>\r\n                </div>\r\n\r\n                {galleryImages.length > 0 && (\r\n                    <div className=\"space-y-2\">\r\n                        {galleryImages.map((url, idx) => (\r\n                            <div key={`${url}-${idx}`} className=\"flex items-center gap-3 rounded-lg border bg-popover p-2\">\r\n                                <div className=\"h-7 w-7 rounded-md bg-primary text-primary-foreground flex items-center justify-center text-xs font-bold\">\r\n                                    {idx + 1}\r\n                                </div>\r\n\r\n                                <div className=\"h-12 w-12 rounded-md overflow-hidden border bg-background flex-shrink-0\">\r\n                                    <img src={url} alt=\"Imagen\" className=\"h-full w-full object-cover\" />\r\n                                </div>\r\n\r\n                                <div className=\"min-w-0 flex-1\">\r\n                                    <p className=\"text-xs text-muted-foreground truncate\">{url}</p>\r\n                                    {idx === 0 && (\r\n                                        <p className=\"text-xs font-medium\">Principal</p>\r\n                                    )}\r\n                                </div>\r\n\r\n                                <div className=\"flex items-center gap-1\">\r\n                                    <Button\r\n                                        type=\"button\"\r\n                                        variant=\"ghost\"\r\n                                        size=\"icon\"\r\n                                        className=\"h-8 w-8\"\r\n                                        onClick={() => makeGalleryMain(url)}\r\n                                        disabled={idx === 0}\r\n                                    >\r\n                                        <Star className=\"h-4 w-4\" />\r\n                                    </Button>\r\n\r\n                                    <Button\r\n                                        type=\"button\"\r\n                                        variant=\"ghost\"\r\n                                        size=\"icon\"\r\n                                        className=\"h-8 w-8\"\r\n                                        onClick={() => moveGalleryIndex(idx, idx - 1)}\r\n                                        disabled={idx === 0}\r\n                                    >\r\n                                        <ArrowUp className=\"h-4 w-4\" />\r\n                                    </Button>\r\n\r\n                                    <Button\r\n                                        type=\"button\"\r\n                                        variant=\"ghost\"\r\n                                        size=\"icon\"\r\n                                        className=\"h-8 w-8\"\r\n                                        onClick={() => moveGalleryIndex(idx, idx + 1)}\r\n                                        disabled={idx === galleryImages.length - 1}\r\n                                    >\r\n                                        <ArrowDown className=\"h-4 w-4\" />\r\n                                    </Button>\r\n\r\n                                    <Button\r\n                                        type=\"button\"\r\n                                        variant=\"ghost\"\r\n                                        size=\"icon\"\r\n                                        className=\"h-8 w-8\"\r\n                                        onClick={() => removeGalleryUrl(url)}\r\n                                    >\r\n                                        <Trash2 className=\"h-4 w-4\" />\r\n                                    </Button>\r\n                                </div>\r\n                            </div>\r\n                        ))}\r\n                    </div>\r\n                )}\r\n            </div>\r\n\r\n            <div className=\"pt-4 flex gap-3 justify-end\">\r\n                <Button type=\"button\" variant=\"outline\" onClick={onCancel}>\r\n                    Cancelar\r\n                </Button>\r\n                <Button type=\"submit\" className=\"bg-primary text-primary-foreground hover:bg-primary/90\" disabled={loading || uploading}>\r\n                    {loading ? (\r\n                        <>\r\n                            <Loader2 className=\"mr-2 h-4 w-4 animate-spin\" /> Guardando...\r\n                        </>\r\n                    ) : (\r\n                        <>\r\n                            <Save className=\"mr-2 h-4 w-4\" /> Guardar Producto\r\n                        </>\r\n                    )}\r\n                </Button>\r\n            </div>\r\n        </form >\r\n    )\r\n}\r\n"],"names":[],"mappings":"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"}},
    {"offset": {"line": 3330, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/Martin/Desktop/PROYECTOS/Tienda-Blama-2026/app/admin/productos/%5Bid%5D/editar/page.tsx"],"sourcesContent":["\"use client\"\r\n\r\nimport { useEffect, useState } from \"react\"\r\nimport Link from \"next/link\"\r\nimport { useParams, useRouter } from \"next/navigation\"\r\nimport { Button } from \"@/components/ui/button\"\r\nimport { Card, CardContent } from \"@/components/ui/card\"\r\nimport { ProductForm } from \"@/components/admin/product-form\"\r\nimport { ArrowLeft } from \"lucide-react\"\r\nimport { useRoleGuard } from \"@/lib/use-role-guard\"\r\nimport { AccessDenied } from \"@/components/admin/access-denied\"\r\nimport { fetchAdminProductoById, fetchAdminCategorias } from \"@/features/admin\"\r\n\r\nexport default function EditarProductoPage() {\r\n    const router = useRouter()\r\n    const params = useParams()\r\n    const id = params.id as string\r\n\r\n    const guard = useRoleGuard({ allowedRoles: ['admin'] })\r\n\r\n    const [loading, setLoading] = useState(true)\r\n    const [producto, setProducto] = useState<any>(null)\r\n    const [categories, setCategories] = useState<any[]>([])\r\n\r\n    useEffect(() => {\r\n        if (guard.loading || guard.accessDenied) return\r\n        loadProducto()\r\n        // eslint-disable-next-line react-hooks/exhaustive-deps\r\n    }, [id, guard.loading, guard.accessDenied])\r\n\r\n    async function loadProducto() {\r\n        setLoading(true)\r\n\r\n        const numericId = Number(id)\r\n        if (!numericId) {\r\n            setProducto(null)\r\n            setLoading(false)\r\n            return\r\n        }\r\n\r\n        try {\r\n            const [prodData, catData] = await Promise.all([\r\n                fetchAdminProductoById(numericId),\r\n                fetchAdminCategorias()\r\n            ])\r\n            setProducto(prodData)\r\n            setCategories(catData || [])\r\n        } catch (err) {\r\n            console.error(err)\r\n            setProducto(null)\r\n            setCategories([])\r\n        }\r\n\r\n        setLoading(false)\r\n    }\r\n\r\n    if (guard.accessDenied) return <AccessDenied />\r\n\r\n    if (guard.loading) {\r\n        return <div className=\"p-6 text-muted-foreground\">Cargando...</div>\r\n    }\r\n\r\n    if (loading) {\r\n        return <div className=\"p-6 text-muted-foreground\">Cargando...</div>\r\n    }\r\n\r\n    if (!producto) {\r\n        return (\r\n            <div className=\"space-y-4\">\r\n                <Button variant=\"ghost\" className=\"gap-2\" asChild>\r\n                    <Link href=\"/admin/productos\">\r\n                        <ArrowLeft className=\"h-4 w-4\" /> Volver\r\n                    </Link>\r\n                </Button>\r\n                <Card className=\"bg-white rounded-xl shadow-sm border\">\r\n                    <CardContent className=\"p-6\">\r\n                        <div className=\"text-lg font-bold text-gray-900\">Producto no encontrado</div>\r\n                        <div className=\"text-sm text-gray-500\">Puede que haya sido eliminado o no exista.</div>\r\n                    </CardContent>\r\n                </Card>\r\n            </div>\r\n        )\r\n    }\r\n\r\n    return (\r\n        <div className=\"space-y-6\">\r\n            <div className=\"flex items-center justify-between gap-3\">\r\n                <Button variant=\"ghost\" className=\"gap-2\" asChild>\r\n                    <Link href=\"/admin/productos\">\r\n                        <ArrowLeft className=\"h-4 w-4\" /> Volver\r\n                    </Link>\r\n                </Button>\r\n                <div>\r\n                    <h1 className=\"text-3xl font-bold text-gray-900\">Editar Producto</h1>\r\n                    <p className=\"text-gray-500\">Actualiza la informaciÃ³n del producto.</p>\r\n                </div>\r\n                <div />\r\n            </div>\r\n\r\n            <Card className=\"bg-white rounded-xl shadow-sm border\">\r\n                <CardContent className=\"p-6\">\r\n                    <ProductForm\r\n                        productToEdit={producto}\r\n                        categories={categories}\r\n                        onSuccess={() => router.push('/admin/productos')}\r\n                        onCancel={() => router.push('/admin/productos')}\r\n                    />\r\n                </CardContent>\r\n            </Card>\r\n        </div>\r\n    )\r\n}\r\n"],"names":[],"mappings":";;;;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAAA;;;AAXA;;;;;;;;;;;AAae,SAAS;;IACpB,MAAM,SAAS,IAAA,kJAAS;IACxB,MAAM,SAAS,IAAA,kJAAS;IACxB,MAAM,KAAK,OAAO,EAAE;IAEpB,MAAM,QAAQ,IAAA,8IAAY,EAAC;QAAE,cAAc;YAAC;SAAQ;IAAC;IAErD,MAAM,CAAC,SAAS,WAAW,GAAG,IAAA,yKAAQ,EAAC;IACvC,MAAM,CAAC,UAAU,YAAY,GAAG,IAAA,yKAAQ,EAAM;IAC9C,MAAM,CAAC,YAAY,cAAc,GAAG,IAAA,yKAAQ,EAAQ,EAAE;IAEtD,IAAA,0KAAS;wCAAC;YACN,IAAI,MAAM,OAAO,IAAI,MAAM,YAAY,EAAE;YACzC;QACA,uDAAuD;QAC3D;uCAAG;QAAC;QAAI,MAAM,OAAO;QAAE,MAAM,YAAY;KAAC;IAE1C,eAAe;QACX,WAAW;QAEX,MAAM,YAAY,OAAO;QACzB,IAAI,CAAC,WAAW;YACZ,YAAY;YACZ,WAAW;YACX;QACJ;QAEA,IAAI;YACA,MAAM,CAAC,UAAU,QAAQ,GAAG,MAAM,QAAQ,GAAG,CAAC;gBAC1C,IAAA,iLAAsB,EAAC;gBACvB,IAAA,+KAAoB;aACvB;YACD,YAAY;YACZ,cAAc,WAAW,EAAE;QAC/B,EAAE,OAAO,KAAK;YACV,QAAQ,KAAK,CAAC;YACd,YAAY;YACZ,cAAc,EAAE;QACpB;QAEA,WAAW;IACf;IAEA,IAAI,MAAM,YAAY,EAAE,qBAAO,6LAAC,2JAAY;;;;;IAE5C,IAAI,MAAM,OAAO,EAAE;QACf,qBAAO,6LAAC;YAAI,WAAU;sBAA4B;;;;;;IACtD;IAEA,IAAI,SAAS;QACT,qBAAO,6LAAC;YAAI,WAAU;sBAA4B;;;;;;IACtD;IAEA,IAAI,CAAC,UAAU;QACX,qBACI,6LAAC;YAAI,WAAU;;8BACX,6LAAC,wIAAM;oBAAC,SAAQ;oBAAQ,WAAU;oBAAQ,OAAO;8BAC7C,cAAA,6LAAC,0KAAI;wBAAC,MAAK;;0CACP,6LAAC,gOAAS;gCAAC,WAAU;;;;;;4BAAY;;;;;;;;;;;;8BAGzC,6LAAC,oIAAI;oBAAC,WAAU;8BACZ,cAAA,6LAAC,2IAAW;wBAAC,WAAU;;0CACnB,6LAAC;gCAAI,WAAU;0CAAkC;;;;;;0CACjD,6LAAC;gCAAI,WAAU;0CAAwB;;;;;;;;;;;;;;;;;;;;;;;IAK3D;IAEA,qBACI,6LAAC;QAAI,WAAU;;0BACX,6LAAC;gBAAI,WAAU;;kCACX,6LAAC,wIAAM;wBAAC,SAAQ;wBAAQ,WAAU;wBAAQ,OAAO;kCAC7C,cAAA,6LAAC,0KAAI;4BAAC,MAAK;;8CACP,6LAAC,gOAAS;oCAAC,WAAU;;;;;;gCAAY;;;;;;;;;;;;kCAGzC,6LAAC;;0CACG,6LAAC;gCAAG,WAAU;0CAAmC;;;;;;0CACjD,6LAAC;gCAAE,WAAU;0CAAgB;;;;;;;;;;;;kCAEjC,6LAAC;;;;;;;;;;;0BAGL,6LAAC,oIAAI;gBAAC,WAAU;0BACZ,cAAA,6LAAC,2IAAW;oBAAC,WAAU;8BACnB,cAAA,6LAAC,yJAAW;wBACR,eAAe;wBACf,YAAY;wBACZ,WAAW,IAAM,OAAO,IAAI,CAAC;wBAC7B,UAAU,IAAM,OAAO,IAAI,CAAC;;;;;;;;;;;;;;;;;;;;;;AAMpD;GAlGwB;;QACL,kJAAS;QACT,kJAAS;QAGV,8IAAY;;;KALN"}}]
}