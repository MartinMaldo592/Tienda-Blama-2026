{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 4, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/Martin/Desktop/PROYECTOS/Tienda-Blama-2026/components/ui/card.tsx"],"sourcesContent":["import * as React from \"react\"\r\n\r\nimport { cn } from \"@/lib/utils\"\r\n\r\nfunction Card({ className, ...props }: React.ComponentProps<\"div\">) {\r\n  return (\r\n    <div\r\n      data-slot=\"card\"\r\n      className={cn(\r\n        \"bg-card text-card-foreground flex flex-col gap-6 rounded-xl border py-6 shadow-sm\",\r\n        className\r\n      )}\r\n      {...props}\r\n    />\r\n  )\r\n}\r\n\r\nfunction CardHeader({ className, ...props }: React.ComponentProps<\"div\">) {\r\n  return (\r\n    <div\r\n      data-slot=\"card-header\"\r\n      className={cn(\r\n        \"@container/card-header grid auto-rows-min grid-rows-[auto_auto] items-start gap-2 px-6 has-data-[slot=card-action]:grid-cols-[1fr_auto] [.border-b]:pb-6\",\r\n        className\r\n      )}\r\n      {...props}\r\n    />\r\n  )\r\n}\r\n\r\nfunction CardTitle({ className, ...props }: React.ComponentProps<\"div\">) {\r\n  return (\r\n    <div\r\n      data-slot=\"card-title\"\r\n      className={cn(\"leading-none font-semibold\", className)}\r\n      {...props}\r\n    />\r\n  )\r\n}\r\n\r\nfunction CardDescription({ className, ...props }: React.ComponentProps<\"div\">) {\r\n  return (\r\n    <div\r\n      data-slot=\"card-description\"\r\n      className={cn(\"text-muted-foreground text-sm\", className)}\r\n      {...props}\r\n    />\r\n  )\r\n}\r\n\r\nfunction CardAction({ className, ...props }: React.ComponentProps<\"div\">) {\r\n  return (\r\n    <div\r\n      data-slot=\"card-action\"\r\n      className={cn(\r\n        \"col-start-2 row-span-2 row-start-1 self-start justify-self-end\",\r\n        className\r\n      )}\r\n      {...props}\r\n    />\r\n  )\r\n}\r\n\r\nfunction CardContent({ className, ...props }: React.ComponentProps<\"div\">) {\r\n  return (\r\n    <div\r\n      data-slot=\"card-content\"\r\n      className={cn(\"px-6\", className)}\r\n      {...props}\r\n    />\r\n  )\r\n}\r\n\r\nfunction CardFooter({ className, ...props }: React.ComponentProps<\"div\">) {\r\n  return (\r\n    <div\r\n      data-slot=\"card-footer\"\r\n      className={cn(\"flex items-center px-6 [.border-t]:pt-6\", className)}\r\n      {...props}\r\n    />\r\n  )\r\n}\r\n\r\nexport {\r\n  Card,\r\n  CardHeader,\r\n  CardFooter,\r\n  CardTitle,\r\n  CardAction,\r\n  CardDescription,\r\n  CardContent,\r\n}\r\n"],"names":[],"mappings":";;;;;;;;;;;;;;;;;AAEA;;;AAEA,SAAS,KAAK,EAAE,SAAS,EAAE,GAAG,OAAoC;IAChE,qBACE,6LAAC;QACC,aAAU;QACV,WAAW,IAAA,qHAAE,EACX,qFACA;QAED,GAAG,KAAK;;;;;;AAGf;KAXS;AAaT,SAAS,WAAW,EAAE,SAAS,EAAE,GAAG,OAAoC;IACtE,qBACE,6LAAC;QACC,aAAU;QACV,WAAW,IAAA,qHAAE,EACX,4JACA;QAED,GAAG,KAAK;;;;;;AAGf;MAXS;AAaT,SAAS,UAAU,EAAE,SAAS,EAAE,GAAG,OAAoC;IACrE,qBACE,6LAAC;QACC,aAAU;QACV,WAAW,IAAA,qHAAE,EAAC,8BAA8B;QAC3C,GAAG,KAAK;;;;;;AAGf;MARS;AAUT,SAAS,gBAAgB,EAAE,SAAS,EAAE,GAAG,OAAoC;IAC3E,qBACE,6LAAC;QACC,aAAU;QACV,WAAW,IAAA,qHAAE,EAAC,iCAAiC;QAC9C,GAAG,KAAK;;;;;;AAGf;MARS;AAUT,SAAS,WAAW,EAAE,SAAS,EAAE,GAAG,OAAoC;IACtE,qBACE,6LAAC;QACC,aAAU;QACV,WAAW,IAAA,qHAAE,EACX,kEACA;QAED,GAAG,KAAK;;;;;;AAGf;MAXS;AAaT,SAAS,YAAY,EAAE,SAAS,EAAE,GAAG,OAAoC;IACvE,qBACE,6LAAC;QACC,aAAU;QACV,WAAW,IAAA,qHAAE,EAAC,QAAQ;QACrB,GAAG,KAAK;;;;;;AAGf;MARS;AAUT,SAAS,WAAW,EAAE,SAAS,EAAE,GAAG,OAAoC;IACtE,qBACE,6LAAC;QACC,aAAU;QACV,WAAW,IAAA,qHAAE,EAAC,2CAA2C;QACxD,GAAG,KAAK;;;;;;AAGf;MARS"}},
    {"offset": {"line": 124, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/Martin/Desktop/PROYECTOS/Tienda-Blama-2026/components/product-image-carousel.tsx"],"sourcesContent":["\"use client\"\r\n\r\nimport { useEffect, useMemo, useRef, useState } from \"react\"\r\nimport type { PointerEvent as ReactPointerEvent } from \"react\"\r\nimport Image from \"next/image\"\r\nimport { cn } from \"@/lib/utils\"\r\nimport { ChevronLeft, ChevronRight } from \"lucide-react\"\r\n\r\ninterface ProductImageCarouselProps {\r\n  images: string[]\r\n  alt: string\r\n  className?: string\r\n  autoPlay?: boolean\r\n  intervalMs?: number\r\n  showControls?: boolean\r\n  priority?: boolean\r\n  sizes?: string\r\n  quality?: number\r\n}\r\n\r\nexport function ProductImageCarousel({\r\n  images,\r\n  alt,\r\n  className,\r\n  autoPlay = false,\r\n  intervalMs = 2500,\r\n  showControls = true,\r\n  priority = false,\r\n  sizes,\r\n  quality,\r\n}: ProductImageCarouselProps) {\r\n  const isLikelyImageUrl = (url: string) => {\r\n    const u = String(url || \"\").trim().toLowerCase()\r\n    if (!u) return false\r\n    if (u.startsWith(\"data:\")) return u.startsWith(\"data:image/\")\r\n    return !(\r\n      u.endsWith(\".mp4\") ||\r\n      u.endsWith(\".webm\") ||\r\n      u.endsWith(\".mov\") ||\r\n      u.endsWith(\".m4v\") ||\r\n      u.endsWith(\".avi\") ||\r\n      u.endsWith(\".mkv\")\r\n    )\r\n  }\r\n\r\n  const cleanImages = useMemo(() => {\r\n    const unique: string[] = []\r\n    for (const img of images || []) {\r\n      const v = String(img || \"\").trim()\r\n      if (!v) continue\r\n      if (!isLikelyImageUrl(v)) continue\r\n      if (!unique.includes(v)) unique.push(v)\r\n      if (unique.length >= 10) break\r\n    }\r\n    return unique\r\n  }, [images])\r\n\r\n  const [index, setIndex] = useState(0)\r\n\r\n  const containerRef = useRef<HTMLDivElement | null>(null)\r\n  const [isDragging, setIsDragging] = useState(false)\r\n  const [dragX, setDragX] = useState(0)\r\n\r\n  const pointerIdRef = useRef<number | null>(null)\r\n  const pointerStartXRef = useRef<number | null>(null)\r\n  const pointerStartYRef = useRef<number | null>(null)\r\n  const pointerMovedRef = useRef(false)\r\n  const pointerLastXRef = useRef<number | null>(null)\r\n  const pointerLastTRef = useRef<number | null>(null)\r\n  const pointerVxRef = useRef(0)\r\n\r\n  useEffect(() => {\r\n    setIndex(0)\r\n    setDragX(0)\r\n    setIsDragging(false)\r\n  }, [cleanImages.join(\"|\")])\r\n\r\n  useEffect(() => {\r\n    if (!autoPlay) return\r\n    if (cleanImages.length <= 1) return\r\n    if (isDragging) return\r\n\r\n    const id = window.setInterval(() => {\r\n      setIndex((prev) => {\r\n        if (prev >= cleanImages.length - 1) return 0\r\n        return prev + 1\r\n      })\r\n    }, intervalMs)\r\n\r\n    return () => window.clearInterval(id)\r\n  }, [autoPlay, cleanImages.length, intervalMs, isDragging])\r\n\r\n  if (cleanImages.length === 0) return null\r\n\r\n  const lastIndex = Math.max(0, cleanImages.length - 1)\r\n\r\n  const rubberBand = (dx: number, width: number) => {\r\n    if (!width) return dx * 0.35\r\n    const constant = 0.55\r\n    const abs = Math.abs(dx)\r\n    const sign = dx < 0 ? -1 : 1\r\n    return sign * (width * constant * abs) / (width + constant * abs)\r\n  }\r\n\r\n  const prev = () => {\r\n    setDragX(0)\r\n    setIndex((i) => Math.max(0, i - 1))\r\n  }\r\n\r\n  const next = () => {\r\n    setDragX(0)\r\n    setIndex((i) => Math.min(lastIndex, i + 1))\r\n  }\r\n\r\n  const onPointerDown = (e: ReactPointerEvent<HTMLDivElement>) => {\r\n    if (cleanImages.length <= 1) return\r\n    pointerIdRef.current = e.pointerId\r\n    pointerStartXRef.current = e.clientX\r\n    pointerStartYRef.current = e.clientY\r\n    pointerLastXRef.current = e.clientX\r\n    pointerLastTRef.current = Date.now()\r\n    pointerVxRef.current = 0\r\n    pointerMovedRef.current = false\r\n    setIsDragging(true)\r\n    setDragX(0)\r\n    try {\r\n      e.currentTarget.setPointerCapture(e.pointerId)\r\n    } catch (err) {\r\n    }\r\n  }\r\n\r\n  const onPointerMove = (e: ReactPointerEvent<HTMLDivElement>) => {\r\n    const sx = pointerStartXRef.current\r\n    const sy = pointerStartYRef.current\r\n    if (sx == null || sy == null) return\r\n\r\n    const dx = e.clientX - sx\r\n    const dy = e.clientY - sy\r\n\r\n    // Solo consideramos swipe si el movimiento es mayormente horizontal.\r\n    if (Math.abs(dx) > 8 && Math.abs(dx) > Math.abs(dy)) {\r\n      pointerMovedRef.current = true\r\n      // Evita selección/drag de la imagen cuando se intenta deslizar.\r\n      if ((e as any).cancelable) e.preventDefault()\r\n\r\n      const now = Date.now()\r\n      const lx = pointerLastXRef.current\r\n      const lt = pointerLastTRef.current\r\n      if (lx != null && lt != null) {\r\n        const dt = Math.max(1, now - lt)\r\n        pointerVxRef.current = (e.clientX - lx) / dt\r\n      }\r\n      pointerLastXRef.current = e.clientX\r\n      pointerLastTRef.current = now\r\n\r\n      const width = containerRef.current?.getBoundingClientRect().width || 0\r\n      if (index === 0 && dx > 0) setDragX(rubberBand(dx, width))\r\n      else if (index === lastIndex && dx < 0) setDragX(rubberBand(dx, width))\r\n      else setDragX(dx)\r\n    }\r\n  }\r\n\r\n  const onPointerUp = (e: ReactPointerEvent<HTMLDivElement>) => {\r\n    const sx = pointerStartXRef.current\r\n    const sy = pointerStartYRef.current\r\n    const pid = pointerIdRef.current\r\n    pointerStartXRef.current = null\r\n    pointerStartYRef.current = null\r\n    pointerIdRef.current = null\r\n    setIsDragging(false)\r\n\r\n    if (sx == null || sy == null) return\r\n    if (!pointerMovedRef.current) {\r\n      setDragX(0)\r\n      if (pid != null) {\r\n        try {\r\n          e.currentTarget.releasePointerCapture(pid)\r\n        } catch (err) {\r\n        }\r\n      }\r\n      return\r\n    }\r\n\r\n    const dx = e.clientX - sx\r\n    const dy = e.clientY - sy\r\n\r\n    const width = containerRef.current?.getBoundingClientRect().width || 0\r\n    const distanceThreshold = Math.max(60, width * 0.18)\r\n    const velocity = pointerVxRef.current\r\n    const velocityThreshold = 0.7\r\n\r\n    const shouldSnapByVelocity = Math.abs(velocity) >= velocityThreshold && Math.abs(dx) >= 10\r\n    const shouldSnapByDistance = Math.abs(dx) >= distanceThreshold\r\n\r\n    if ((!shouldSnapByVelocity && !shouldSnapByDistance) || Math.abs(dx) < Math.abs(dy)) {\r\n      setDragX(0)\r\n      if (pid != null) {\r\n        try {\r\n          e.currentTarget.releasePointerCapture(pid)\r\n        } catch (err) {\r\n        }\r\n      }\r\n      return\r\n    }\r\n    const dir = shouldSnapByVelocity ? (velocity > 0 ? 1 : -1) : (dx > 0 ? 1 : -1)\r\n    if (dir > 0) prev()\r\n    else next()\r\n\r\n    setDragX(0)\r\n    if (pid != null) {\r\n      try {\r\n        e.currentTarget.releasePointerCapture(pid)\r\n      } catch (err) {\r\n      }\r\n    }\r\n  }\r\n\r\n  return (\r\n    <div\r\n      ref={containerRef}\r\n      className={cn(\"group relative h-full w-full overflow-hidden select-none touch-pan-y\", className)}\r\n      onPointerDown={onPointerDown}\r\n      onPointerMove={onPointerMove}\r\n      onPointerUp={onPointerUp}\r\n      onPointerCancel={onPointerUp}\r\n    >\r\n      <div\r\n        className={cn(\r\n          \"flex h-full w-full\",\r\n          isDragging ? \"\" : \"transition-transform duration-300 ease-out\"\r\n        )}\r\n        style={{\r\n          transform: `translate3d(calc(${-index * 100}% + ${dragX}px), 0, 0)`,\r\n        }}\r\n      >\r\n        {cleanImages.map((src, i) => (\r\n          <div key={src} className=\"relative h-full w-full flex-none\">\r\n            <Image\r\n              src={src}\r\n              alt={alt}\r\n              fill\r\n              className=\"absolute inset-0 object-cover\"\r\n              priority={priority && i === 0}\r\n              sizes={sizes || \"(max-width: 640px) 50vw, (max-width: 1024px) 33vw, 20vw\"}\r\n              quality={quality}\r\n              draggable={false}\r\n              unoptimized={true}\r\n            />\r\n\r\n          </div>\r\n        ))}\r\n      </div>\r\n\r\n      {showControls && cleanImages.length > 1 && (\r\n        <>\r\n          <button\r\n            type=\"button\"\r\n            aria-label=\"Imagen anterior\"\r\n            onClick={(e) => {\r\n              e.preventDefault()\r\n              e.stopPropagation()\r\n              prev()\r\n            }}\r\n            className=\"absolute left-2 top-1/2 -translate-y-1/2 h-10 w-10 rounded-full bg-background/85 backdrop-blur border border-border shadow-md flex items-center justify-center opacity-100 md:opacity-0 md:group-hover:opacity-100 focus-visible:opacity-100 transition-opacity\"\r\n          >\r\n            <ChevronLeft className=\"h-5 w-5\" />\r\n          </button>\r\n\r\n          <button\r\n            type=\"button\"\r\n            aria-label=\"Imagen siguiente\"\r\n            onClick={(e) => {\r\n              e.preventDefault()\r\n              e.stopPropagation()\r\n              next()\r\n            }}\r\n            className=\"absolute right-2 top-1/2 -translate-y-1/2 h-10 w-10 rounded-full bg-background/85 backdrop-blur border border-border shadow-md flex items-center justify-center opacity-100 md:opacity-0 md:group-hover:opacity-100 focus-visible:opacity-100 transition-opacity\"\r\n          >\r\n            <ChevronRight className=\"h-5 w-5\" />\r\n          </button>\r\n\r\n          <div className=\"absolute bottom-2 left-1/2 -translate-x-1/2 flex items-center gap-1.5 opacity-100 md:opacity-0 md:group-hover:opacity-100 transition-opacity\">\r\n            {cleanImages.map((_, dotIndex) => (\r\n              <button\r\n                key={dotIndex}\r\n                type=\"button\"\r\n                aria-label={`Ir a imagen ${dotIndex + 1}`}\r\n                onClick={(e) => {\r\n                  e.preventDefault()\r\n                  e.stopPropagation()\r\n                  setIndex(dotIndex)\r\n                  setDragX(0)\r\n                }}\r\n                className={cn(\r\n                  \"h-1.5 w-1.5 rounded-full\",\r\n                  dotIndex === index ? \"bg-primary\" : \"bg-foreground/30\"\r\n                )}\r\n              />\r\n            ))}\r\n          </div>\r\n        </>\r\n      )}\r\n    </div>\r\n  )\r\n}\r\n"],"names":[],"mappings":"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"}},
    {"offset": {"line": 438, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/Martin/Desktop/PROYECTOS/Tienda-Blama-2026/features/products/services/products.client.ts"],"sourcesContent":["import { supabase } from \"@/lib/supabaseClient\"\r\nimport type {\r\n    Category,\r\n    Product,\r\n    ProductSpecification,\r\n    ProductVariant,\r\n    ProductWithCategory,\r\n    SortValue,\r\n} from \"@/features/products/types\"\r\n\r\nexport async function listCategories(): Promise<Category[]> {\r\n    const { data, error } = await supabase.from(\"categorias\").select(\"*\").order(\"nombre\", { ascending: true })\r\n    if (error) {\r\n        console.error(\"Error fetching categories:\", error)\r\n        return []\r\n    }\r\n    return (data as Category[]) || []\r\n}\r\n\r\nexport type ListProductsParams = {\r\n    cat: string\r\n    q: string\r\n    sort: SortValue\r\n    min: string\r\n    max: string\r\n    stock: boolean\r\n    page: number\r\n    pageSize: number\r\n}\r\n\r\nexport type ListProductsResult = {\r\n    productos: Product[]\r\n    totalCount: number\r\n}\r\n\r\nexport async function listProducts(params: ListProductsParams): Promise<ListProductsResult> {\r\n    const q = (params.q || \"\").trim()\r\n    const min = params.min ? Number(params.min) : null\r\n    const max = params.max ? Number(params.max) : null\r\n\r\n    let productsQuery = supabase.from(\"productos\").select(\"*\", { count: \"exact\" })\r\n\r\n    if (params.cat !== \"all\") {\r\n        const categoryId = Number(params.cat)\r\n        if (Number.isFinite(categoryId) && categoryId > 0) {\r\n            productsQuery = productsQuery.eq(\"categoria_id\", categoryId)\r\n        } else {\r\n            const { data: catRow, error: catError } = await supabase\r\n                .from(\"categorias\")\r\n                .select(\"id\")\r\n                .eq(\"slug\", params.cat)\r\n                .maybeSingle()\r\n\r\n            if (!catError && catRow?.id) {\r\n                productsQuery = productsQuery.eq(\"categoria_id\", catRow.id)\r\n            }\r\n        }\r\n    }\r\n\r\n    if (q) {\r\n        productsQuery = productsQuery.ilike(\"nombre\", `%${q}%`)\r\n    }\r\n\r\n    if (min !== null && Number.isFinite(min)) {\r\n        productsQuery = productsQuery.gte(\"precio\", min)\r\n    }\r\n\r\n    if (max !== null && Number.isFinite(max)) {\r\n        productsQuery = productsQuery.lte(\"precio\", max)\r\n    }\r\n\r\n    if (params.stock) {\r\n        productsQuery = productsQuery.gt(\"stock\", 0)\r\n    }\r\n\r\n    if (params.sort === \"price-asc\") productsQuery = productsQuery.order(\"precio\", { ascending: true })\r\n    if (params.sort === \"price-desc\") productsQuery = productsQuery.order(\"precio\", { ascending: false })\r\n    if (params.sort === \"name-asc\") productsQuery = productsQuery.order(\"nombre\", { ascending: true })\r\n    if (params.sort === \"name-desc\") productsQuery = productsQuery.order(\"nombre\", { ascending: false })\r\n    if (params.sort === \"newest\") productsQuery = productsQuery.order(\"created_at\", { ascending: false })\r\n\r\n    const from = Math.max(0, (params.page - 1) * params.pageSize)\r\n    const to = Math.max(from, from + params.pageSize - 1)\r\n    productsQuery = productsQuery.range(from, to)\r\n\r\n    const { data, error, count } = await productsQuery\r\n\r\n    if (error) {\r\n        console.error(\"Error fetching products:\", error)\r\n        return { productos: [], totalCount: 0 }\r\n    }\r\n\r\n    return {\r\n        productos: (data as Product[]) || [],\r\n        totalCount: Number(count || 0),\r\n    }\r\n}\r\n\r\nexport type CountProductsParams = {\r\n    cat: string\r\n    q: string\r\n    min: string\r\n    max: string\r\n    stock: boolean\r\n}\r\n\r\nexport async function countProducts(params: CountProductsParams): Promise<number | null> {\r\n    const q = (params.q || \"\").trim()\r\n    const min = params.min ? Number(params.min) : null\r\n    const max = params.max ? Number(params.max) : null\r\n\r\n    let countQuery = supabase.from(\"productos\").select(\"id\", { count: \"exact\", head: true })\r\n\r\n    if (params.cat !== \"all\") {\r\n        const categoryId = Number(params.cat)\r\n        if (Number.isFinite(categoryId) && categoryId > 0) {\r\n            countQuery = countQuery.eq(\"categoria_id\", categoryId)\r\n        } else {\r\n            const { data: catRow, error: catError } = await supabase\r\n                .from(\"categorias\")\r\n                .select(\"id\")\r\n                .eq(\"slug\", params.cat)\r\n                .maybeSingle()\r\n\r\n            if (!catError && catRow?.id) {\r\n                countQuery = countQuery.eq(\"categoria_id\", catRow.id)\r\n            }\r\n        }\r\n    }\r\n\r\n    if (q) {\r\n        countQuery = countQuery.ilike(\"nombre\", `%${q}%`)\r\n    }\r\n\r\n    if (min !== null && Number.isFinite(min)) {\r\n        countQuery = countQuery.gte(\"precio\", min)\r\n    }\r\n\r\n    if (max !== null && Number.isFinite(max)) {\r\n        countQuery = countQuery.lte(\"precio\", max)\r\n    }\r\n\r\n    if (params.stock) {\r\n        countQuery = countQuery.gt(\"stock\", 0)\r\n    }\r\n\r\n    const { count, error } = await countQuery\r\n    if (error) {\r\n        console.error(\"Error fetching draft count:\", error)\r\n        return null\r\n    }\r\n\r\n    return Number(count || 0)\r\n}\r\n\r\nexport type ProductDetailResult = {\r\n    producto: ProductWithCategory | null\r\n    variantes: ProductVariant[]\r\n    especificaciones: ProductSpecification[]\r\n}\r\n\r\nexport async function getProductDetail(productId: number): Promise<ProductDetailResult> {\r\n    const [prodRes, variantsRes, specsRes] = await Promise.all([\r\n        supabase.from(\"productos\").select(`*, categorias (id, nombre, slug)`).eq(\"id\", productId).single(),\r\n        supabase\r\n            .from(\"producto_variantes\")\r\n            .select(\"*\")\r\n            .eq(\"producto_id\", productId)\r\n            .eq(\"activo\", true)\r\n            .order(\"id\", { ascending: true }),\r\n        supabase\r\n            .from(\"producto_especificaciones\")\r\n            .select(\"*\")\r\n            .eq(\"producto_id\", productId)\r\n            .order(\"orden\", { ascending: true })\r\n            .order(\"id\", { ascending: true }),\r\n    ])\r\n\r\n    const { data, error } = prodRes\r\n\r\n    const producto = error ? null : ((data as ProductWithCategory) || null)\r\n\r\n    const variantes = Array.isArray(variantsRes.data) ? (variantsRes.data as ProductVariant[]) : []\r\n    const especificaciones = Array.isArray(specsRes.data)\r\n        ? (specsRes.data as ProductSpecification[])\r\n        : []\r\n\r\n    if (error) {\r\n        console.error(\"Error fetching producto:\", error)\r\n    }\r\n\r\n    return {\r\n        producto,\r\n        variantes,\r\n        especificaciones,\r\n    }\r\n}\r\n\r\nexport async function getRecommendedProducts(excludeId: number): Promise<any[]> {\r\n    try {\r\n        const { data: topData, error: topError } = await supabase.rpc(\"get_top_products\", {\r\n            limit_count: 8,\r\n            exclude_id: excludeId,\r\n        })\r\n\r\n        if (!topError && Array.isArray(topData)) {\r\n            return topData\r\n        }\r\n\r\n        const { data: recentData, error: recentError } = await supabase\r\n            .from(\"productos\")\r\n            .select(\"*\")\r\n            .neq(\"id\", excludeId)\r\n            .gt(\"stock\", 0)\r\n            .order(\"created_at\", { ascending: false })\r\n            .limit(8)\r\n\r\n        if (!recentError && Array.isArray(recentData)) {\r\n            return recentData\r\n        }\r\n\r\n        return []\r\n    } catch (err) {\r\n        return []\r\n    }\r\n}\r\n"],"names":[],"mappings":"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"}},
    {"offset": {"line": 613, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/Martin/Desktop/PROYECTOS/Tienda-Blama-2026/components/product-card.tsx"],"sourcesContent":["\r\n\"use client\"\r\n\r\nimport Link from \"next/link\"\r\nimport { Button } from \"@/components/ui/button\"\r\nimport { Card, CardContent, CardFooter } from \"@/components/ui/card\"\r\nimport { Plus, Image as ImageIcon } from \"lucide-react\"\r\nimport { formatCurrency, slugify } from \"@/lib/utils\"\r\nimport { Database } from \"@/types/database.types\"\r\nimport { useCartStore } from \"@/features/cart\"\r\nimport { useState, useRef } from \"react\"\r\nimport { ProductImageCarousel } from \"@/components/product-image-carousel\"\r\nimport { useCartAnimationStore } from \"@/features/cart/cart-animation\"\r\n\r\ntype Product = Database['public']['Tables']['productos']['Row']\r\n\r\ninterface ProductCardProps {\r\n    product: Product\r\n    imagePriority?: boolean\r\n}\r\n\r\nexport function ProductCard({ product, imagePriority = false }: ProductCardProps) {\r\n    const addItem = useCartStore((state) => state.addItem)\r\n    const startAnimation = useCartAnimationStore((state) => state.startAnimation)\r\n    const imageRef = useRef<HTMLDivElement>(null)\r\n    const [isAdded, setIsAdded] = useState(false)\r\n\r\n    const currentPrice = Number((product as any)?.precio ?? 0)\r\n    const beforePrice = Number((product as any)?.precio_antes ?? 0)\r\n    const hasSale = Number.isFinite(beforePrice) && beforePrice > 0 && Number.isFinite(currentPrice) && currentPrice > 0 && beforePrice > currentPrice\r\n    const discountPercent = hasSale ? Math.round((1 - currentPrice / beforePrice) * 100) : 0\r\n\r\n    const images = (\r\n        (Array.isArray((product as any).imagenes) ? ((product as any).imagenes as string[]) : [])\r\n            .filter(Boolean)\r\n            .filter((u) => {\r\n                const s = String(u || '').toLowerCase()\r\n                return !(s.endsWith('.mp4') || s.endsWith('.webm') || s.endsWith('.mov') || s.endsWith('.m4v'))\r\n            })\r\n            .slice(0, 10)\r\n    )\r\n    const fallbackImages = images.length > 0 ? images : product.imagen_url ? [product.imagen_url] : []\r\n\r\n    const handleAddToCart = (e: React.MouseEvent) => {\r\n        e.preventDefault() // Link wrapper might trigger navigation if we are not careful, but Button handles click.\r\n\r\n        addItem(product)\r\n\r\n        if (imageRef.current && fallbackImages.length > 0) {\r\n            const rect = imageRef.current.getBoundingClientRect()\r\n            startAnimation(fallbackImages[0], rect)\r\n        }\r\n\r\n        // Feedback visual simple\r\n        setIsAdded(true)\r\n        setTimeout(() => setIsAdded(false), 1000)\r\n    }\r\n\r\n    const productHref = `/productos/${slugify(product.nombre)}-${product.id}`\r\n\r\n    return (\r\n        <Card className=\"group overflow-hidden border-none shadow-sm hover:shadow-md transition-all duration-300 bg-card flex flex-col rounded-xl\">\r\n            <Link href={productHref} className=\"block\">\r\n                <div className=\"aspect-square bg-popover relative overflow-hidden\" ref={imageRef}>\r\n                    {fallbackImages.length > 0 ? (\r\n                        <ProductImageCarousel\r\n                            images={fallbackImages}\r\n                            alt={product.nombre}\r\n                            className=\"group-hover:scale-105 transition-transform duration-300\"\r\n                            autoPlay\r\n                            intervalMs={2500}\r\n                            priority={imagePriority}\r\n                            sizes=\"(max-width: 640px) 50vw, (max-width: 1024px) 33vw, 20vw\"\r\n                            quality={70}\r\n                        />\r\n                    ) : (\r\n                        <div className=\"absolute inset-0 flex items-center justify-center text-muted-foreground group-hover:scale-110 transition-transform duration-300\">\r\n                            <ImageIcon className=\"h-10 w-10 opacity-50\" />\r\n                        </div>\r\n                    )}\r\n                    {/* Quick Action Overlay */}\r\n                    <div className=\"absolute inset-0 bg-foreground/5 opacity-0 group-hover:opacity-100 transition-opacity\" />\r\n\r\n                    {hasSale && (\r\n                        <div className=\"absolute left-2 top-2 flex items-center gap-2\">\r\n                            <span className=\"inline-flex items-center rounded-full bg-gradient-to-r from-rose-600 to-orange-500 px-2.5 py-1 text-xs font-extrabold text-white shadow-md ring-1 ring-white/30 backdrop-blur\">\r\n                                -{discountPercent}%\r\n                            </span>\r\n                        </div>\r\n                    )}\r\n                </div>\r\n            </Link>\r\n\r\n            <CardContent className=\"p-3 flex-1 flex flex-col justify-between\">\r\n                <div>\r\n                    <Link href={productHref} className=\"hover:underline\">\r\n                        <h4 className=\"font-medium text-sm line-clamp-2 leading-tight mb-1 text-foreground\">{product.nombre}</h4>\r\n                    </Link>\r\n                </div>\r\n                <div className=\"mt-1\" data-nosnippet>\r\n                    <div className=\"flex items-baseline gap-2\">\r\n                        <p className=\"text-lg font-extrabold text-primary tracking-tight\">{formatCurrency(currentPrice)}</p>\r\n                        {hasSale && (\r\n                            <div className=\"flex items-baseline gap-2\">\r\n                                <p className=\"text-sm text-muted-foreground line-through\">{formatCurrency(beforePrice)}</p>\r\n                            </div>\r\n                        )}\r\n                    </div>\r\n                </div>\r\n            </CardContent>\r\n\r\n            <CardFooter className=\"p-3 pt-0\">\r\n                <Button\r\n                    onClick={handleAddToCart}\r\n                    className={`w-full h-9 font-semibold rounded-lg transition-all shadow-sm flex items-center justify-center gap-2 ${isAdded ? 'bg-green-600 hover:bg-green-700' : 'bg-primary text-primary-foreground hover:bg-primary/90'}`}\r\n                >\r\n                    {isAdded ? (\r\n                        <span>¡Agregado!</span>\r\n                    ) : (\r\n                        <>\r\n                            <Plus className=\"h-4 w-4\" />\r\n                            <span>Agregar</span>\r\n                        </>\r\n                    )}\r\n                </Button>\r\n            </CardFooter>\r\n        </Card>\r\n    )\r\n}\r\n"],"names":[],"mappings":"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"}},
    {"offset": {"line": 881, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/Martin/Desktop/PROYECTOS/Tienda-Blama-2026/components/ui/textarea.tsx"],"sourcesContent":["import * as React from \"react\"\r\n\r\nimport { cn } from \"@/lib/utils\"\r\n\r\nfunction Textarea({ className, ...props }: React.ComponentProps<\"textarea\">) {\r\n  return (\r\n    <textarea\r\n      data-slot=\"textarea\"\r\n      className={cn(\r\n        \"border-input placeholder:text-muted-foreground focus-visible:border-ring focus-visible:ring-ring/50 aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive dark:bg-input/30 flex field-sizing-content min-h-16 w-full rounded-md border bg-transparent px-3 py-2 text-base shadow-xs transition-[color,box-shadow] outline-none focus-visible:ring-[3px] disabled:cursor-not-allowed disabled:opacity-50 md:text-sm\",\r\n        className\r\n      )}\r\n      {...props}\r\n    />\r\n  )\r\n}\r\n\r\nexport { Textarea }\r\n"],"names":[],"mappings":";;;;;AAEA;;;AAEA,SAAS,SAAS,EAAE,SAAS,EAAE,GAAG,OAAyC;IACzE,qBACE,6LAAC;QACC,aAAU;QACV,WAAW,IAAA,qHAAE,EACX,ucACA;QAED,GAAG,KAAK;;;;;;AAGf;KAXS"}},
    {"offset": {"line": 911, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/Martin/Desktop/PROYECTOS/Tienda-Blama-2026/components/ui/badge.tsx"],"sourcesContent":["import * as React from \"react\"\r\nimport { Slot } from \"@radix-ui/react-slot\"\r\nimport { cva, type VariantProps } from \"class-variance-authority\"\r\n\r\nimport { cn } from \"@/lib/utils\"\r\n\r\nconst badgeVariants = cva(\r\n  \"inline-flex items-center justify-center rounded-full border px-2 py-0.5 text-xs font-medium w-fit whitespace-nowrap shrink-0 [&>svg]:size-3 gap-1 [&>svg]:pointer-events-none focus-visible:border-ring focus-visible:ring-ring/50 focus-visible:ring-[3px] aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive transition-[color,box-shadow] overflow-hidden\",\r\n  {\r\n    variants: {\r\n      variant: {\r\n        default:\r\n          \"border-transparent bg-primary text-primary-foreground [a&]:hover:bg-primary/90\",\r\n        secondary:\r\n          \"border-transparent bg-secondary text-secondary-foreground [a&]:hover:bg-secondary/90\",\r\n        destructive:\r\n          \"border-transparent bg-destructive text-white [a&]:hover:bg-destructive/90 focus-visible:ring-destructive/20 dark:focus-visible:ring-destructive/40 dark:bg-destructive/60\",\r\n        outline:\r\n          \"text-foreground [a&]:hover:bg-accent [a&]:hover:text-accent-foreground\",\r\n      },\r\n    },\r\n    defaultVariants: {\r\n      variant: \"default\",\r\n    },\r\n  }\r\n)\r\n\r\nfunction Badge({\r\n  className,\r\n  variant,\r\n  asChild = false,\r\n  ...props\r\n}: React.ComponentProps<\"span\"> &\r\n  VariantProps<typeof badgeVariants> & { asChild?: boolean }) {\r\n  const Comp = asChild ? Slot : \"span\"\r\n\r\n  return (\r\n    <Comp\r\n      data-slot=\"badge\"\r\n      className={cn(badgeVariants({ variant }), className)}\r\n      {...props}\r\n    />\r\n  )\r\n}\r\n\r\nexport { Badge, badgeVariants }\r\n"],"names":[],"mappings":";;;;;;;AACA;AACA;AAEA;;;;;AAEA,MAAM,gBAAgB,IAAA,0KAAG,EACvB,oZACA;IACE,UAAU;QACR,SAAS;YACP,SACE;YACF,WACE;YACF,aACE;YACF,SACE;QACJ;IACF;IACA,iBAAiB;QACf,SAAS;IACX;AACF;AAGF,SAAS,MAAM,EACb,SAAS,EACT,OAAO,EACP,UAAU,KAAK,EACf,GAAG,OAEuD;IAC1D,MAAM,OAAO,UAAU,2KAAI,GAAG;IAE9B,qBACE,6LAAC;QACC,aAAU;QACV,WAAW,IAAA,qHAAE,EAAC,cAAc;YAAE;QAAQ,IAAI;QACzC,GAAG,KAAK;;;;;;AAGf;KAhBS"}},
    {"offset": {"line": 963, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/Martin/Desktop/PROYECTOS/Tienda-Blama-2026/components/product-social-proof.tsx"],"sourcesContent":["\"use client\"\r\n\r\nimport { useEffect, useMemo, useRef, useState } from \"react\"\r\nimport { supabase } from \"@/lib/supabaseClient\"\r\nimport { Card, CardContent } from \"@/components/ui/card\"\r\nimport { Button } from \"@/components/ui/button\"\r\nimport { Input } from \"@/components/ui/input\"\r\nimport { Textarea } from \"@/components/ui/textarea\"\r\nimport { Label } from \"@/components/ui/label\"\r\nimport { Badge } from \"@/components/ui/badge\"\r\nimport { Star } from \"lucide-react\"\r\n\r\ntype ReviewRow = {\r\n  id: number\r\n  rating: number\r\n  title: string | null\r\n  body: string\r\n  customer_name: string | null\r\n  customer_city: string | null\r\n  verified: boolean\r\n  created_at: string\r\n  photo_urls: string[] | null\r\n}\r\n\r\ntype QuestionRow = {\r\n  id: number\r\n  question: string\r\n  asker_name: string | null\r\n  created_at: string\r\n  product_answers?: { id: number; answer: string; answered_by: string | null; created_at: string }[]\r\n}\r\n\r\nfunction Stars({ value }: { value: number }) {\r\n  const v = Math.max(0, Math.min(5, Math.round(value)))\r\n  return (\r\n    <div className=\"flex items-center gap-0.5\">\r\n      {Array.from({ length: 5 }).map((_, i) => (\r\n        <Star\r\n          key={i}\r\n          className={\"h-4 w-4 \" + (i < v ? \"fill-yellow-400 text-yellow-400\" : \"text-muted-foreground\")}\r\n        />\r\n      ))}\r\n    </div>\r\n  )\r\n}\r\n\r\nexport function ProductSocialProof({ productId, section = 'all' }: { productId: number; section?: 'reviews' | 'questions' | 'all' }) {\r\n  const [loading, setLoading] = useState(true)\r\n  const [reviews, setReviews] = useState<ReviewRow[]>([])\r\n  const [questions, setQuestions] = useState<QuestionRow[]>([])\r\n\r\n  // ... (keep state exactly as is)\r\n\r\n  const [showReviewForm, setShowReviewForm] = useState(false)\r\n  const [showQuestionForm, setShowQuestionForm] = useState(false)\r\n\r\n  const [reviewRating, setReviewRating] = useState(5)\r\n  const [reviewTitle, setReviewTitle] = useState(\"\")\r\n  const [reviewBody, setReviewBody] = useState(\"\")\r\n  const [reviewName, setReviewName] = useState(\"\")\r\n  const [reviewCity, setReviewCity] = useState(\"\")\r\n  const [reviewOrderId, setReviewOrderId] = useState(\"\")\r\n  const [reviewDni, setReviewDni] = useState(\"\")\r\n  const [reviewPhone, setReviewPhone] = useState(\"\")\r\n  const [reviewFiles, setReviewFiles] = useState<File[]>([])\r\n  const [sendingReview, setSendingReview] = useState(false)\r\n  const [reviewSent, setReviewSent] = useState<string | null>(null)\r\n\r\n  const [qText, setQText] = useState(\"\")\r\n  const [qName, setQName] = useState(\"\")\r\n  const [qPhone, setQPhone] = useState(\"\")\r\n  const [sendingQ, setSendingQ] = useState(false)\r\n  const [qSent, setQSent] = useState<string | null>(null)\r\n\r\n  const refetch = useRef<(() => Promise<void>) | null>(null)\r\n\r\n  const stats = useMemo(() => {\r\n    const count = reviews.length\r\n    const avg = count === 0 ? 0 : reviews.reduce((acc, r) => acc + Number(r.rating || 0), 0) / count\r\n    return { count, avg }\r\n  }, [reviews])\r\n\r\n  useEffect(() => {\r\n    let cancelled = false\r\n\r\n    async function load() {\r\n      setLoading(true)\r\n\r\n      // Only fetch what we need if we wanted to optimize, but typically fetching both is fine as they are related.\r\n      // However, if section is specific, arguably we could only fetch that table.\r\n      // For simplicity and avoiding large logic changes, we fetch both.\r\n      const [reviewsRes, questionsRes] = await Promise.all([\r\n        supabase\r\n          .from(\"product_reviews\")\r\n          .select(\"id, rating, title, body, customer_name, customer_city, verified, created_at, photo_urls\")\r\n          .eq(\"product_id\", productId)\r\n          .eq(\"approved\", true)\r\n          .order(\"created_at\", { ascending: false })\r\n          .limit(20),\r\n        supabase\r\n          .from(\"product_questions\")\r\n          .select(\"id, question, asker_name, created_at, product_answers(id, answer, answered_by, created_at)\")\r\n          .eq(\"product_id\", productId)\r\n          .eq(\"published\", true)\r\n          .order(\"created_at\", { ascending: false })\r\n          .limit(30),\r\n      ])\r\n\r\n      if (cancelled) return\r\n\r\n      setReviews((reviewsRes.data as any[]) as ReviewRow[] || [])\r\n      setQuestions((questionsRes.data as any[]) as QuestionRow[] || [])\r\n      setLoading(false)\r\n    }\r\n\r\n    refetch.current = load\r\n    load()\r\n\r\n    return () => {\r\n      cancelled = true\r\n    }\r\n  }, [productId])\r\n\r\n  // ... (keep submit functions exactly as is)\r\n\r\n  async function submitReview() {\r\n    if (!reviewBody.trim() || reviewBody.trim().length < 10) {\r\n      setReviewSent(\"Escribe una reseña más larga\")\r\n      return\r\n    }\r\n\r\n    setSendingReview(true)\r\n    setReviewSent(null)\r\n\r\n    try {\r\n      const fd = new FormData()\r\n      fd.set(\"productId\", String(productId))\r\n      fd.set(\"rating\", String(reviewRating))\r\n      fd.set(\"title\", reviewTitle)\r\n      fd.set(\"body\", reviewBody)\r\n      fd.set(\"customerName\", reviewName)\r\n      fd.set(\"customerCity\", reviewCity)\r\n      fd.set(\"orderId\", reviewOrderId)\r\n      fd.set(\"dni\", reviewDni)\r\n      fd.set(\"phone\", reviewPhone)\r\n\r\n      reviewFiles.slice(0, 3).forEach((f) => fd.append(\"photos\", f))\r\n\r\n      const res = await fetch(\"/api/reviews/submit\", {\r\n        method: \"POST\",\r\n        body: fd,\r\n      })\r\n\r\n      const json = await res.json().catch(() => null)\r\n      if (!res.ok) {\r\n        throw new Error(String(json?.error || \"No se pudo enviar la reseña\"))\r\n      }\r\n\r\n      setReviewTitle(\"\")\r\n      setReviewBody(\"\")\r\n      setReviewFiles([])\r\n\r\n      const verified = Boolean(json?.verified)\r\n      setReviewSent(\r\n        verified\r\n          ? \"Reseña enviada. Se marcará como comprador verificado cuando sea aprobada.\"\r\n          : \"Reseña enviada. Se publicará cuando sea aprobada.\"\r\n      )\r\n\r\n      setShowReviewForm(false)\r\n\r\n      await refetch.current?.()\r\n    } catch (e: any) {\r\n      setReviewSent(e?.message || \"Error enviando reseña\")\r\n    } finally {\r\n      setSendingReview(false)\r\n    }\r\n  }\r\n\r\n  async function submitQuestion() {\r\n    if (!qText.trim() || qText.trim().length < 8) {\r\n      setQSent(\"Escribe una pregunta más específica\")\r\n      return\r\n    }\r\n\r\n    setSendingQ(true)\r\n    setQSent(null)\r\n\r\n    try {\r\n      const res = await fetch(\"/api/questions/submit\", {\r\n        method: \"POST\",\r\n        headers: { \"Content-Type\": \"application/json\" },\r\n        body: JSON.stringify({ productId, question: qText, askerName: qName, askerPhone: qPhone }),\r\n      })\r\n\r\n      const json = await res.json().catch(() => null)\r\n      if (!res.ok) {\r\n        throw new Error(String(json?.error || \"No se pudo enviar la pregunta\"))\r\n      }\r\n\r\n      setQText(\"\")\r\n      setQSent(\"Pregunta enviada. Se publicará cuando sea respondida/aprobada.\")\r\n\r\n      setShowQuestionForm(false)\r\n    } catch (e: any) {\r\n      setQSent(e?.message || \"Error enviando pregunta\")\r\n    } finally {\r\n      setSendingQ(false)\r\n    }\r\n  }\r\n\r\n  const showReviews = section === 'all' || section === 'reviews'\r\n  const showQuestions = section === 'all' || section === 'questions'\r\n\r\n  return (\r\n    <div className=\"space-y-6\">\r\n      {showReviews && (\r\n        <div className=\"space-y-4\">\r\n          <div className=\"flex items-start justify-between gap-4\">\r\n            <div>\r\n              <div className=\"text-lg font-bold\">Reseñas</div>\r\n              <div className=\"mt-1 flex items-center gap-2 text-sm\">\r\n                <Stars value={stats.avg} />\r\n                <span className=\"text-muted-foreground\">\r\n                  {stats.count > 0 ? `${stats.avg.toFixed(1)} (${stats.count} reseñas)` : \"Aún no hay reseñas\"}\r\n                </span>\r\n              </div>\r\n            </div>\r\n            <Badge variant=\"secondary\">Sin cuenta</Badge>\r\n          </div>\r\n\r\n          {loading ? (\r\n            <div className=\"text-sm text-muted-foreground\">Cargando reseñas...</div>\r\n          ) : reviews.length === 0 ? (\r\n            <div className=\"text-sm text-muted-foreground\">Sé el primero en dejar una reseña.</div>\r\n          ) : (\r\n            <div className=\"space-y-4\">\r\n              {reviews.map((r) => (\r\n                <div key={r.id} className=\"rounded-xl border bg-card p-4\">\r\n                  <div className=\"flex items-start justify-between gap-3\">\r\n                    <div className=\"space-y-1\">\r\n                      <div className=\"flex items-center gap-2\">\r\n                        <Stars value={r.rating} />\r\n                        {r.verified ? <Badge>Comprador verificado</Badge> : <Badge variant=\"outline\">Cliente</Badge>}\r\n                      </div>\r\n                      <div className=\"text-sm font-semibold\">{r.title || \"Reseña\"}</div>\r\n                      <div className=\"text-sm text-muted-foreground whitespace-pre-line\">{r.body}</div>\r\n                    </div>\r\n                    <div className=\"text-xs text-muted-foreground text-right\">\r\n                      <div>{r.customer_name || \"\"}</div>\r\n                      <div>{r.customer_city || \"\"}</div>\r\n                      <div>{new Date(r.created_at).toLocaleDateString()}</div>\r\n                    </div>\r\n                  </div>\r\n\r\n                  {Array.isArray(r.photo_urls) && r.photo_urls.length > 0 ? (\r\n                    <div className=\"mt-3 flex gap-2 overflow-x-auto\">\r\n                      {r.photo_urls.slice(0, 6).map((u, idx) => (\r\n                        <img\r\n                          key={idx}\r\n                          src={u}\r\n                          alt=\"Foto del cliente\"\r\n                          className=\"h-20 w-20 rounded-lg border object-cover\"\r\n                          loading=\"lazy\"\r\n                        />\r\n                      ))}\r\n                    </div>\r\n                  ) : null}\r\n                </div>\r\n              ))}\r\n            </div>\r\n          )}\r\n\r\n          <div className=\"pt-2 border-t space-y-3\">\r\n            <div className=\"flex items-center justify-between gap-3\">\r\n              <div className=\"text-sm font-semibold\">Dejar una reseña</div>\r\n              {!showReviewForm ? (\r\n                <Button\r\n                  type=\"button\"\r\n                  variant=\"outline\"\r\n                  onClick={() => {\r\n                    setReviewSent(null)\r\n                    setShowReviewForm(true)\r\n                  }}\r\n                >\r\n                  Añadir reseña\r\n                </Button>\r\n              ) : (\r\n                <Button type=\"button\" variant=\"outline\" onClick={() => setShowReviewForm(false)}>\r\n                  Cancelar\r\n                </Button>\r\n              )}\r\n            </div>\r\n\r\n            {reviewSent ? <div className=\"text-sm text-muted-foreground\">{reviewSent}</div> : null}\r\n\r\n            {showReviewForm ? (\r\n              <div className=\"space-y-3\">\r\n                <div className=\"flex items-center gap-2\">\r\n                  {Array.from({ length: 5 }).map((_, i) => {\r\n                    const v = i + 1\r\n                    const active = v <= reviewRating\r\n                    return (\r\n                      <button\r\n                        key={v}\r\n                        type=\"button\"\r\n                        onClick={() => setReviewRating(v)}\r\n                        className=\"rounded-md p-1\"\r\n                        aria-label={`Puntaje ${v}`}\r\n                      >\r\n                        <Star\r\n                          className={\r\n                            \"h-5 w-5 \" + (active ? \"fill-yellow-400 text-yellow-400\" : \"text-muted-foreground\")\r\n                          }\r\n                        />\r\n                      </button>\r\n                    )\r\n                  })}\r\n                </div>\r\n\r\n                <div className=\"grid grid-cols-1 md:grid-cols-2 gap-3\">\r\n                  <div className=\"space-y-1\">\r\n                    <Label>Tu nombre (opcional)</Label>\r\n                    <Input value={reviewName} onChange={(e) => setReviewName(e.target.value)} placeholder=\"Ej: Juan\" />\r\n                  </div>\r\n                  <div className=\"space-y-1\">\r\n                    <Label>Ciudad (opcional)</Label>\r\n                    <Input value={reviewCity} onChange={(e) => setReviewCity(e.target.value)} placeholder=\"Ej: Lima\" />\r\n                  </div>\r\n                  <div className=\"space-y-1 md:col-span-2\">\r\n                    <Label>Título (opcional)</Label>\r\n                    <Input\r\n                      value={reviewTitle}\r\n                      onChange={(e) => setReviewTitle(e.target.value)}\r\n                      placeholder=\"Ej: Excelente calidad\"\r\n                    />\r\n                  </div>\r\n                  <div className=\"space-y-1 md:col-span-2\">\r\n                    <Label>Tu reseña</Label>\r\n                    <Textarea\r\n                      value={reviewBody}\r\n                      onChange={(e) => setReviewBody(e.target.value)}\r\n                      placeholder=\"Cuéntanos tu experiencia...\"\r\n                    />\r\n                  </div>\r\n                </div>\r\n\r\n                <div className=\"rounded-xl border bg-popover p-4 space-y-2\">\r\n                  <div className=\"text-sm font-semibold\">Comprador verificado (opcional)</div>\r\n                  <div className=\"text-xs text-muted-foreground\">\r\n                    Si tienes tu número de pedido, ingrésalo junto con tu DNI y teléfono para marcar la reseña como verificada.\r\n                  </div>\r\n\r\n                  <div className=\"grid grid-cols-1 md:grid-cols-3 gap-3\">\r\n                    <div className=\"space-y-1\">\r\n                      <Label>Pedido ID</Label>\r\n                      <Input value={reviewOrderId} onChange={(e) => setReviewOrderId(e.target.value)} placeholder=\"Ej: 123\" />\r\n                    </div>\r\n                    <div className=\"space-y-1\">\r\n                      <Label>DNI</Label>\r\n                      <Input value={reviewDni} onChange={(e) => setReviewDni(e.target.value)} placeholder=\"12345678\" />\r\n                    </div>\r\n                    <div className=\"space-y-1\">\r\n                      <Label>Teléfono</Label>\r\n                      <Input value={reviewPhone} onChange={(e) => setReviewPhone(e.target.value)} placeholder=\"999999999\" />\r\n                    </div>\r\n                  </div>\r\n                </div>\r\n\r\n                <div className=\"space-y-2\">\r\n                  <Label>Fotos (opcional, máx 3)</Label>\r\n                  <Input\r\n                    type=\"file\"\r\n                    accept=\"image/*\"\r\n                    multiple\r\n                    onChange={(e) => {\r\n                      const list = Array.from(e.target.files || [])\r\n                      setReviewFiles(list.slice(0, 3))\r\n                    }}\r\n                  />\r\n                  <div className=\"text-xs text-muted-foreground\">Las fotos se subirán cuando envíes la reseña.</div>\r\n                </div>\r\n\r\n                <Button type=\"button\" onClick={submitReview} disabled={sendingReview} className=\"w-full md:w-auto\">\r\n                  {sendingReview ? \"Enviando...\" : \"Enviar reseña\"}\r\n                </Button>\r\n              </div>\r\n            ) : null}\r\n          </div>\r\n        </div>\r\n      )\r\n      }\r\n\r\n      {\r\n        showQuestions && (\r\n          <div className=\"space-y-4\">\r\n            <div className=\"flex items-start justify-between gap-4\">\r\n              <div>\r\n                <div className=\"text-lg font-bold\">Preguntas y respuestas</div>\r\n                <div className=\"text-sm text-muted-foreground\">Resuelve dudas antes de comprar</div>\r\n              </div>\r\n              <Badge variant=\"secondary\">Sin cuenta</Badge>\r\n            </div>\r\n\r\n            {loading ? (\r\n              <div className=\"text-sm text-muted-foreground\">Cargando preguntas...</div>\r\n            ) : questions.length === 0 ? (\r\n              <div className=\"text-sm text-muted-foreground\">Aún no hay preguntas publicadas.</div>\r\n            ) : (\r\n              <div className=\"space-y-3\">\r\n                {questions.map((q) => (\r\n                  <div key={q.id} className=\"rounded-xl border bg-card p-4\">\r\n                    <div className=\"text-sm font-semibold\">{q.question}</div>\r\n                    <div className=\"mt-1 text-xs text-muted-foreground\">\r\n                      {q.asker_name ? `Por ${q.asker_name} • ` : \"\"}{new Date(q.created_at).toLocaleDateString()}\r\n                    </div>\r\n\r\n                    {Array.isArray(q.product_answers) && q.product_answers.length > 0 ? (\r\n                      <div className=\"mt-3 rounded-lg bg-popover p-3\">\r\n                        <div className=\"text-xs font-semibold\">Respuesta</div>\r\n                        <div className=\"text-sm text-muted-foreground whitespace-pre-line\">{q.product_answers[0].answer}</div>\r\n                      </div>\r\n                    ) : null}\r\n                  </div>\r\n                ))}\r\n              </div>\r\n            )}\r\n\r\n            <div className=\"pt-2 border-t space-y-3\">\r\n              <div className=\"flex items-center justify-between gap-3\">\r\n                <div className=\"text-sm font-semibold\">Hacer una pregunta</div>\r\n                {!showQuestionForm ? (\r\n                  <Button\r\n                    type=\"button\"\r\n                    variant=\"outline\"\r\n                    onClick={() => {\r\n                      setQSent(null)\r\n                      setShowQuestionForm(true)\r\n                    }}\r\n                  >\r\n                    Hacer una pregunta\r\n                  </Button>\r\n                ) : (\r\n                  <Button type=\"button\" variant=\"outline\" onClick={() => setShowQuestionForm(false)}>\r\n                    Cancelar\r\n                  </Button>\r\n                )}\r\n              </div>\r\n\r\n              {qSent ? <div className=\"text-sm text-muted-foreground\">{qSent}</div> : null}\r\n\r\n              {showQuestionForm ? (\r\n                <div className=\"space-y-3\">\r\n                  <div className=\"grid grid-cols-1 md:grid-cols-2 gap-3\">\r\n                    <div className=\"space-y-1\">\r\n                      <Label>Tu nombre (opcional)</Label>\r\n                      <Input value={qName} onChange={(e) => setQName(e.target.value)} placeholder=\"Ej: Ana\" />\r\n                    </div>\r\n                    <div className=\"space-y-1\">\r\n                      <Label>Teléfono (opcional)</Label>\r\n                      <Input value={qPhone} onChange={(e) => setQPhone(e.target.value)} placeholder=\"999999999\" />\r\n                    </div>\r\n                    <div className=\"space-y-1 md:col-span-2\">\r\n                      <Label>Pregunta</Label>\r\n                      <Textarea\r\n                        value={qText}\r\n                        onChange={(e) => setQText(e.target.value)}\r\n                        placeholder=\"Ej: ¿Qué talla recomiendas?\"\r\n                      />\r\n                    </div>\r\n                  </div>\r\n\r\n                  <Button type=\"button\" onClick={submitQuestion} disabled={sendingQ} className=\"w-full md:w-auto\">\r\n                    {sendingQ ? \"Enviando...\" : \"Enviar pregunta\"}\r\n                  </Button>\r\n                </div>\r\n              ) : null}\r\n            </div>\r\n          </div>\r\n        )\r\n      }\r\n    </div >\r\n  )\r\n}\r\n"],"names":[],"mappings":"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"}},
    {"offset": {"line": 2028, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/Martin/Desktop/PROYECTOS/Tienda-Blama-2026/app/productos/%5Bid%5D/producto-detalle-client.tsx"],"sourcesContent":["\"use client\"\r\n\r\nimport { useEffect, useMemo, useRef, useState } from \"react\"\r\nimport Link from \"next/link\"\r\nimport { useParams, useRouter } from \"next/navigation\"\r\nimport { Button } from \"@/components/ui/button\"\r\nimport { Card, CardContent } from \"@/components/ui/card\"\r\nimport { formatCurrency } from \"@/lib/utils\"\r\nimport { ProductImageCarousel } from \"@/components/product-image-carousel\"\r\nimport { useCartStore } from \"@/features/cart\"\r\nimport { useCartAnimationStore } from \"@/features/cart/cart-animation\"\r\nimport { getProductDetail, getRecommendedProducts } from \"@/features/products/services/products.client\"\r\nimport {\r\n    ArrowLeft,\r\n    CheckCircle,\r\n    ChevronLeft,\r\n    ChevronRight,\r\n    Copy,\r\n    CreditCard,\r\n    Minus,\r\n    Plus,\r\n    RefreshCw,\r\n    Send,\r\n    ShieldCheck,\r\n    Share2,\r\n    ShoppingCart,\r\n    Truck,\r\n    Star,\r\n    MessageCircle,\r\n    FileText,\r\n    Ruler,\r\n    Palette,\r\n    Droplets,\r\n    Lightbulb,\r\n    Shield,\r\n    Sparkles,\r\n    Image as ImageIcon,\r\n    PlayCircle,\r\n    StarHalf,\r\n} from \"lucide-react\"\r\nimport { ProductCard } from \"@/components/product-card\"\r\nimport { ProductSocialProof } from \"@/components/product-social-proof\"\r\n\r\nfunction parseProductId(raw: string) {\r\n    const direct = Number(raw)\r\n    if (Number.isFinite(direct) && direct > 0) return direct\r\n    const match = String(raw).match(/(\\d+)(?:\\D*)$/)\r\n    if (match && match[1]) return Number(match[1])\r\n    return 0\r\n}\r\n\r\nexport default function ProductoDetalleClient() {\r\n    const params = useParams()\r\n    const router = useRouter()\r\n    const rawId = params.id as string\r\n\r\n    const numericId = useMemo(() => parseProductId(rawId), [rawId])\r\n    const startAnimation = useCartAnimationStore((s) => s.startAnimation)\r\n\r\n    const [loading, setLoading] = useState(true)\r\n    const [producto, setProducto] = useState<any>(null)\r\n    const [variantes, setVariantes] = useState<any[]>([])\r\n    const [especificaciones, setEspecificaciones] = useState<any[]>([])\r\n    const [selectedVarianteId, setSelectedVarianteId] = useState<number | null>(null)\r\n    const [recoLoading, setRecoLoading] = useState(false)\r\n    const [recomendados, setRecomendados] = useState<any[]>([])\r\n    const recoRef = useRef<HTMLDivElement | null>(null)\r\n    const imageContainerRef = useRef<HTMLDivElement | null>(null)\r\n\r\n    const [shareOpen, setShareOpen] = useState(false)\r\n    const [copied, setCopied] = useState(false)\r\n    const [addedToastOpen, setAddedToastOpen] = useState(false)\r\n    const [addedToastKey, setAddedToastKey] = useState(0)\r\n    const [activeTab, setActiveTab] = useState<'description' | 'details' | 'specs' | 'reviews' | 'questions'>('description')\r\n    const [showVideo, setShowVideo] = useState(false)\r\n\r\n    const { addItem, items, updateQuantity } = useCartStore()\r\n\r\n    useEffect(() => {\r\n        if (!addedToastOpen) return\r\n        const id = window.setTimeout(() => {\r\n            setAddedToastOpen(false)\r\n        }, 1600)\r\n        return () => window.clearTimeout(id)\r\n    }, [addedToastOpen])\r\n\r\n    const quantity = useMemo(() => {\r\n        const vid = selectedVarianteId ?? null\r\n        const found = items.find((it: any) => it.id === numericId && ((it as any).producto_variante_id ?? null) === vid)\r\n        return found?.quantity || 0\r\n    }, [items, numericId, selectedVarianteId])\r\n\r\n    useEffect(() => {\r\n        if (!rawId) return\r\n        fetchProducto()\r\n        // eslint-disable-next-line react-hooks/exhaustive-deps\r\n    }, [rawId])\r\n\r\n    useEffect(() => {\r\n        if (!producto?.id) return\r\n        fetchRecomendados(Number(producto.id))\r\n        // eslint-disable-next-line react-hooks/exhaustive-deps\r\n    }, [producto?.id])\r\n\r\n    async function fetchProducto() {\r\n        setLoading(true)\r\n\r\n        if (!numericId) {\r\n            setProducto(null)\r\n            setLoading(false)\r\n            return\r\n        }\r\n\r\n        const { producto, variantes, especificaciones } = await getProductDetail(numericId)\r\n        setProducto(producto)\r\n\r\n        const vData = Array.isArray(variantes) ? variantes : []\r\n        setVariantes(vData)\r\n        if (vData.length > 0) {\r\n            setSelectedVarianteId((prev) => {\r\n                if (prev != null && vData.some((v: any) => Number(v.id) === Number(prev))) return prev\r\n                return Number(vData[0].id)\r\n            })\r\n        } else {\r\n            setSelectedVarianteId(null)\r\n        }\r\n\r\n        const sData = Array.isArray(especificaciones) ? especificaciones : []\r\n        setEspecificaciones(sData)\r\n\r\n        setLoading(false)\r\n    }\r\n\r\n    async function fetchRecomendados(excludeId: number) {\r\n        setRecoLoading(true)\r\n        try {\r\n            const recos = await getRecommendedProducts(excludeId)\r\n            setRecomendados(Array.isArray(recos) ? recos : [])\r\n        } finally {\r\n            setRecoLoading(false)\r\n        }\r\n    }\r\n\r\n    const images = useMemo(() => {\r\n        const arr = Array.isArray(producto?.imagenes) ? (producto.imagenes as string[]) : []\r\n        const clean = (arr || [])\r\n            .filter(Boolean)\r\n            .filter((u) => {\r\n                const s = String(u || '').toLowerCase()\r\n                return !(s.endsWith('.mp4') || s.endsWith('.webm') || s.endsWith('.mov') || s.endsWith('.m4v'))\r\n            })\r\n            .slice(0, 10)\r\n        if (clean.length > 0) return clean\r\n        const single = producto?.imagen_url ? String(producto.imagen_url) : ''\r\n        const s = single.toLowerCase()\r\n        if (single && !(s.endsWith('.mp4') || s.endsWith('.webm') || s.endsWith('.mov') || s.endsWith('.m4v'))) return [single]\r\n        return []\r\n    }, [producto])\r\n\r\n    const videos = useMemo(() => {\r\n        const arr = Array.isArray(producto?.videos) ? (producto.videos as string[]) : []\r\n        const base = (arr || []).map((x) => String(x || '').trim()).filter(Boolean)\r\n\r\n        const fromImages = Array.isArray(producto?.imagenes)\r\n            ? (producto.imagenes as string[])\r\n                .map((x) => String(x || '').trim())\r\n                .filter((u) => {\r\n                    const s = u.toLowerCase()\r\n                    return s.endsWith('.mp4') || s.endsWith('.webm') || s.endsWith('.mov') || s.endsWith('.m4v')\r\n                })\r\n            : []\r\n\r\n        const fromMain = producto?.imagen_url\r\n            ? (() => {\r\n                const u = String(producto.imagen_url || '').trim()\r\n                const s = u.toLowerCase()\r\n                return s.endsWith('.mp4') || s.endsWith('.webm') || s.endsWith('.mov') || s.endsWith('.m4v') ? [u] : []\r\n            })()\r\n            : []\r\n\r\n        const merged = [...base, ...fromImages, ...fromMain]\r\n        const unique: string[] = []\r\n        for (const u of merged) {\r\n            if (!u) continue\r\n            if (!unique.includes(u)) unique.push(u)\r\n            if (unique.length >= 6) break\r\n        }\r\n        return unique\r\n    }, [producto])\r\n\r\n    const [activeVideo, setActiveVideo] = useState<string | null>(null)\r\n\r\n    useEffect(() => {\r\n        setActiveVideo((prev) => {\r\n            if (prev && videos.includes(prev)) return prev\r\n            return videos[0] || null\r\n        })\r\n    }, [videos.join('|')])\r\n\r\n    if (loading) {\r\n        return <div className=\"p-10 text-center text-muted-foreground\">Cargando producto...</div>\r\n    }\r\n\r\n    if (!producto) {\r\n        return (\r\n            <div className=\"space-y-4\">\r\n                <Button variant=\"ghost\" className=\"gap-2\" onClick={() => router.push(\"/productos\")}\r\n                >\r\n                    <ArrowLeft className=\"h-4 w-4\" /> Volver\r\n                </Button>\r\n                <div className=\"bg-white rounded-xl shadow-sm border p-8 text-center\">\r\n                    <p className=\"text-lg font-semibold\">Producto no encontrado</p>\r\n                    <p className=\"text-sm text-muted-foreground mt-1\">Puede que haya sido eliminado o no exista.</p>\r\n                </div>\r\n            </div>\r\n        )\r\n    }\r\n\r\n    const selectedVariante = selectedVarianteId\r\n        ? variantes.find((v: any) => Number(v.id) === Number(selectedVarianteId)) || null\r\n        : null\r\n\r\n    const effectiveStock = selectedVariante ? Number((selectedVariante as any).stock ?? 0) : Number(producto.stock || 0)\r\n    const inStock = effectiveStock > 0\r\n    const isLowStock = inStock && effectiveStock <= 5\r\n\r\n    const currentPrice = Number(selectedVariante?.precio ?? producto?.precio ?? 0)\r\n    const beforePrice = Number(selectedVariante?.precio_antes ?? producto?.precio_antes ?? 0)\r\n    const hasSale =\r\n        Number.isFinite(beforePrice) &&\r\n        beforePrice > 0 &&\r\n        Number.isFinite(currentPrice) &&\r\n        currentPrice > 0 &&\r\n        beforePrice > currentPrice\r\n    const discountPercent = hasSale ? Math.round((1 - currentPrice / beforePrice) * 100) : 0\r\n\r\n    const scrollRecoBy = (delta: number) => {\r\n        const el = recoRef.current\r\n        if (!el) return\r\n        el.scrollBy({ left: delta, behavior: \"smooth\" })\r\n    }\r\n\r\n    const categoryLabel = producto?.categorias?.nombre ? String(producto.categorias.nombre) : \"—\"\r\n    const categoryId = producto?.categoria_id ? String(producto.categoria_id) : null\r\n\r\n    const shareUrl = typeof window !== \"undefined\" ? window.location.href : \"\"\r\n\r\n    const handleCopyLink = async () => {\r\n        try {\r\n            await navigator.clipboard.writeText(shareUrl)\r\n            setCopied(true)\r\n            setTimeout(() => setCopied(false), 1200)\r\n        } catch (err) {\r\n        }\r\n    }\r\n\r\n    const handleShareWhatsApp = () => {\r\n        const text = `${String(producto?.nombre || \"Producto\")}: ${shareUrl}`\r\n        const wa = `https://api.whatsapp.com/send/?text=${encodeURIComponent(text)}`\r\n        window.open(wa, \"_blank\")\r\n    }\r\n\r\n    const handleShareNative = async () => {\r\n        try {\r\n            const nav: any = navigator\r\n            if (nav?.share) {\r\n                await nav.share({\r\n                    title: String(producto?.nombre || \"Producto\"),\r\n                    text: String(producto?.nombre || \"Producto\"),\r\n                    url: shareUrl,\r\n                })\r\n                return\r\n            }\r\n        } catch (err) {\r\n        }\r\n        setShareOpen((v) => !v)\r\n    }\r\n\r\n    return (\r\n        <div className=\"space-y-6 max-w-5xl mx-auto pb-24 md:pb-0\">\r\n            <div className=\"flex items-center justify-between gap-3\">\r\n                <Button variant=\"ghost\" className=\"gap-2\" asChild>\r\n                    <Link href=\"/productos\">\r\n                        <ArrowLeft className=\"h-4 w-4\" /> Volver a productos\r\n                    </Link>\r\n                </Button>\r\n\r\n                <div className=\"relative\">\r\n                    <Button type=\"button\" variant=\"outline\" className=\"gap-2\" onClick={handleShareNative}>\r\n                        <Share2 className=\"h-4 w-4\" /> Compartir\r\n                    </Button>\r\n\r\n                    {shareOpen && (\r\n                        <div className=\"absolute right-0 mt-2 w-56 rounded-xl border bg-card shadow-lg p-2 z-20\">\r\n                            <button\r\n                                type=\"button\"\r\n                                className=\"w-full flex items-center gap-2 rounded-lg px-3 py-2 text-sm hover:bg-popover text-foreground\"\r\n                                onClick={() => {\r\n                                    setShareOpen(false)\r\n                                    handleShareWhatsApp()\r\n                                }}\r\n                            >\r\n                                <Send className=\"h-4 w-4\" /> WhatsApp\r\n                            </button>\r\n                            <button\r\n                                type=\"button\"\r\n                                className=\"w-full flex items-center gap-2 rounded-lg px-3 py-2 text-sm hover:bg-popover text-foreground\"\r\n                                onClick={() => {\r\n                                    handleCopyLink()\r\n                                }}\r\n                            >\r\n                                <Copy className=\"h-4 w-4\" /> {copied ? \"Link copiado\" : \"Copiar link\"}\r\n                            </button>\r\n                        </div>\r\n                    )}\r\n                </div>\r\n            </div>\r\n\r\n            <div className=\"text-sm text-muted-foreground\">\r\n                <Link href=\"/\" className=\"hover:underline\">Inicio</Link>\r\n                <span className=\"mx-2\">/</span>\r\n                <Link href=\"/productos\" className=\"hover:underline\">Productos</Link>\r\n                <span className=\"mx-2\">/</span>\r\n                {categoryId ? (\r\n                    <Link href={`/productos?cat=${encodeURIComponent(categoryId)}`} className=\"hover:underline\">\r\n                        {categoryLabel}\r\n                    </Link>\r\n                ) : (\r\n                    <span>{categoryLabel}</span>\r\n                )}\r\n                <span className=\"mx-2\">/</span>\r\n                <span className=\"text-foreground font-semibold\">{String(producto.nombre)}</span>\r\n            </div>\r\n\r\n            <div className=\"grid grid-cols-1 md:grid-cols-2 gap-6\">\r\n                <div className=\"space-y-4\">\r\n                    <Card className=\"overflow-hidden shadow-sm border\">\r\n                        <div className=\"aspect-square bg-popover relative group\" ref={imageContainerRef}>\r\n                            {showVideo && activeVideo ? (\r\n                                <div className=\"absolute inset-0 flex items-center justify-center bg-black\">\r\n                                    <video\r\n                                        key={activeVideo}\r\n                                        src={activeVideo}\r\n                                        controls\r\n                                        playsInline\r\n                                        className=\"w-full h-full object-contain\"\r\n                                    />\r\n                                </div>\r\n                            ) : (\r\n                                <>\r\n                                    {images.length > 0 ? (\r\n                                        <ProductImageCarousel images={images} alt={producto.nombre} />\r\n                                    ) : (\r\n                                        <div className=\"absolute inset-0 flex items-center justify-center text-muted-foreground\">Sin imagen</div>\r\n                                    )}\r\n                                    {!inStock && (\r\n                                        <div className=\"absolute inset-0 bg-foreground/60 flex items-center justify-center\">\r\n                                            <span className=\"text-sidebar-primary-foreground font-bold\">Agotado</span>\r\n                                        </div>\r\n                                    )}\r\n                                </>\r\n                            )}\r\n                        </div>\r\n                    </Card>\r\n\r\n                    {showVideo && videos.length > 1 && (\r\n                        <div className=\"flex flex-wrap gap-2\">\r\n                            {videos.map((v, i) => (\r\n                                <button\r\n                                    key={v}\r\n                                    type=\"button\"\r\n                                    onClick={() => setActiveVideo(v)}\r\n                                    className={\r\n                                        \"rounded-lg border px-3 py-2 text-xs font-semibold transition-colors \" +\r\n                                        (activeVideo === v ? \"border-primary bg-primary/10\" : \"border-border hover:bg-popover\")\r\n                                    }\r\n                                >\r\n                                    Video {i + 1}\r\n                                </button>\r\n                            ))}\r\n                        </div>\r\n                    )}\r\n\r\n                    {videos.length > 0 && (\r\n                        <Button\r\n                            className={`w-full gap-2 h-12 text-base font-bold shadow-md transition-all duration-300 ${showVideo\r\n                                    ? \"bg-white text-gray-900 border-2 border-gray-200 hover:bg-gray-50 hover:border-gray-300\"\r\n                                    : \"bg-gradient-to-r from-red-600 to-red-500 text-white hover:from-red-700 hover:to-red-600 hover:shadow-lg hover:scale-[1.01] border-0\"\r\n                                }`}\r\n                            onClick={() => setShowVideo(!showVideo)}\r\n                        >\r\n                            {showVideo ? (\r\n                                <>\r\n                                    <ImageIcon className=\"h-5 w-5\" />\r\n                                    Ver Galería de Fotos\r\n                                </>\r\n                            ) : (\r\n                                <>\r\n                                    <PlayCircle className=\"h-5 w-5 animate-pulse\" />\r\n                                    Ver Videos del Producto\r\n                                </>\r\n                            )}\r\n                        </Button>\r\n                    )}\r\n                </div>\r\n\r\n                <div className=\"space-y-4\">\r\n                    <Card className=\"shadow-sm border\">\r\n                        <CardContent className=\"p-6 space-y-3\">\r\n                            <div className=\"space-y-1\">\r\n                                <div className=\"flex items-center gap-1 mb-2\">\r\n                                    <div className=\"flex items-center\">\r\n                                        {(() => {\r\n                                            const rating = Number(producto.calificacion ?? 5)\r\n                                            const fullStars = Math.floor(rating)\r\n                                            const hasHalfStar = rating % 1 >= 0.4\r\n                                            const emptyStars = 5 - fullStars - (hasHalfStar ? 1 : 0)\r\n\r\n                                            return (\r\n                                                <>\r\n                                                    {Array.from({ length: fullStars }).map((_, i) => (\r\n                                                        <Star key={`full-${i}`} className=\"h-4 w-4 fill-amber-400 text-amber-400\" />\r\n                                                    ))}\r\n                                                    {hasHalfStar && <StarHalf className=\"h-4 w-4 fill-amber-400 text-amber-400\" />}\r\n                                                    {Array.from({ length: emptyStars }).map((_, i) => (\r\n                                                        <Star key={`empty-${i}`} className=\"h-4 w-4 text-muted-foreground/30\" />\r\n                                                    ))}\r\n                                                    <span className=\"text-sm font-semibold text-muted-foreground ml-2\">{rating.toFixed(1)}</span>\r\n                                                </>\r\n                                            )\r\n                                        })()}\r\n                                    </div>\r\n                                </div>\r\n                                <h1 className=\"text-2xl md:text-3xl font-bold text-foreground\">{producto.nombre}</h1>\r\n                                <div className=\"text-sm text-muted-foreground\">\r\n                                    {producto.categorias?.nombre ? (\r\n                                        <span>Categoría: {producto.categorias.nombre}</span>\r\n                                    ) : (\r\n                                        <span>Categoría: —</span>\r\n                                    )}\r\n                                </div>\r\n                            </div>\r\n\r\n                            {variantes.length > 0 && (\r\n                                <div className=\"space-y-2\">\r\n                                    <div className=\"text-sm font-semibold text-foreground\">Variantes</div>\r\n                                    <div className=\"grid grid-cols-2 sm:grid-cols-3 gap-2\">\r\n                                        {variantes.map((v: any) => {\r\n                                            const vId = Number(v.id)\r\n                                            const isActive = (selectedVarianteId ?? null) === vId\r\n                                            const vStock = Number(v.stock ?? 0)\r\n                                            return (\r\n                                                <button\r\n                                                    key={vId}\r\n                                                    type=\"button\"\r\n                                                    onClick={() => setSelectedVarianteId(vId)}\r\n                                                    className={\r\n                                                        \"rounded-lg border px-3 py-2 text-left transition-colors \" +\r\n                                                        (isActive ? \"border-primary bg-primary/10\" : \"border-border hover:bg-popover\")\r\n                                                    }\r\n                                                >\r\n                                                    <div className=\"text-sm font-semibold text-foreground line-clamp-1\">\r\n                                                        {String(v.etiqueta || \"Variante\")}\r\n                                                    </div>\r\n                                                    <div className=\"text-xs text-muted-foreground\">\r\n                                                        {vStock > 0 ? `${vStock} disponibles` : \"Sin stock\"}\r\n                                                    </div>\r\n                                                </button>\r\n                                            )\r\n                                        })}\r\n                                    </div>\r\n                                </div>\r\n                            )}\r\n\r\n                            <div className=\"flex items-center justify-between gap-3\">\r\n                                <div>\r\n                                    <div className=\"text-sm text-muted-foreground\">Precio</div>\r\n                                    <div className=\"flex items-end gap-3 flex-wrap\">\r\n                                        <div className=\"text-3xl font-extrabold text-primary tracking-tight\">\r\n                                            {formatCurrency(currentPrice)}\r\n                                        </div>\r\n                                        {hasSale && (\r\n                                            <div className=\"flex items-center gap-2\">\r\n                                                <div className=\"text-base text-muted-foreground line-through\">\r\n                                                    {formatCurrency(beforePrice)}\r\n                                                </div>\r\n                                                <span className=\"inline-flex items-center rounded-full bg-gradient-to-r from-rose-600 to-orange-500 px-2.5 py-1 text-xs font-extrabold text-white shadow-md ring-1 ring-white/30\">\r\n                                                    -{discountPercent}%\r\n                                                </span>\r\n                                            </div>\r\n                                        )}\r\n                                    </div>\r\n                                </div>\r\n                                <div className=\"text-right\">\r\n                                    <div className=\"text-sm text-muted-foreground\">Stock</div>\r\n                                    <div className={`text-sm font-semibold ${inStock ? \"text-green-700\" : \"text-red-700\"}`}>\r\n                                        {inStock ? `${effectiveStock} disponibles` : \"Sin stock\"}\r\n                                    </div>\r\n                                </div>\r\n                            </div>\r\n\r\n                            {isLowStock && (\r\n                                <div className=\"rounded-lg border border-amber-200 bg-amber-50 px-3 py-2 text-sm text-amber-900\">\r\n                                    <span className=\"font-semibold\">Quedan {effectiveStock} unidades</span>\r\n                                </div>\r\n                            )}\r\n\r\n                            <div className=\"grid grid-cols-1 sm:grid-cols-2 gap-2 rounded-lg border bg-card p-3\">\r\n                                <div className=\"flex items-center gap-2 text-xs text-muted-foreground\">\r\n                                    <Truck className=\"h-4 w-4 text-foreground\" />\r\n                                    <span>Entrega gratuita en 24h solo Lima Metropolitana</span>\r\n                                </div>\r\n                                <div className=\"flex items-center gap-2 text-xs text-muted-foreground\">\r\n                                    <CreditCard className=\"h-4 w-4 text-foreground\" />\r\n                                    <span>Pago contraentrega / Pagas al recibir tu pedido</span>\r\n                                </div>\r\n                                <div className=\"flex items-center gap-2 text-xs text-muted-foreground\">\r\n                                    <RefreshCw className=\"h-4 w-4 text-foreground\" />\r\n                                    <span>Cambios y devoluciones</span>\r\n                                </div>\r\n                                <div className=\"flex items-center gap-2 text-xs text-muted-foreground\">\r\n                                    <ShieldCheck className=\"h-4 w-4 text-foreground\" />\r\n                                    <span>Compra segura</span>\r\n                                </div>\r\n                            </div>\r\n\r\n                            {inStock ? (\r\n                                quantity === 0 ? (\r\n                                    <div className=\"grid grid-cols-1 sm:grid-cols-2 gap-2\">\r\n                                        <Button\r\n                                            className=\"w-full gap-2 h-11\"\r\n                                            variant=\"secondary\"\r\n                                            onClick={() => {\r\n                                                addItem(producto, selectedVariante)\r\n                                                router.push(\"/checkout\")\r\n                                            }}\r\n                                        >\r\n                                            Comprar ahora\r\n                                        </Button>\r\n                                        <Button className=\"w-full gap-2 h-11\" onClick={() => {\r\n                                            addItem(producto, selectedVariante)\r\n                                            if (imageContainerRef.current && images.length > 0) {\r\n                                                const rect = imageContainerRef.current.getBoundingClientRect()\r\n                                                startAnimation(images[0], rect)\r\n                                            }\r\n                                            setAddedToastKey(Date.now())\r\n                                            setAddedToastOpen(true)\r\n                                        }}>\r\n                                            <ShoppingCart className=\"h-4 w-4\" /> Agregar al carrito\r\n                                        </Button>\r\n                                    </div>\r\n                                ) : (\r\n                                    <div className=\"w-full flex items-center justify-between bg-popover rounded-lg p-2\">\r\n                                        <Button\r\n                                            variant=\"ghost\"\r\n                                            size=\"icon\"\r\n                                            className=\"h-10 w-10\"\r\n                                            onClick={() => updateQuantity(Number(producto.id), quantity - 1, selectedVarianteId ?? null)}\r\n                                        >\r\n                                            <Minus className=\"h-4 w-4\" />\r\n                                        </Button>\r\n                                        <div className=\"text-center\">\r\n                                            <div className=\"text-xs text-muted-foreground\">Cantidad</div>\r\n                                            <div className=\"text-lg font-bold\">{quantity}</div>\r\n                                        </div>\r\n                                        <Button\r\n                                            variant=\"ghost\"\r\n                                            size=\"icon\"\r\n                                            className=\"h-10 w-10\"\r\n                                            onClick={() => updateQuantity(Number(producto.id), quantity + 1, selectedVarianteId ?? null)}\r\n                                        >\r\n                                            <Plus className=\"h-4 w-4\" />\r\n                                        </Button>\r\n                                    </div>\r\n                                )\r\n                            ) : (\r\n                                <Button disabled className=\"w-full h-11\">\r\n                                    Sin stock\r\n                                </Button>\r\n                            )}\r\n\r\n                            {inStock && quantity > 0 && (\r\n                                <Button className=\"w-full h-11\" variant=\"secondary\" onClick={() => router.push(\"/checkout\")}>\r\n                                    Comprar ahora\r\n                                </Button>\r\n                            )}\r\n\r\n                            <div className=\"pt-2 text-xs text-muted-foreground\">\r\n                                ID: #{String(producto.id).padStart(6, \"0\")} • {new Date(producto.created_at).toLocaleString()}\r\n                            </div>\r\n                        </CardContent>\r\n                    </Card>\r\n\r\n                    {/* TABS SECTION */}\r\n                    <div className=\"mt-12\">\r\n                        <div className=\"flex flex-wrap items-center justify-center gap-2 mb-8 select-none p-1 bg-muted/30 rounded-full w-fit mx-auto border\">\r\n                            {producto?.descripcion && (\r\n                                <button\r\n                                    type=\"button\"\r\n                                    onClick={() => setActiveTab('description')}\r\n                                    className={`\r\n                                        relative px-5 py-2 rounded-full text-sm font-medium transition-all duration-200 flex items-center gap-2\r\n                                        ${activeTab === 'description'\r\n                                            ? 'bg-white text-foreground shadow-sm ring-1 ring-border'\r\n                                            : 'text-muted-foreground hover:text-foreground hover:bg-muted/50'\r\n                                        }\r\n                                    `}\r\n                                >\r\n                                    <FileText className=\"h-4 w-4\" />\r\n                                    <span>Descripción</span>\r\n                                </button>\r\n                            )}\r\n                            {(producto?.materiales || producto?.tamano || producto?.color || producto?.cuidados || producto?.uso) && (\r\n                                <button\r\n                                    type=\"button\"\r\n                                    onClick={() => setActiveTab('details')}\r\n                                    className={`\r\n                                        relative px-5 py-2 rounded-full text-sm font-medium transition-all duration-200 flex items-center gap-2\r\n                                        ${activeTab === 'details'\r\n                                            ? 'bg-white text-foreground shadow-sm ring-1 ring-border'\r\n                                            : 'text-muted-foreground hover:text-foreground hover:bg-muted/50'\r\n                                        }\r\n                                    `}\r\n                                >\r\n                                    <Sparkles className=\"h-4 w-4\" />\r\n                                    <span>Detalles</span>\r\n                                </button>\r\n                            )}\r\n\r\n                            {especificaciones.length > 0 && (\r\n                                <button\r\n                                    type=\"button\"\r\n                                    onClick={() => setActiveTab('specs')}\r\n                                    className={`\r\n                                        relative px-5 py-2 rounded-full text-sm font-medium transition-all duration-200 flex items-center gap-2\r\n                                        ${activeTab === 'specs'\r\n                                            ? 'bg-white text-foreground shadow-sm ring-1 ring-border'\r\n                                            : 'text-muted-foreground hover:text-foreground hover:bg-muted/50'\r\n                                        }\r\n                                    `}\r\n                                >\r\n                                    <Ruler className=\"h-4 w-4\" />\r\n                                    <span>Especificaciones</span>\r\n                                </button>\r\n                            )}\r\n                            <button\r\n                                type=\"button\"\r\n                                onClick={() => setActiveTab('reviews')}\r\n                                className={`\r\n                                    relative px-5 py-2 rounded-full text-sm font-medium transition-all duration-200 flex items-center gap-2\r\n                                    ${activeTab === 'reviews'\r\n                                        ? 'bg-white text-foreground shadow-sm ring-1 ring-border'\r\n                                        : 'text-muted-foreground hover:text-foreground hover:bg-muted/50'\r\n                                    }\r\n                                `}\r\n                            >\r\n                                <Star className=\"h-4 w-4\" />\r\n                                <span>Valoraciones</span>\r\n                            </button>\r\n                            <button\r\n                                type=\"button\"\r\n                                onClick={() => setActiveTab('questions')}\r\n                                className={`\r\n                                    relative px-5 py-2 rounded-full text-sm font-medium transition-all duration-200 flex items-center gap-2\r\n                                    ${activeTab === 'questions'\r\n                                        ? 'bg-white text-foreground shadow-sm ring-1 ring-border'\r\n                                        : 'text-muted-foreground hover:text-foreground hover:bg-muted/50'\r\n                                    }\r\n                                `}\r\n                            >\r\n                                <MessageCircle className=\"h-4 w-4\" />\r\n                                <span>Preguntas</span>\r\n                            </button>\r\n                        </div>\r\n\r\n                        <div className=\"min-h-[300px] animate-in fade-in slide-in-from-bottom-4 duration-500\">\r\n                            {activeTab === 'description' && producto?.descripcion && (\r\n                                <div className=\"space-y-6 animate-in fade-in zoom-in-95 duration-300\">\r\n                                    <div className=\"bg-card border rounded-2xl p-8 shadow-sm relative overflow-hidden\">\r\n                                        <div className=\"absolute top-0 right-0 p-8 opacity-5\">\r\n                                            <Sparkles className=\"w-32 h-32 text-primary\" />\r\n                                        </div>\r\n                                        <h3 className=\"text-xl font-bold mb-6 flex items-center gap-2 text-primary\">\r\n                                            <span className=\"p-2 bg-primary/10 rounded-lg\">\r\n                                                <FileText className=\"h-5 w-5\" />\r\n                                            </span>\r\n                                            Descripción del Producto\r\n                                        </h3>\r\n                                        <div className=\"prose prose-sm md:prose-base text-muted-foreground whitespace-pre-line leading-relaxed max-w-none\">\r\n                                            {producto.descripcion}\r\n                                        </div>\r\n                                    </div>\r\n                                </div>\r\n                            )}\r\n\r\n                            {activeTab === 'details' && (\r\n                                <div className=\"space-y-8 animate-in fade-in zoom-in-95 duration-300\">\r\n                                    <div className=\"grid grid-cols-1 md:grid-cols-2 gap-4\">\r\n                                        {producto?.materiales && (\r\n                                            <div className=\"bg-card border rounded-xl p-5 hover:shadow-md transition-shadow duration-300 flex gap-4 items-start group\">\r\n                                                <div className=\"p-3 bg-blue-50 dark:bg-blue-900/20 text-blue-600 dark:text-blue-400 rounded-xl group-hover:scale-110 transition-transform\">\r\n                                                    <Shield className=\"h-6 w-6\" />\r\n                                                </div>\r\n                                                <div>\r\n                                                    <h4 className=\"font-semibold text-foreground mb-1\">Materiales</h4>\r\n                                                    <p className=\"text-sm text-muted-foreground leading-relaxed\">{producto.materiales}</p>\r\n                                                </div>\r\n                                            </div>\r\n                                        )}\r\n\r\n                                        {producto?.tamano && (\r\n                                            <div className=\"bg-card border rounded-xl p-5 hover:shadow-md transition-shadow duration-300 flex gap-4 items-start group\">\r\n                                                <div className=\"p-3 bg-emerald-50 dark:bg-emerald-900/20 text-emerald-600 dark:text-emerald-400 rounded-xl group-hover:scale-110 transition-transform\">\r\n                                                    <Ruler className=\"h-6 w-6\" />\r\n                                                </div>\r\n                                                <div>\r\n                                                    <h4 className=\"font-semibold text-foreground mb-1\">Medidas</h4>\r\n                                                    <p className=\"text-sm text-muted-foreground leading-relaxed\">{producto.tamano}</p>\r\n                                                </div>\r\n                                            </div>\r\n                                        )}\r\n\r\n                                        {producto?.color && (\r\n                                            <div className=\"bg-card border rounded-xl p-5 hover:shadow-md transition-shadow duration-300 flex gap-4 items-start group\">\r\n                                                <div className=\"p-3 bg-purple-50 dark:bg-purple-900/20 text-purple-600 dark:text-purple-400 rounded-xl group-hover:scale-110 transition-transform\">\r\n                                                    <Palette className=\"h-6 w-6\" />\r\n                                                </div>\r\n                                                <div>\r\n                                                    <h4 className=\"font-semibold text-foreground mb-1\">Color</h4>\r\n                                                    <p className=\"text-sm text-muted-foreground leading-relaxed\">{producto.color}</p>\r\n                                                </div>\r\n                                            </div>\r\n                                        )}\r\n\r\n                                        {producto?.cuidados && (\r\n                                            <div className=\"bg-card border rounded-xl p-5 hover:shadow-md transition-shadow duration-300 flex gap-4 items-start group\">\r\n                                                <div className=\"p-3 bg-sky-50 dark:bg-sky-900/20 text-sky-600 dark:text-sky-400 rounded-xl group-hover:scale-110 transition-transform\">\r\n                                                    <Droplets className=\"h-6 w-6\" />\r\n                                                </div>\r\n                                                <div>\r\n                                                    <h4 className=\"font-semibold text-foreground mb-1\">Cuidados</h4>\r\n                                                    <p className=\"text-sm text-muted-foreground leading-relaxed\">{producto.cuidados}</p>\r\n                                                </div>\r\n                                            </div>\r\n                                        )}\r\n\r\n                                        {producto?.uso && (\r\n                                            <div className=\"md:col-span-2 bg-card border rounded-xl p-5 hover:shadow-md transition-shadow duration-300 flex gap-4 items-start group\">\r\n                                                <div className=\"p-3 bg-amber-50 dark:bg-amber-900/20 text-amber-600 dark:text-amber-400 rounded-xl group-hover:scale-110 transition-transform\">\r\n                                                    <Lightbulb className=\"h-6 w-6\" />\r\n                                                </div>\r\n                                                <div>\r\n                                                    <h4 className=\"font-semibold text-foreground mb-1\">Uso Recomendado</h4>\r\n                                                    <p className=\"text-sm text-muted-foreground leading-relaxed\">{producto.uso}</p>\r\n                                                </div>\r\n                                            </div>\r\n                                        )}\r\n                                    </div>\r\n                                </div>\r\n                            )}\r\n\r\n                            {activeTab === 'specs' && especificaciones.length > 0 && (\r\n                                <div className=\"space-y-8 animate-in fade-in zoom-in-95 duration-300\">\r\n                                    <div className=\"rounded-2xl border bg-card overflow-hidden shadow-sm\">\r\n                                        <div className=\"bg-muted/50 p-4 border-b\">\r\n                                            <h3 className=\"font-bold text-foreground flex items-center gap-2\">\r\n                                                <FileText className=\"h-5 w-5 text-muted-foreground\" />\r\n                                                Especificaciones Técnicas\r\n                                            </h3>\r\n                                        </div>\r\n                                        <div className=\"divide-y\">\r\n                                            {especificaciones.map((s: any, idx: number) => (\r\n                                                <div key={s.id} className=\"p-4 flex items-start justify-between gap-4 hover:bg-muted/30 transition-colors\">\r\n                                                    <div className=\"text-sm font-semibold text-foreground w-1/3\">{String(s.clave || \"\")}</div>\r\n                                                    <div className=\"text-sm text-muted-foreground text-right w-2/3 whitespace-pre-line\">{String(s.valor || \"\")}</div>\r\n                                                </div>\r\n                                            ))}\r\n                                        </div>\r\n                                    </div>\r\n                                </div>\r\n                            )}\r\n\r\n                            {activeTab === 'reviews' && (\r\n                                <div className=\"space-y-6\">\r\n                                    <div className=\"rounded-2xl border bg-card overflow-hidden shadow-sm p-6 md:p-8\">\r\n                                        <ProductSocialProof productId={Number(producto.id)} section=\"reviews\" />\r\n                                    </div>\r\n                                </div>\r\n                            )}\r\n\r\n                            {activeTab === 'questions' && (\r\n                                <div className=\"space-y-6\">\r\n                                    <div className=\"rounded-2xl border bg-card overflow-hidden shadow-sm p-6 md:p-8\">\r\n                                        <ProductSocialProof productId={Number(producto.id)} section=\"questions\" />\r\n                                    </div>\r\n                                </div>\r\n                            )}\r\n                        </div>\r\n                    </div>\r\n                </div>\r\n            </div>\r\n\r\n            <div className=\"pt-2\">\r\n                <div className=\"flex items-end justify-between gap-3\">\r\n                    <div>\r\n                        <h2 className=\"text-xl md:text-2xl font-bold text-foreground\">Más comprados</h2>\r\n                        <p className=\"text-sm text-muted-foreground\">Productos populares para completar tu compra</p>\r\n                    </div>\r\n                    <Link href=\"/productos\" className=\"text-sm font-semibold text-primary hover:underline\">\r\n                        Ver más\r\n                    </Link>\r\n                </div>\r\n\r\n                {recoLoading ? (\r\n                    <div className=\"relative mt-4\">\r\n                        <div className=\"flex gap-4 overflow-x-auto pb-2\">\r\n                            {Array.from({ length: 8 }).map((_, idx) => (\r\n                                <div key={idx} className=\"min-w-[220px] max-w-[220px] h-[280px] rounded-xl border bg-card animate-pulse\" />\r\n                            ))}\r\n                        </div>\r\n                    </div>\r\n                ) : recomendados.length === 0 ? (\r\n                    <div className=\"mt-4 rounded-xl border bg-card p-6 text-sm text-muted-foreground\">\r\n                        No hay recomendaciones disponibles en este momento.\r\n                    </div>\r\n                ) : (\r\n                    <div className=\"relative mt-4\">\r\n                        <div className=\"absolute left-0 top-0 bottom-0 w-10 bg-gradient-to-r from-background to-transparent pointer-events-none\" />\r\n                        <div className=\"absolute right-0 top-0 bottom-0 w-10 bg-gradient-to-l from-background to-transparent pointer-events-none\" />\r\n\r\n                        <div className=\"absolute left-2 top-1/2 -translate-y-1/2 z-10 hidden md:block\">\r\n                            <Button\r\n                                type=\"button\"\r\n                                variant=\"secondary\"\r\n                                size=\"icon\"\r\n                                className=\"h-9 w-9 rounded-full shadow-sm\"\r\n                                onClick={() => scrollRecoBy(-520)}\r\n                                aria-label=\"Ver anteriores\"\r\n                            >\r\n                                <ChevronLeft className=\"h-4 w-4\" />\r\n                            </Button>\r\n                        </div>\r\n                        <div className=\"absolute right-2 top-1/2 -translate-y-1/2 z-10 hidden md:block\">\r\n                            <Button\r\n                                type=\"button\"\r\n                                variant=\"secondary\"\r\n                                size=\"icon\"\r\n                                className=\"h-9 w-9 rounded-full shadow-sm\"\r\n                                onClick={() => scrollRecoBy(520)}\r\n                                aria-label=\"Ver siguientes\"\r\n                            >\r\n                                <ChevronRight className=\"h-4 w-4\" />\r\n                            </Button>\r\n                        </div>\r\n\r\n                        <div ref={recoRef} className=\"flex gap-4 overflow-x-auto scroll-smooth snap-x snap-mandatory pb-2\">\r\n                            {recomendados.map((p) => (\r\n                                <div key={p.id} className=\"snap-start min-w-[220px] max-w-[220px]\">\r\n                                    <ProductCard product={p} />\r\n                                </div>\r\n                            ))}\r\n                        </div>\r\n                    </div>\r\n                )}\r\n            </div>\r\n\r\n            <div className=\"md:hidden fixed bottom-0 left-0 right-0 z-40 border-t bg-background/95 backdrop-blur\">\r\n                <div className=\"max-w-5xl mx-auto px-4 py-3 flex items-center justify-between gap-3\">\r\n                    <div>\r\n                        <div className=\"text-xs text-muted-foreground\">Precio del producto</div>\r\n                        <div className=\"text-lg font-extrabold text-primary leading-none\">{formatCurrency(currentPrice)}</div>\r\n                    </div>\r\n                    <Button\r\n                        className=\"h-11 flex-1 gap-2\"\r\n                        disabled={!inStock}\r\n                        onClick={() => {\r\n                            addItem(producto, selectedVariante)\r\n                            if (imageContainerRef.current && images.length > 0) {\r\n                                const rect = imageContainerRef.current.getBoundingClientRect()\r\n                                startAnimation(images[0], rect)\r\n                            }\r\n                            setAddedToastKey(Date.now())\r\n                            setAddedToastOpen(true)\r\n                        }}\r\n                    >\r\n                        <ShoppingCart className=\"h-4 w-4\" /> Agregar\r\n                    </Button>\r\n                </div>\r\n            </div>\r\n\r\n            {addedToastOpen && (\r\n                <div className=\"md:hidden fixed inset-x-0 bottom-20 z-50 flex justify-center px-4\">\r\n                    <div key={addedToastKey} className=\"w-full max-w-sm rounded-xl border border-border bg-card shadow-lg p-3 animate-in fade-in slide-in-from-bottom-4 duration-300\">\r\n                        <div className=\"flex items-center gap-3\">\r\n                            <div className=\"h-9 w-9 rounded-full bg-green-100 flex items-center justify-center text-green-700\">\r\n                                <CheckCircle className=\"h-5 w-5\" />\r\n                            </div>\r\n                            <div className=\"flex-1\">\r\n                                <div className=\"font-semibold text-foreground leading-snug\">Producto añadido al carrito</div>\r\n                            </div>\r\n                        </div>\r\n                    </div>\r\n                </div>\r\n            )}\r\n        </div>\r\n    )\r\n}\r\n"],"names":[],"mappings":"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"}}]
}