(globalThis.TURBOPACK||(globalThis.TURBOPACK=[])).push(["object"==typeof document?document.currentScript:void 0,71795,e=>{"use strict";var s=e.i(43476),a=e.i(71645),t=e.i(22016),r=e.i(18566),l=e.i(67881),i=e.i(70065),n=e.i(47163),d=e.i(32639);e.i(10040);var o=e.i(3538),c=e.i(49198),m=e.i(58194),u=e.i(71689),x=e.i(69638),h=e.i(73375),p=e.i(63059),g=e.i(75254);let f=(0,g.default)("copy",[["rect",{width:"14",height:"14",x:"8",y:"8",rx:"2",ry:"2",key:"17jyea"}],["path",{d:"M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2",key:"zix9uf"}]]);var j=e.i(61659),b=e.i(99023),v=e.i(7233),N=e.i(16715);let y=(0,g.default)("send",[["path",{d:"M14.536 21.686a.5.5 0 0 0 .937-.024l6.5-19a.496.496 0 0 0-.635-.635l-19 6.5a.5.5 0 0 0-.024.937l7.93 3.18a2 2 0 0 1 1.112 1.11z",key:"1ffxy3"}],["path",{d:"m21.854 2.147-10.94 10.939",key:"12cjpa"}]]);var w=e.i(81418);let k=(0,g.default)("share-2",[["circle",{cx:"18",cy:"5",r:"3",key:"gq8acd"}],["circle",{cx:"6",cy:"12",r:"3",key:"w7nqdw"}],["circle",{cx:"18",cy:"19",r:"3",key:"1xt0gg"}],["line",{x1:"8.59",x2:"15.42",y1:"13.51",y2:"17.49",key:"47mynk"}],["line",{x1:"15.41",x2:"8.59",y1:"6.51",y2:"10.49",key:"1n3mei"}]]);var C=e.i(1928),S=e.i(15788),A=e.i(70273);let I=(0,g.default)("message-circle",[["path",{d:"M2.992 16.342a2 2 0 0 1 .094 1.167l-1.065 3.29a1 1 0 0 0 1.236 1.168l3.413-.998a2 2 0 0 1 1.099.092 10 10 0 1 0-4.777-4.719",key:"1sd12s"}]]),L=(0,g.default)("file-text",[["path",{d:"M6 22a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h8a2.4 2.4 0 0 1 1.704.706l3.588 3.588A2.4 2.4 0 0 1 20 8v12a2 2 0 0 1-2 2z",key:"1oefj6"}],["path",{d:"M14 2v5a1 1 0 0 0 1 1h5",key:"wfsgrz"}],["path",{d:"M10 9H8",key:"b1mrlr"}],["path",{d:"M16 13H8",key:"t4e002"}],["path",{d:"M16 17H8",key:"z1uh3a"}]]),M=(0,g.default)("ruler",[["path",{d:"M21.3 15.3a2.4 2.4 0 0 1 0 3.4l-2.6 2.6a2.4 2.4 0 0 1-3.4 0L2.7 8.7a2.41 2.41 0 0 1 0-3.4l2.6-2.6a2.41 2.41 0 0 1 3.4 0Z",key:"icamh8"}],["path",{d:"m14.5 12.5 2-2",key:"inckbg"}],["path",{d:"m11.5 9.5 2-2",key:"fmmyf7"}],["path",{d:"m8.5 6.5 2-2",key:"vc6u1g"}],["path",{d:"m17.5 15.5 2-2",key:"wo5hmg"}]]),P=(0,g.default)("palette",[["path",{d:"M12 22a1 1 0 0 1 0-20 10 9 0 0 1 10 9 5 5 0 0 1-5 5h-2.25a1.75 1.75 0 0 0-1.4 2.8l.3.4a1.75 1.75 0 0 1-1.4 2.8z",key:"e79jfc"}],["circle",{cx:"13.5",cy:"6.5",r:".5",fill:"currentColor",key:"1okk4w"}],["circle",{cx:"17.5",cy:"10.5",r:".5",fill:"currentColor",key:"f64h9f"}],["circle",{cx:"6.5",cy:"12.5",r:".5",fill:"currentColor",key:"qy21gx"}],["circle",{cx:"8.5",cy:"7.5",r:".5",fill:"currentColor",key:"fotxhn"}]]),_=(0,g.default)("droplets",[["path",{d:"M7 16.3c2.2 0 4-1.83 4-4.05 0-1.16-.57-2.26-1.71-3.19S7.29 6.75 7 5.3c-.29 1.45-1.14 2.84-2.29 3.76S3 11.1 3 12.25c0 2.22 1.8 4.05 4 4.05z",key:"1ptgy4"}],["path",{d:"M12.56 6.6A10.97 10.97 0 0 0 14 3.02c.5 2.5 2 4.9 4 6.5s3 3.5 3 5.5a6.98 6.98 0 0 1-11.91 4.97",key:"1sl1rz"}]]),R=(0,g.default)("lightbulb",[["path",{d:"M15 14c.2-1 .7-1.7 1.5-2.5 1-.9 1.5-2.2 1.5-3.5A6 6 0 0 0 6 8c0 1 .2 2.2 1.5 3.5.7.7 1.3 1.5 1.5 2.5",key:"1gvzjb"}],["path",{d:"M9 18h6",key:"x1upvd"}],["path",{d:"M10 22h4",key:"ceow96"}]]),q=(0,g.default)("shield",[["path",{d:"M20 13c0 5-3.5 7.5-7.66 8.95a1 1 0 0 1-.67-.01C7.5 20.5 4 18 4 13V6a1 1 0 0 1 1-1c2 0 4.5-1.2 6.24-2.72a1.17 1.17 0 0 1 1.52 0C14.51 3.81 17 5 19 5a1 1 0 0 1 1 1z",key:"oel41y"}]]),D=(0,g.default)("sparkles",[["path",{d:"M11.017 2.814a1 1 0 0 1 1.966 0l1.051 5.558a2 2 0 0 0 1.594 1.594l5.558 1.051a1 1 0 0 1 0 1.966l-5.558 1.051a2 2 0 0 0-1.594 1.594l-1.051 5.558a1 1 0 0 1-1.966 0l-1.051-5.558a2 2 0 0 0-1.594-1.594l-5.558-1.051a1 1 0 0 1 0-1.966l5.558-1.051a2 2 0 0 0 1.594-1.594z",key:"1s2grr"}],["path",{d:"M20 2v4",key:"1rf3ol"}],["path",{d:"M22 4h-4",key:"gwowj6"}],["circle",{cx:"4",cy:"20",r:"2",key:"6kqj1y"}]]);var E=e.i(73708);let z=(0,g.default)("circle-play",[["path",{d:"M9 9.003a1 1 0 0 1 1.517-.859l4.997 2.997a1 1 0 0 1 0 1.718l-4.997 2.997A1 1 0 0 1 9 14.996z",key:"kmsa83"}],["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}]]),B=(0,g.default)("star-half",[["path",{d:"M12 18.338a2.1 2.1 0 0 0-.987.244L6.396 21.01a.53.53 0 0 1-.77-.56l.881-5.139a2.12 2.12 0 0 0-.611-1.879L2.16 9.795a.53.53 0 0 1 .294-.906l5.165-.755a2.12 2.12 0 0 0 1.597-1.16l2.309-4.679A.53.53 0 0 1 12 2",key:"2ksp49"}]]);var T=e.i(21871),$=e.i(53210),O=e.i(23750),W=e.i(84762),V=e.i(10708),F=e.i(94179);function H({value:e}){let a=Math.max(0,Math.min(5,Math.round(e)));return(0,s.jsx)("div",{className:"flex items-center gap-0.5",children:Array.from({length:5}).map((e,t)=>(0,s.jsx)(A.Star,{className:"h-4 w-4 "+(t<a?"fill-yellow-400 text-yellow-400":"text-muted-foreground")},t))})}function U({productId:e,section:t="all"}){let[r,i]=(0,a.useState)(!0),[n,d]=(0,a.useState)([]),[o,c]=(0,a.useState)([]),[m,u]=(0,a.useState)(!1),[x,h]=(0,a.useState)(!1),[p,g]=(0,a.useState)(5),[f,j]=(0,a.useState)(""),[b,v]=(0,a.useState)(""),[N,y]=(0,a.useState)(""),[w,k]=(0,a.useState)(""),[C,S]=(0,a.useState)(""),[I,L]=(0,a.useState)(""),[M,P]=(0,a.useState)(""),[_,R]=(0,a.useState)([]),[q,D]=(0,a.useState)(!1),[E,z]=(0,a.useState)(null),[B,T]=(0,a.useState)(""),[U,K]=(0,a.useState)(""),[J,G]=(0,a.useState)(""),[Q,X]=(0,a.useState)(!1),[Z,Y]=(0,a.useState)(null),ee=(0,a.useRef)(null),es=(0,a.useMemo)(()=>{let e=n.length,s=0===e?0:n.reduce((e,s)=>e+Number(s.rating||0),0)/e;return{count:e,avg:s}},[n]);async function ea(){if(!b.trim()||b.trim().length<10)return void z("Escribe una reseña más larga");D(!0),z(null);try{let s=new FormData;s.set("productId",String(e)),s.set("rating",String(p)),s.set("title",f),s.set("body",b),s.set("customerName",N),s.set("customerCity",w),s.set("orderId",C),s.set("dni",I),s.set("phone",M),_.slice(0,3).forEach(e=>s.append("photos",e));let a=await fetch("/api/reviews/submit",{method:"POST",body:s}),t=await a.json().catch(()=>null);if(!a.ok)throw Error(String(t?.error||"No se pudo enviar la reseña"));j(""),v(""),R([]);let r=!!t?.verified;z(r?"Reseña enviada. Se marcará como comprador verificado cuando sea aprobada.":"Reseña enviada. Se publicará cuando sea aprobada."),u(!1),await ee.current?.()}catch(e){z(e?.message||"Error enviando reseña")}finally{D(!1)}}async function et(){if(!B.trim()||B.trim().length<8)return void Y("Escribe una pregunta más específica");X(!0),Y(null);try{let s=await fetch("/api/questions/submit",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({productId:e,question:B,askerName:U,askerPhone:J})}),a=await s.json().catch(()=>null);if(!s.ok)throw Error(String(a?.error||"No se pudo enviar la pregunta"));T(""),Y("Pregunta enviada. Se publicará cuando sea respondida/aprobada."),h(!1)}catch(e){Y(e?.message||"Error enviando pregunta")}finally{X(!1)}}return(0,a.useEffect)(()=>{let s=!1;async function a(){i(!0);let[a,t]=await Promise.all([$.supabase.from("product_reviews").select("id, rating, title, body, customer_name, customer_city, verified, created_at, photo_urls").eq("product_id",e).eq("approved",!0).order("created_at",{ascending:!1}).limit(20),$.supabase.from("product_questions").select("id, question, asker_name, created_at, product_answers(id, answer, answered_by, created_at)").eq("product_id",e).eq("published",!0).order("created_at",{ascending:!1}).limit(30)]);s||(d(a.data||[]),c(t.data||[]),i(!1))}return ee.current=a,a(),()=>{s=!0}},[e]),(0,s.jsxs)("div",{className:"space-y-6",children:[("all"===t||"reviews"===t)&&(0,s.jsxs)("div",{className:"space-y-4",children:[(0,s.jsxs)("div",{className:"flex items-start justify-between gap-4",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)("div",{className:"text-lg font-bold",children:"Reseñas"}),(0,s.jsxs)("div",{className:"mt-1 flex items-center gap-2 text-sm",children:[(0,s.jsx)(H,{value:es.avg}),(0,s.jsx)("span",{className:"text-muted-foreground",children:es.count>0?`${es.avg.toFixed(1)} (${es.count} rese\xf1as)`:"Aún no hay reseñas"})]})]}),(0,s.jsx)(F.Badge,{variant:"secondary",children:"Sin cuenta"})]}),r?(0,s.jsx)("div",{className:"text-sm text-muted-foreground",children:"Cargando reseñas..."}):0===n.length?(0,s.jsx)("div",{className:"text-sm text-muted-foreground",children:"Sé el primero en dejar una reseña."}):(0,s.jsx)("div",{className:"space-y-4",children:n.map(e=>(0,s.jsxs)("div",{className:"rounded-xl border bg-card p-4",children:[(0,s.jsxs)("div",{className:"flex items-start justify-between gap-3",children:[(0,s.jsxs)("div",{className:"space-y-1",children:[(0,s.jsxs)("div",{className:"flex items-center gap-2",children:[(0,s.jsx)(H,{value:e.rating}),e.verified?(0,s.jsx)(F.Badge,{children:"Comprador verificado"}):(0,s.jsx)(F.Badge,{variant:"outline",children:"Cliente"})]}),(0,s.jsx)("div",{className:"text-sm font-semibold",children:e.title||"Reseña"}),(0,s.jsx)("div",{className:"text-sm text-muted-foreground whitespace-pre-line",children:e.body})]}),(0,s.jsxs)("div",{className:"text-xs text-muted-foreground text-right",children:[(0,s.jsx)("div",{children:e.customer_name||""}),(0,s.jsx)("div",{children:e.customer_city||""}),(0,s.jsx)("div",{children:new Date(e.created_at).toLocaleDateString()})]})]}),Array.isArray(e.photo_urls)&&e.photo_urls.length>0?(0,s.jsx)("div",{className:"mt-3 flex gap-2 overflow-x-auto",children:e.photo_urls.slice(0,6).map((e,a)=>(0,s.jsx)("img",{src:e,alt:"Foto del cliente",className:"h-20 w-20 rounded-lg border object-cover",loading:"lazy"},a))}):null]},e.id))}),(0,s.jsxs)("div",{className:"pt-2 border-t space-y-3",children:[(0,s.jsxs)("div",{className:"flex items-center justify-between gap-3",children:[(0,s.jsx)("div",{className:"text-sm font-semibold",children:"Dejar una reseña"}),m?(0,s.jsx)(l.Button,{type:"button",variant:"outline",onClick:()=>u(!1),children:"Cancelar"}):(0,s.jsx)(l.Button,{type:"button",variant:"outline",onClick:()=>{z(null),u(!0)},children:"Añadir reseña"})]}),E?(0,s.jsx)("div",{className:"text-sm text-muted-foreground",children:E}):null,m?(0,s.jsxs)("div",{className:"space-y-3",children:[(0,s.jsx)("div",{className:"flex items-center gap-2",children:Array.from({length:5}).map((e,a)=>{let t=a+1,r=t<=p;return(0,s.jsx)("button",{type:"button",onClick:()=>g(t),className:"rounded-md p-1","aria-label":`Puntaje ${t}`,children:(0,s.jsx)(A.Star,{className:"h-5 w-5 "+(r?"fill-yellow-400 text-yellow-400":"text-muted-foreground")})},t)})}),(0,s.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-3",children:[(0,s.jsxs)("div",{className:"space-y-1",children:[(0,s.jsx)(V.Label,{children:"Tu nombre (opcional)"}),(0,s.jsx)(O.Input,{value:N,onChange:e=>y(e.target.value),placeholder:"Ej: Juan"})]}),(0,s.jsxs)("div",{className:"space-y-1",children:[(0,s.jsx)(V.Label,{children:"Ciudad (opcional)"}),(0,s.jsx)(O.Input,{value:w,onChange:e=>k(e.target.value),placeholder:"Ej: Lima"})]}),(0,s.jsxs)("div",{className:"space-y-1 md:col-span-2",children:[(0,s.jsx)(V.Label,{children:"Título (opcional)"}),(0,s.jsx)(O.Input,{value:f,onChange:e=>j(e.target.value),placeholder:"Ej: Excelente calidad"})]}),(0,s.jsxs)("div",{className:"space-y-1 md:col-span-2",children:[(0,s.jsx)(V.Label,{children:"Tu reseña"}),(0,s.jsx)(W.Textarea,{value:b,onChange:e=>v(e.target.value),placeholder:"Cuéntanos tu experiencia..."})]})]}),(0,s.jsxs)("div",{className:"rounded-xl border bg-popover p-4 space-y-2",children:[(0,s.jsx)("div",{className:"text-sm font-semibold",children:"Comprador verificado (opcional)"}),(0,s.jsx)("div",{className:"text-xs text-muted-foreground",children:"Si tienes tu número de pedido, ingrésalo junto con tu DNI y teléfono para marcar la reseña como verificada."}),(0,s.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-3",children:[(0,s.jsxs)("div",{className:"space-y-1",children:[(0,s.jsx)(V.Label,{children:"Pedido ID"}),(0,s.jsx)(O.Input,{value:C,onChange:e=>S(e.target.value),placeholder:"Ej: 123"})]}),(0,s.jsxs)("div",{className:"space-y-1",children:[(0,s.jsx)(V.Label,{children:"DNI"}),(0,s.jsx)(O.Input,{value:I,onChange:e=>L(e.target.value),placeholder:"12345678"})]}),(0,s.jsxs)("div",{className:"space-y-1",children:[(0,s.jsx)(V.Label,{children:"Teléfono"}),(0,s.jsx)(O.Input,{value:M,onChange:e=>P(e.target.value),placeholder:"999999999"})]})]})]}),(0,s.jsxs)("div",{className:"space-y-2",children:[(0,s.jsx)(V.Label,{children:"Fotos (opcional, máx 3)"}),(0,s.jsx)(O.Input,{type:"file",accept:"image/*",multiple:!0,onChange:e=>{R(Array.from(e.target.files||[]).slice(0,3))}}),(0,s.jsx)("div",{className:"text-xs text-muted-foreground",children:"Las fotos se subirán cuando envíes la reseña."})]}),(0,s.jsx)(l.Button,{type:"button",onClick:ea,disabled:q,className:"w-full md:w-auto",children:q?"Enviando...":"Enviar reseña"})]}):null]})]}),("all"===t||"questions"===t)&&(0,s.jsxs)("div",{className:"space-y-4",children:[(0,s.jsxs)("div",{className:"flex items-start justify-between gap-4",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)("div",{className:"text-lg font-bold",children:"Preguntas y respuestas"}),(0,s.jsx)("div",{className:"text-sm text-muted-foreground",children:"Resuelve dudas antes de comprar"})]}),(0,s.jsx)(F.Badge,{variant:"secondary",children:"Sin cuenta"})]}),r?(0,s.jsx)("div",{className:"text-sm text-muted-foreground",children:"Cargando preguntas..."}):0===o.length?(0,s.jsx)("div",{className:"text-sm text-muted-foreground",children:"Aún no hay preguntas publicadas."}):(0,s.jsx)("div",{className:"space-y-3",children:o.map(e=>(0,s.jsxs)("div",{className:"rounded-xl border bg-card p-4",children:[(0,s.jsx)("div",{className:"text-sm font-semibold",children:e.question}),(0,s.jsxs)("div",{className:"mt-1 text-xs text-muted-foreground",children:[e.asker_name?`Por ${e.asker_name} • `:"",new Date(e.created_at).toLocaleDateString()]}),Array.isArray(e.product_answers)&&e.product_answers.length>0?(0,s.jsxs)("div",{className:"mt-3 rounded-lg bg-popover p-3",children:[(0,s.jsx)("div",{className:"text-xs font-semibold",children:"Respuesta"}),(0,s.jsx)("div",{className:"text-sm text-muted-foreground whitespace-pre-line",children:e.product_answers[0].answer})]}):null]},e.id))}),(0,s.jsxs)("div",{className:"pt-2 border-t space-y-3",children:[(0,s.jsxs)("div",{className:"flex items-center justify-between gap-3",children:[(0,s.jsx)("div",{className:"text-sm font-semibold",children:"Hacer una pregunta"}),x?(0,s.jsx)(l.Button,{type:"button",variant:"outline",onClick:()=>h(!1),children:"Cancelar"}):(0,s.jsx)(l.Button,{type:"button",variant:"outline",onClick:()=>{Y(null),h(!0)},children:"Hacer una pregunta"})]}),Z?(0,s.jsx)("div",{className:"text-sm text-muted-foreground",children:Z}):null,x?(0,s.jsxs)("div",{className:"space-y-3",children:[(0,s.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-3",children:[(0,s.jsxs)("div",{className:"space-y-1",children:[(0,s.jsx)(V.Label,{children:"Tu nombre (opcional)"}),(0,s.jsx)(O.Input,{value:U,onChange:e=>K(e.target.value),placeholder:"Ej: Ana"})]}),(0,s.jsxs)("div",{className:"space-y-1",children:[(0,s.jsx)(V.Label,{children:"Teléfono (opcional)"}),(0,s.jsx)(O.Input,{value:J,onChange:e=>G(e.target.value),placeholder:"999999999"})]}),(0,s.jsxs)("div",{className:"space-y-1 md:col-span-2",children:[(0,s.jsx)(V.Label,{children:"Pregunta"}),(0,s.jsx)(W.Textarea,{value:B,onChange:e=>T(e.target.value),placeholder:"Ej: ¿Qué talla recomiendas?"})]})]}),(0,s.jsx)(l.Button,{type:"button",onClick:et,disabled:Q,className:"w-full md:w-auto",children:Q?"Enviando...":"Enviar pregunta"})]}):null]})]})]})}e.i(47167);var K=e.i(34382),J=e.i(15640),G=e.i(26999),Q=e.i(37727);let X=G.Root;G.Trigger;let Z=G.Portal;G.Close;let Y=a.forwardRef(({className:e,...a},t)=>(0,s.jsx)(G.Overlay,{ref:t,className:(0,n.cn)("fixed inset-0 z-50 bg-black/80  data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0",e),...a}));Y.displayName=G.Overlay.displayName;let ee=a.forwardRef(({className:e,children:a,...t},r)=>(0,s.jsxs)(Z,{children:[(0,s.jsx)(Y,{}),(0,s.jsxs)(G.Content,{ref:r,className:(0,n.cn)("fixed left-[50%] top-[50%] z-50 grid w-full max-w-lg translate-x-[-50%] translate-y-[-50%] gap-4 border bg-background p-6 shadow-lg duration-200 data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[state=closed]:slide-out-to-left-1/2 data-[state=closed]:slide-out-to-top-[48%] data-[state=open]:slide-in-from-left-1/2 data-[state=open]:slide-in-from-top-[48%] sm:rounded-lg",e),...t,children:[a,(0,s.jsxs)(G.Close,{className:"absolute right-4 top-4 rounded-sm opacity-70 ring-offset-background transition-opacity hover:opacity-100 focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:pointer-events-none data-[state=open]:bg-accent data-[state=open]:text-muted-foreground",children:[(0,s.jsx)(Q.X,{className:"h-4 w-4"}),(0,s.jsx)("span",{className:"sr-only",children:"Close"})]})]})]}));ee.displayName=G.Content.displayName;let es=({className:e,...a})=>(0,s.jsx)("div",{className:(0,n.cn)("flex flex-col space-y-1.5 text-center sm:text-left",e),...a});es.displayName="DialogHeader";let ea=a.forwardRef(({className:e,...a},t)=>(0,s.jsx)(G.Title,{ref:t,className:(0,n.cn)("text-lg font-semibold leading-none tracking-tight",e),...a}));ea.displayName=G.Title.displayName,a.forwardRef(({className:e,...a},t)=>(0,s.jsx)(G.Description,{ref:t,className:(0,n.cn)("text-sm text-muted-foreground",e),...a})).displayName=G.Description.displayName;var et=e.i(31278),er=e.i(46897),el=e.i(84614),ei=e.i(43432),en=e.i(62870);e.i(83769);var ed=e.i(53492),eo=e.i(3822);let ec=["places"];function em({isOpen:e,onClose:a,product:t,variant:r}){let{isLoaded:l}=(0,K.useLoadScript)({googleMapsApiKey:"AIzaSyDXKR5IfCmDBbWWSqggb-ODoc7gTWKb1-o",libraries:ec});return e?(0,s.jsx)(X,{open:e,onOpenChange:a,children:(0,s.jsx)(ee,{className:"max-w-md w-full p-0 gap-0 overflow-hidden rounded-xl max-h-[90vh] flex flex-col",children:(0,s.jsxs)("div",{className:"overflow-y-auto flex-1 p-6",children:[(0,s.jsx)(es,{className:"mb-4 text-center",children:(0,s.jsxs)(ea,{className:"text-base font-bold uppercase leading-tight",children:["Envíos contraentrega en Lima y ",(0,s.jsx)("br",{})," otras provincias envíos por agencia"]})}),(0,s.jsxs)("div",{className:"mb-6 rounded-lg border bg-blue-50/50 p-3 flex gap-3 items-center",children:[(0,s.jsx)("div",{className:"h-16 w-16 shrink-0 bg-white rounded-md border p-1",children:t?.imagen_url&&(0,s.jsx)("img",{src:t.imagen_url,alt:t.nombre,className:"h-full w-full object-contain"})}),(0,s.jsxs)("div",{className:"flex-1 min-w-0",children:[(0,s.jsxs)("div",{className:"text-sm font-bold text-foreground line-clamp-2",children:[t?.nombre,r&&` - ${r.etiqueta}`]}),(0,s.jsx)("div",{className:"flex items-center gap-2 mt-1",children:(0,s.jsx)("span",{className:"bg-green-500 text-white text-[10px] font-bold px-2 py-0.5 rounded-full",children:"ENVÍO GRATIS"})})]}),(0,s.jsxs)("div",{className:"text-right",children:[t?.precio_antes&&t.precio_antes>t.precio&&(0,s.jsx)("div",{className:"text-xs text-muted-foreground line-through",children:(0,n.formatCurrency)(t.precio_antes)}),(0,s.jsx)("div",{className:"text-lg font-bold text-foreground",children:(0,n.formatCurrency)(r?.precio??t?.precio)})]})]}),l?(0,s.jsx)(ex,{product:t,variant:r,onClose:a}):(0,s.jsx)("div",{className:"flex justify-center py-8",children:(0,s.jsx)(et.Loader2,{className:"h-8 w-8 animate-spin text-primary"})})]})})}):null}let eu=({icon:e,...a})=>(0,s.jsxs)("div",{className:"flex w-full items-center rounded-md border text-sm overflow-hidden h-10 ring-offset-background focus-within:ring-2 focus-within:ring-ring focus-within:ring-offset-2",children:[(0,s.jsx)("div",{className:"flex h-full w-10 items-center justify-center bg-muted/50 border-r",children:(0,s.jsx)(e,{className:"h-4 w-4 text-muted-foreground"})}),(0,s.jsx)("input",{...a,className:`flex h-full w-full bg-background px-3 py-2 placeholder:text-muted-foreground focus:outline-none disabled:cursor-not-allowed disabled:opacity-50 ${a.className||""}`})]});function ex({product:e,variant:t,onClose:r}){let[i,d]=(0,a.useState)(""),[o,c]=(0,a.useState)(""),[m,u]=(0,a.useState)(""),[x,h]=(0,a.useState)(""),[p,g]=(0,a.useState)(""),[f,b]=(0,a.useState)("Lima"),[v,N]=(0,a.useState)(""),[y,w]=(0,a.useState)("lima"),[k,C]=(0,a.useState)(!1),S=Number(t?.precio??e?.precio??0),A=+S,{ready:I,value:L,setValue:M,suggestions:{status:P,data:_},clearSuggestions:R}=(0,J.default)({requestOptions:{componentRestrictions:{country:"pe"}}}),q=async e=>{M(e,!1),R(),h(e)},D=async s=>{s.preventDefault(),C(!0);let a=o.replace(/\D/g,"");if(9!==a.length){alert("El celular debe tener 9 dígitos"),C(!1);return}let l=m.replace(/\D/g,"");if(8!==l.length){alert("El DNI debe tener 8 dígitos"),C(!1);return}let n=[{id:Number(e.id),quantity:1,precio:S,nombre:String(e.nombre),producto_variante_id:t?.id?Number(t.id):null,variante_nombre:t?.etiqueta?String(t.etiqueta):null}],d=`${f}, ${v}. ${L||x}`.trim();(0,ed.buildWhatsAppPreviewMessage)({name:i,dni:l,phone:a,address:d,reference:p,locationLink:"",items:n,subtotal:A,discount:0,total:A,shippingMethod:y});try{let{orderId:e}=await (0,eo.createCheckoutOrder)({name:i,phone:a,dni:l,address:d,reference:p,locationLink:"",items:n,shippingMethod:y}),s=String(e).padStart(6,"0"),t=(0,ed.buildWhatsAppFinalMessage)({orderIdFormatted:s,name:i,dni:l,phone:a,address:d,reference:p,locationLink:"",items:n,subtotal:A,discount:0,total:A,shippingMethod:y}),o=(0,ed.buildWhatsAppUrl)("+51958279604",t);(0,ed.setLastOrderSuccessMarker)(s),window.open(o,"_blank"),r()}catch(e){alert("Error al procesar: "+e.message)}finally{C(!1)}};return(0,s.jsxs)("form",{onSubmit:D,className:"space-y-4",children:[(0,s.jsxs)("div",{className:"space-y-1",children:[(0,s.jsxs)(V.Label,{className:"text-sm font-bold",children:["Nombre y Apellidos ",(0,s.jsx)("span",{className:"text-destructive",children:"*"})]}),(0,s.jsx)(eu,{icon:el.User,required:!0,placeholder:"Ej: Juan Pérez",value:i,onChange:e=>d(e.target.value)})]}),(0,s.jsxs)("div",{className:"space-y-1",children:[(0,s.jsxs)(V.Label,{className:"text-sm font-bold",children:["DNI ",(0,s.jsx)("span",{className:"text-destructive",children:"*"})]}),(0,s.jsx)(eu,{icon:j.CreditCard,required:!0,placeholder:"DNI",maxLength:8,value:m,onChange:e=>u(e.target.value.replace(/\D/g,""))})]}),(0,s.jsxs)("div",{className:"space-y-1",children:[(0,s.jsxs)(V.Label,{className:"text-sm font-bold",children:["Teléfono / Whatsapp ",(0,s.jsx)("span",{className:"text-destructive",children:"*"})]}),(0,s.jsx)(eu,{icon:ei.Phone,required:!0,placeholder:"Ej: 999 999 999",maxLength:11,value:o,onChange:e=>{let s=e.target.value.replace(/\D/g,""),a=s;s.length>3&&(a=s.slice(0,3)+" "+s.slice(3)),s.length>6&&(a=a.slice(0,7)+" "+s.slice(6)),c(a)}})]}),(0,s.jsxs)("div",{className:"space-y-1",children:[(0,s.jsxs)(V.Label,{className:"text-sm font-bold",children:["Provincia ",(0,s.jsx)("span",{className:"text-destructive",children:"*"})]}),(0,s.jsxs)("div",{className:"flex w-full items-center rounded-md border text-sm overflow-hidden h-10 ring-offset-background focus-within:ring-2 focus-within:ring-ring focus-within:ring-offset-2",children:[(0,s.jsx)("div",{className:"flex h-full w-10 items-center justify-center bg-muted/50 border-r",children:(0,s.jsx)(er.MapPin,{className:"h-4 w-4 text-muted-foreground"})}),(0,s.jsxs)(en.Select,{value:f,onValueChange:b,children:[(0,s.jsx)(en.SelectTrigger,{className:"w-full h-full border-0 bg-transparent focus:ring-0 focus:ring-offset-0 rounded-none shadow-none px-3",children:(0,s.jsx)(en.SelectValue,{placeholder:"Selecciona"})}),(0,s.jsxs)(en.SelectContent,{position:"popper",className:"max-h-[200px]",children:[(0,s.jsx)(en.SelectItem,{value:"Amazonas",children:"Amazonas"}),(0,s.jsx)(en.SelectItem,{value:"Áncash",children:"Áncash"}),(0,s.jsx)(en.SelectItem,{value:"Apurímac",children:"Apurímac"}),(0,s.jsx)(en.SelectItem,{value:"Arequipa",children:"Arequipa"}),(0,s.jsx)(en.SelectItem,{value:"Ayacucho",children:"Ayacucho"}),(0,s.jsx)(en.SelectItem,{value:"Cajamarca",children:"Cajamarca"}),(0,s.jsx)(en.SelectItem,{value:"Callao",children:"Callao"}),(0,s.jsx)(en.SelectItem,{value:"Cusco",children:"Cusco"}),(0,s.jsx)(en.SelectItem,{value:"Huancavelica",children:"Huancavelica"}),(0,s.jsx)(en.SelectItem,{value:"Huánuco",children:"Huánuco"}),(0,s.jsx)(en.SelectItem,{value:"Ica",children:"Ica"}),(0,s.jsx)(en.SelectItem,{value:"Junín",children:"Junín"}),(0,s.jsx)(en.SelectItem,{value:"La Libertad",children:"La Libertad"}),(0,s.jsx)(en.SelectItem,{value:"Lambayeque",children:"Lambayeque"}),(0,s.jsx)(en.SelectItem,{value:"Lima",children:"Lima"}),(0,s.jsx)(en.SelectItem,{value:"Lima Provincias",children:"Lima Provincias"}),(0,s.jsx)(en.SelectItem,{value:"Loreto",children:"Loreto"}),(0,s.jsx)(en.SelectItem,{value:"Madre de Dios",children:"Madre de Dios"}),(0,s.jsx)(en.SelectItem,{value:"Moquegua",children:"Moquegua"}),(0,s.jsx)(en.SelectItem,{value:"Pasco",children:"Pasco"}),(0,s.jsx)(en.SelectItem,{value:"Piura",children:"Piura"}),(0,s.jsx)(en.SelectItem,{value:"Puno",children:"Puno"}),(0,s.jsx)(en.SelectItem,{value:"San Martín",children:"San Martín"}),(0,s.jsx)(en.SelectItem,{value:"Tacna",children:"Tacna"}),(0,s.jsx)(en.SelectItem,{value:"Tumbes",children:"Tumbes"}),(0,s.jsx)(en.SelectItem,{value:"Ucayali",children:"Ucayali"})]})]})]})]}),(0,s.jsxs)("div",{className:"space-y-1",children:[(0,s.jsxs)(V.Label,{className:"text-sm font-bold",children:["Distrito o Ciudad ",(0,s.jsx)("span",{className:"text-destructive",children:"*"})]}),(0,s.jsx)(eu,{icon:er.MapPin,required:!0,placeholder:"Ej: Miraflores",value:v,onChange:e=>N(e.target.value)})]}),(0,s.jsxs)("div",{className:"space-y-1 relative",children:[(0,s.jsxs)(V.Label,{className:"text-sm font-bold",children:["Dirección ",(0,s.jsx)("span",{className:"text-destructive",children:"*"})]}),(0,s.jsxs)("div",{className:"flex w-full items-center rounded-md border text-sm overflow-hidden h-10 ring-offset-background focus-within:ring-2 focus-within:ring-ring focus-within:ring-offset-2",children:[(0,s.jsx)("div",{className:"flex h-full w-10 items-center justify-center bg-muted/50 border-r",children:(0,s.jsx)(er.MapPin,{className:"h-4 w-4 text-muted-foreground"})}),(0,s.jsx)("input",{value:L,onChange:e=>M(e.target.value),disabled:!I,placeholder:"Ej: Av. Larco 123",className:"flex h-full w-full bg-background px-3 py-2 placeholder:text-muted-foreground focus:outline-none disabled:cursor-not-allowed disabled:opacity-50"}),"OK"===P&&(0,s.jsx)("ul",{className:"absolute z-10 w-full bg-popover border rounded-md shadow-lg mt-1 max-h-40 overflow-auto",children:_.map(({place_id:e,description:a})=>(0,s.jsx)("li",{onClick:()=>q(a),className:"px-4 py-2 hover:bg-muted cursor-pointer text-xs",children:a},e))})]})]}),(0,s.jsxs)("div",{className:"space-y-1",children:[(0,s.jsx)(V.Label,{className:"text-sm font-bold",children:"Referencia"}),(0,s.jsx)(eu,{icon:er.MapPin,placeholder:"Ej: Al costado del grifo",value:p,onChange:e=>g(e.target.value)})]}),(0,s.jsxs)("div",{children:[(0,s.jsxs)(V.Label,{className:"mb-2 block text-sm font-bold",children:["Método de envió gratuito ",(0,s.jsx)("span",{className:"text-destructive",children:"*"})]}),(0,s.jsxs)("div",{className:"space-y-2",children:[(0,s.jsxs)("label",{className:"flex items-center gap-3 p-3 rounded-lg border cursor-pointer hover:bg-muted/50 transition-colors has-[:checked]:border-primary has-[:checked]:bg-primary/5",children:[(0,s.jsx)("input",{type:"radio",name:"shipping",value:"lima",checked:"lima"===y,onChange:e=>w(e.target.value),className:"h-4 w-4 accent-black"}),(0,s.jsx)("span",{className:"text-sm font-medium",children:"Lima"})]}),(0,s.jsxs)("label",{className:"flex items-center gap-3 p-3 rounded-lg border cursor-pointer hover:bg-muted/50 transition-colors has-[:checked]:border-primary has-[:checked]:bg-primary/5",children:[(0,s.jsx)("input",{type:"radio",name:"shipping",value:"provincia",checked:"provincia"===y,onChange:e=>w(e.target.value),className:"h-4 w-4 accent-black"}),(0,s.jsx)("span",{className:"text-sm font-medium",children:"Provincia"})]})]})]}),(0,s.jsxs)("div",{className:"bg-muted/30 -mx-6 -mb-6 p-4 mt-6 border-t space-y-3",children:[(0,s.jsxs)("div",{className:"space-y-1 text-sm",children:[(0,s.jsxs)("div",{className:"flex justify-between text-muted-foreground",children:[(0,s.jsx)("span",{children:"Subtotal"}),(0,s.jsx)("span",{children:(0,n.formatCurrency)(A)})]}),(0,s.jsxs)("div",{className:"flex justify-between text-muted-foreground",children:[(0,s.jsx)("span",{children:"Envío"}),(0,s.jsx)("span",{children:"Gratis"})]}),(0,s.jsxs)("div",{className:"flex justify-between font-bold text-lg text-foreground pt-2 border-t mt-2",children:[(0,s.jsx)("span",{children:"Total"}),(0,s.jsx)("span",{children:(0,n.formatCurrency)(A)})]})]}),(0,s.jsx)(l.Button,{type:"submit",disabled:k,className:"w-full h-12 text-base font-bold bg-black hover:bg-gray-800 text-white shadow-lg",children:k?(0,s.jsx)(et.Loader2,{className:"animate-spin"}):`CONFIRMO MI PEDIDO POR - ${(0,n.formatCurrency)(A)}`})]})]})}function eh(){let e,g,$,O=(0,r.useParams)(),W=(0,r.useRouter)(),V=O.id,F=(0,a.useMemo)(()=>(function(e){let s=Number(e);if(Number.isFinite(s)&&s>0)return s;let a=String(e).match(/(\d+)(?:\D*)$/);return a&&a[1]?Number(a[1]):0})(V),[V]),H=(0,c.useCartAnimationStore)(e=>e.startAnimation),[K,J]=(0,a.useState)(!0),[G,Q]=(0,a.useState)(null),[X,Z]=(0,a.useState)([]),[Y,ee]=(0,a.useState)([]),[es,ea]=(0,a.useState)(null),[et,er]=(0,a.useState)(!1),[el,ei]=(0,a.useState)([]),en=(0,a.useRef)(null),ed=(0,a.useRef)(null),[eo,ec]=(0,a.useState)(!1),[eu,ex]=(0,a.useState)(!1),[eh,ep]=(0,a.useState)(!1),[eg,ef]=(0,a.useState)(0),[ej,eb]=(0,a.useState)("description"),[ev,eN]=(0,a.useState)(!1),[ey,ew]=(0,a.useState)(!1),{addItem:ek,items:eC,updateQuantity:eS}=(0,o.useCartStore)();(0,a.useEffect)(()=>{if(!eh)return;let e=window.setTimeout(()=>{ep(!1)},1600);return()=>window.clearTimeout(e)},[eh]);let eA=(0,a.useMemo)(()=>{let e=es??null,s=eC.find(s=>s.id===F&&(s.producto_variante_id??null)===e);return s?.quantity||0},[eC,F,es]);async function eI(){if(J(!0),!F){Q(null),J(!1);return}let{producto:e,variantes:s,especificaciones:a}=await (0,m.getProductDetail)(F);Q(e);let t=Array.isArray(s)?s:[];Z(t),t.length>0?ea(e=>null!=e&&t.some(s=>Number(s.id)===Number(e))?e:Number(t[0].id)):ea(null),ee(Array.isArray(a)?a:[]),J(!1)}async function eL(e){er(!0);try{let s=await (0,m.getRecommendedProducts)(e);ei(Array.isArray(s)?s:[])}finally{er(!1)}}(0,a.useEffect)(()=>{V&&eI()},[V]),(0,a.useEffect)(()=>{G?.id&&eL(Number(G.id))},[G?.id]);let eM=(0,a.useMemo)(()=>{let e=((Array.isArray(G?.imagenes)?G.imagenes:[])||[]).filter(Boolean).filter(e=>{let s=String(e||"").toLowerCase();return!(s.endsWith(".mp4")||s.endsWith(".webm")||s.endsWith(".mov")||s.endsWith(".m4v"))}).slice(0,10);if(e.length>0)return e;let s=G?.imagen_url?String(G.imagen_url):"",a=s.toLowerCase();return s&&!(a.endsWith(".mp4")||a.endsWith(".webm")||a.endsWith(".mov")||a.endsWith(".m4v"))?[s]:[]},[G]),eP=(0,a.useMemo)(()=>{let e,s,a=[...((Array.isArray(G?.videos)?G.videos:[])||[]).map(e=>String(e||"").trim()).filter(Boolean),...Array.isArray(G?.imagenes)?G.imagenes.map(e=>String(e||"").trim()).filter(e=>{let s=e.toLowerCase();return s.endsWith(".mp4")||s.endsWith(".webm")||s.endsWith(".mov")||s.endsWith(".m4v")}):[],...G?.imagen_url&&((s=(e=String(G.imagen_url||"").trim()).toLowerCase()).endsWith(".mp4")||s.endsWith(".webm")||s.endsWith(".mov")||s.endsWith(".m4v"))?[e]:[]],t=[];for(let e of a)if(e&&(t.includes(e)||t.push(e),t.length>=6))break;return t},[G]),[e_,eR]=(0,a.useState)(null);if((0,a.useEffect)(()=>{eR(e=>e&&eP.includes(e)?e:eP[0]||null)},[eP.join("|")]),K)return(0,s.jsx)("div",{className:"p-10 text-center text-muted-foreground",children:"Cargando producto..."});if(!G)return(0,s.jsxs)("div",{className:"space-y-4",children:[(0,s.jsxs)(l.Button,{variant:"ghost",className:"gap-2",onClick:()=>W.push("/productos"),children:[(0,s.jsx)(u.ArrowLeft,{className:"h-4 w-4"})," Volver"]}),(0,s.jsxs)("div",{className:"bg-white rounded-xl shadow-sm border p-8 text-center",children:[(0,s.jsx)("p",{className:"text-lg font-semibold",children:"Producto no encontrado"}),(0,s.jsx)("p",{className:"text-sm text-muted-foreground mt-1",children:"Puede que haya sido eliminado o no exista."})]})]});let eq=es&&X.find(e=>Number(e.id)===Number(es))||null,eD=eq?Number(eq.stock??0):Number(G.stock||0),eE=eD>0,ez=eE&&eD<=5,eB=Number(eq?.precio??G?.precio??0),eT=Number(eq?.precio_antes??G?.precio_antes??0),e$=Number.isFinite(eT)&&eT>0&&Number.isFinite(eB)&&eB>0&&eT>eB,eO=e$?Math.round((1-eB/eT)*100):0,eW=e=>{let s=en.current;s&&s.scrollBy({left:e,behavior:"smooth"})},eV=G?.categorias?.nombre?String(G.categorias.nombre):"—",eF=G?.categoria_id?String(G.categoria_id):null,eH=window.location.href,eU=async()=>{try{await navigator.clipboard.writeText(eH),ex(!0),setTimeout(()=>ex(!1),1200)}catch(e){}},eK=async()=>{try{let e=navigator;if(e?.share)return void await e.share({title:String(G?.nombre||"Producto"),text:String(G?.nombre||"Producto"),url:eH})}catch(e){}ec(e=>!e)};return(0,s.jsxs)("div",{className:"space-y-6 max-w-5xl mx-auto pb-24 md:pb-0",children:[(0,s.jsx)(em,{isOpen:ey,onClose:()=>ew(!1),product:G,variant:eq}),(0,s.jsx)("div",{className:"flex items-center justify-between gap-3",children:(0,s.jsx)(l.Button,{variant:"ghost",className:"gap-2",asChild:!0,children:(0,s.jsxs)(t.default,{href:"/productos",children:[(0,s.jsx)(u.ArrowLeft,{className:"h-4 w-4"})," Volver a productos"]})})}),(0,s.jsxs)("div",{className:"text-sm text-muted-foreground",children:[(0,s.jsx)(t.default,{href:"/",className:"hover:underline",children:"Inicio"}),(0,s.jsx)("span",{className:"mx-2",children:"/"}),(0,s.jsx)(t.default,{href:"/productos",className:"hover:underline",children:"Productos"}),(0,s.jsx)("span",{className:"mx-2",children:"/"}),eF?(0,s.jsx)(t.default,{href:`/productos?cat=${encodeURIComponent(eF)}`,className:"hover:underline",children:eV}):(0,s.jsx)("span",{children:eV}),(0,s.jsx)("span",{className:"mx-2",children:"/"}),(0,s.jsx)("span",{className:"text-foreground font-semibold",children:String(G.nombre)})]}),(0,s.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[(0,s.jsxs)("div",{className:"space-y-4",children:[(0,s.jsx)(i.Card,{className:"overflow-hidden shadow-sm border",children:(0,s.jsx)("div",{className:"aspect-square bg-popover relative group",ref:ed,children:ev&&e_?(0,s.jsx)("div",{className:"absolute inset-0 flex items-center justify-center bg-black",children:(0,s.jsx)("video",{src:e_,controls:!0,playsInline:!0,className:"w-full h-full object-contain"},e_)}):(0,s.jsxs)(s.Fragment,{children:[eM.length>0?(0,s.jsx)(d.ProductImageCarousel,{images:eM,alt:G.nombre}):(0,s.jsx)("div",{className:"absolute inset-0 flex items-center justify-center text-muted-foreground",children:"Sin imagen"}),!eE&&(0,s.jsx)("div",{className:"absolute inset-0 bg-foreground/60 flex items-center justify-center",children:(0,s.jsx)("span",{className:"text-sidebar-primary-foreground font-bold",children:"Agotado"})})]})})}),ev&&eP.length>1&&(0,s.jsx)("div",{className:"flex flex-wrap gap-2",children:eP.map((e,a)=>(0,s.jsxs)("button",{type:"button",onClick:()=>eR(e),className:"rounded-lg border px-3 py-2 text-xs font-semibold transition-colors "+(e_===e?"border-primary bg-primary/10":"border-border hover:bg-popover"),children:["Video ",a+1]},e))}),eP.length>0&&(0,s.jsx)(l.Button,{className:`w-full gap-2 h-12 text-base font-bold shadow-md transition-all duration-300 ${ev?"bg-white text-gray-900 border-2 border-gray-200 hover:bg-gray-50 hover:border-gray-300":"bg-gradient-to-r from-red-600 to-red-500 text-white hover:from-red-700 hover:to-red-600 hover:shadow-lg hover:scale-[1.01] border-0"}`,onClick:()=>eN(!ev),children:ev?(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(E.Image,{className:"h-5 w-5"}),"Ver Galería de Fotos"]}):(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(z,{className:"h-5 w-5 animate-pulse"}),"Ver Videos del Producto"]})})]}),(0,s.jsxs)("div",{className:"space-y-4",children:[(0,s.jsx)(i.Card,{className:"shadow-sm border",children:(0,s.jsxs)(i.CardContent,{className:"p-6 space-y-3",children:[(0,s.jsxs)("div",{className:"space-y-1",children:[(0,s.jsx)("div",{className:"flex items-center gap-1 mb-2",children:(0,s.jsx)("div",{className:"flex items-center",children:(g=Math.floor(e=Number(G.calificacion??5)),$=e%1>=.4,(0,s.jsxs)(s.Fragment,{children:[Array.from({length:g}).map((e,a)=>(0,s.jsx)(A.Star,{className:"h-4 w-4 fill-amber-400 text-amber-400"},`full-${a}`)),$&&(0,s.jsx)(B,{className:"h-4 w-4 fill-amber-400 text-amber-400"}),Array.from({length:5-g-!!$}).map((e,a)=>(0,s.jsx)(A.Star,{className:"h-4 w-4 text-muted-foreground/30"},`empty-${a}`)),(0,s.jsx)("span",{className:"text-sm font-semibold text-muted-foreground ml-2",children:e.toFixed(1)})]}))})}),(0,s.jsx)("h1",{className:"text-2xl md:text-3xl font-bold text-foreground",children:G.nombre}),(0,s.jsx)("div",{className:"text-sm text-muted-foreground",children:G.categorias?.nombre?(0,s.jsxs)("span",{children:["Categoría: ",G.categorias.nombre]}):(0,s.jsx)("span",{children:"Categoría: —"})})]}),X.length>0&&(0,s.jsxs)("div",{className:"space-y-2",children:[(0,s.jsx)("div",{className:"text-sm font-semibold text-foreground",children:"Variantes"}),(0,s.jsx)("div",{className:"grid grid-cols-2 sm:grid-cols-3 gap-2",children:X.map(e=>{let a=Number(e.id),t=(es??null)===a,r=Number(e.stock??0);return(0,s.jsxs)("button",{type:"button",onClick:()=>ea(a),className:"rounded-lg border px-3 py-2 text-left transition-colors "+(t?"border-primary bg-primary/10":"border-border hover:bg-popover"),children:[(0,s.jsx)("div",{className:"text-sm font-semibold text-foreground line-clamp-1",children:String(e.etiqueta||"Variante")}),(0,s.jsx)("div",{className:"text-xs text-muted-foreground",children:r>0?`${r} disponibles`:"Sin stock"})]},a)})})]}),(0,s.jsxs)("div",{className:"flex items-center justify-between gap-3",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)("div",{className:"text-sm text-muted-foreground",children:"Precio"}),(0,s.jsxs)("div",{className:"flex items-end gap-3 flex-wrap",children:[(0,s.jsx)("div",{className:"text-3xl font-extrabold text-primary tracking-tight",children:(0,n.formatCurrency)(eB)}),e$&&(0,s.jsxs)("div",{className:"flex items-center gap-2",children:[(0,s.jsx)("div",{className:"text-base text-muted-foreground line-through",children:(0,n.formatCurrency)(eT)}),(0,s.jsxs)("span",{className:"inline-flex items-center rounded-full bg-gradient-to-r from-rose-600 to-orange-500 px-2.5 py-1 text-xs font-extrabold text-white shadow-md ring-1 ring-white/30",children:["-",eO,"%"]})]})]})]}),(0,s.jsxs)("div",{className:"text-right",children:[(0,s.jsx)("div",{className:"text-sm text-muted-foreground",children:"Stock"}),(0,s.jsx)("div",{className:`text-sm font-semibold ${eE?"text-green-700":"text-red-700"}`,children:eE?`${eD} disponibles`:"Sin stock"})]})]}),ez&&(0,s.jsx)("div",{className:"rounded-lg border border-amber-200 bg-amber-50 px-3 py-2 text-sm text-amber-900",children:(0,s.jsxs)("span",{className:"font-semibold",children:["Quedan ",eD," unidades"]})}),(0,s.jsxs)("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-2 rounded-lg border bg-card p-3",children:[(0,s.jsxs)("div",{className:"flex items-center gap-2 text-xs text-muted-foreground",children:[(0,s.jsx)(S.Truck,{className:"h-4 w-4 text-foreground"}),(0,s.jsx)("span",{children:"Entrega gratuita en 24h solo Lima Metropolitana"})]}),(0,s.jsxs)("div",{className:"flex items-center gap-2 text-xs text-muted-foreground",children:[(0,s.jsx)(j.CreditCard,{className:"h-4 w-4 text-foreground"}),(0,s.jsx)("span",{children:"Pago contraentrega / Pagas al recibir tu pedido"})]}),(0,s.jsxs)("div",{className:"flex items-center gap-2 text-xs text-muted-foreground",children:[(0,s.jsx)(N.RefreshCw,{className:"h-4 w-4 text-foreground"}),(0,s.jsx)("span",{children:"Cambios y devoluciones"})]}),(0,s.jsxs)("div",{className:"flex items-center gap-2 text-xs text-muted-foreground",children:[(0,s.jsx)(w.ShieldCheck,{className:"h-4 w-4 text-foreground"}),(0,s.jsx)("span",{children:"Compra segura"})]})]}),eE?0===eA?(0,s.jsxs)("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-2",children:[(0,s.jsxs)(l.Button,{className:"w-full gap-2 h-11 border-2 border-transparent bg-gradient-to-r from-orange-500 to-amber-500 hover:from-orange-600 hover:to-amber-600 text-white shadow-lg transform hover:scale-[1.02] transition-all duration-200 font-extrabold text-base tracking-wide",onClick:()=>ew(!0),children:[(0,s.jsx)("span",{className:"drop-shadow-sm",children:"COMPRAR AHORA"}),(0,s.jsx)(p.ChevronRight,{className:"h-5 w-5 animate-pulse"})]}),(0,s.jsxs)(l.Button,{className:"w-full gap-2 h-11",onClick:()=>{if(ek(G,eq),ed.current&&eM.length>0){let e=ed.current.getBoundingClientRect();H(eM[0],e)}ef(Date.now()),ep(!0)},children:[(0,s.jsx)(C.ShoppingCart,{className:"h-4 w-4"})," Agregar al carrito"]})]}):(0,s.jsxs)("div",{className:"w-full flex items-center justify-between bg-popover rounded-lg p-2",children:[(0,s.jsx)(l.Button,{variant:"ghost",size:"icon",className:"h-10 w-10",onClick:()=>eS(Number(G.id),eA-1,es??null),children:(0,s.jsx)(b.Minus,{className:"h-4 w-4"})}),(0,s.jsxs)("div",{className:"text-center",children:[(0,s.jsx)("div",{className:"text-xs text-muted-foreground",children:"Cantidad"}),(0,s.jsx)("div",{className:"text-lg font-bold",children:eA})]}),(0,s.jsx)(l.Button,{variant:"ghost",size:"icon",className:"h-10 w-10",onClick:()=>eS(Number(G.id),eA+1,es??null),children:(0,s.jsx)(v.Plus,{className:"h-4 w-4"})})]}):(0,s.jsx)(l.Button,{disabled:!0,className:"w-full h-11",children:"Sin stock"}),eE&&eA>0&&(0,s.jsxs)(l.Button,{className:"w-full h-11 border-2 border-transparent bg-gradient-to-r from-orange-500 to-amber-500 hover:from-orange-600 hover:to-amber-600 text-white shadow-lg transform hover:scale-[1.02] transition-all duration-200 font-extrabold text-base tracking-wide",onClick:()=>ew(!0),children:[(0,s.jsx)("span",{className:"drop-shadow-sm",children:"COMPRAR AHORA"}),(0,s.jsx)(p.ChevronRight,{className:"h-5 w-5 animate-pulse"})]}),(0,s.jsxs)("div",{className:"relative pt-2",children:[(0,s.jsxs)(l.Button,{variant:"outline",className:"w-full gap-2 h-11 border-2 border-muted hover:border-primary hover:text-primary transition-colors",onClick:eK,children:[(0,s.jsx)(k,{className:"h-4 w-4"}),"Compartir este producto"]}),eo&&(0,s.jsx)("div",{className:"absolute bottom-full mb-2 left-0 w-full rounded-md border bg-popover p-4 shadow-md animate-in fade-in zoom-in-95 slide-in-from-bottom-2 z-50",children:(0,s.jsxs)("div",{className:"grid grid-cols-2 gap-2",children:[(0,s.jsxs)(l.Button,{variant:"outline",className:"gap-2 w-full",onClick:eU,children:[eu?(0,s.jsx)(x.CheckCircle,{className:"h-4 w-4 text-green-500"}):(0,s.jsx)(f,{className:"h-4 w-4"}),"Copiar"]}),(0,s.jsxs)(l.Button,{variant:"outline",className:"gap-2 w-full",onClick:()=>{let e=`${String(G?.nombre||"Producto")}: ${eH}`,s=`https://api.whatsapp.com/send/?text=${encodeURIComponent(e)}`;window.open(s,"_blank")},children:[(0,s.jsx)(y,{className:"h-4 w-4"}),"WhatsApp"]})]})})]}),(0,s.jsxs)("div",{className:"pt-4 text-xs text-muted-foreground",children:["ID: #",String(G.id).padStart(6,"0")," • ",new Date(G.created_at).toLocaleString()]})]})}),(0,s.jsxs)("div",{className:"mt-12",children:[(0,s.jsxs)("div",{className:"flex flex-wrap items-center justify-center gap-2 mb-8 select-none p-1 bg-muted/30 rounded-full w-fit mx-auto border",children:[G?.descripcion&&(0,s.jsxs)("button",{type:"button",onClick:()=>eb("description"),className:`
                                        relative px-5 py-2 rounded-full text-sm font-medium transition-all duration-200 flex items-center gap-2
                                        ${"description"===ej?"bg-white text-foreground shadow-sm ring-1 ring-border":"text-muted-foreground hover:text-foreground hover:bg-muted/50"}
                                    `,children:[(0,s.jsx)(L,{className:"h-4 w-4"}),(0,s.jsx)("span",{children:"Descripción"})]}),(G?.materiales||G?.tamano||G?.color||G?.cuidados||G?.uso)&&(0,s.jsxs)("button",{type:"button",onClick:()=>eb("details"),className:`
                                        relative px-5 py-2 rounded-full text-sm font-medium transition-all duration-200 flex items-center gap-2
                                        ${"details"===ej?"bg-white text-foreground shadow-sm ring-1 ring-border":"text-muted-foreground hover:text-foreground hover:bg-muted/50"}
                                    `,children:[(0,s.jsx)(D,{className:"h-4 w-4"}),(0,s.jsx)("span",{children:"Detalles"})]}),Y.length>0&&(0,s.jsxs)("button",{type:"button",onClick:()=>eb("specs"),className:`
                                        relative px-5 py-2 rounded-full text-sm font-medium transition-all duration-200 flex items-center gap-2
                                        ${"specs"===ej?"bg-white text-foreground shadow-sm ring-1 ring-border":"text-muted-foreground hover:text-foreground hover:bg-muted/50"}
                                    `,children:[(0,s.jsx)(M,{className:"h-4 w-4"}),(0,s.jsx)("span",{children:"Especificaciones"})]}),(0,s.jsxs)("button",{type:"button",onClick:()=>eb("reviews"),className:`
                                    relative px-5 py-2 rounded-full text-sm font-medium transition-all duration-200 flex items-center gap-2
                                    ${"reviews"===ej?"bg-white text-foreground shadow-sm ring-1 ring-border":"text-muted-foreground hover:text-foreground hover:bg-muted/50"}
                                `,children:[(0,s.jsx)(A.Star,{className:"h-4 w-4"}),(0,s.jsx)("span",{children:"Valoraciones"})]}),(0,s.jsxs)("button",{type:"button",onClick:()=>eb("questions"),className:`
                                    relative px-5 py-2 rounded-full text-sm font-medium transition-all duration-200 flex items-center gap-2
                                    ${"questions"===ej?"bg-white text-foreground shadow-sm ring-1 ring-border":"text-muted-foreground hover:text-foreground hover:bg-muted/50"}
                                `,children:[(0,s.jsx)(I,{className:"h-4 w-4"}),(0,s.jsx)("span",{children:"Preguntas"})]})]}),(0,s.jsxs)("div",{className:"min-h-[300px] animate-in fade-in slide-in-from-bottom-4 duration-500",children:["description"===ej&&G?.descripcion&&(0,s.jsx)("div",{className:"space-y-6 animate-in fade-in zoom-in-95 duration-300",children:(0,s.jsxs)("div",{className:"bg-card border rounded-2xl p-8 shadow-sm relative overflow-hidden",children:[(0,s.jsx)("div",{className:"absolute top-0 right-0 p-8 opacity-5",children:(0,s.jsx)(D,{className:"w-32 h-32 text-primary"})}),(0,s.jsxs)("h3",{className:"text-xl font-bold mb-6 flex items-center gap-2 text-primary",children:[(0,s.jsx)("span",{className:"p-2 bg-primary/10 rounded-lg",children:(0,s.jsx)(L,{className:"h-5 w-5"})}),"Descripción del Producto"]}),(0,s.jsx)("div",{className:"prose prose-sm md:prose-base text-muted-foreground whitespace-pre-line leading-relaxed max-w-none",children:G.descripcion})]})}),"details"===ej&&(0,s.jsx)("div",{className:"space-y-8 animate-in fade-in zoom-in-95 duration-300",children:(0,s.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[G?.materiales&&(0,s.jsxs)("div",{className:"bg-card border rounded-xl p-5 hover:shadow-md transition-shadow duration-300 flex gap-4 items-start group",children:[(0,s.jsx)("div",{className:"p-3 bg-blue-50 dark:bg-blue-900/20 text-blue-600 dark:text-blue-400 rounded-xl group-hover:scale-110 transition-transform",children:(0,s.jsx)(q,{className:"h-6 w-6"})}),(0,s.jsxs)("div",{children:[(0,s.jsx)("h4",{className:"font-semibold text-foreground mb-1",children:"Materiales"}),(0,s.jsx)("p",{className:"text-sm text-muted-foreground leading-relaxed",children:G.materiales})]})]}),G?.tamano&&(0,s.jsxs)("div",{className:"bg-card border rounded-xl p-5 hover:shadow-md transition-shadow duration-300 flex gap-4 items-start group",children:[(0,s.jsx)("div",{className:"p-3 bg-emerald-50 dark:bg-emerald-900/20 text-emerald-600 dark:text-emerald-400 rounded-xl group-hover:scale-110 transition-transform",children:(0,s.jsx)(M,{className:"h-6 w-6"})}),(0,s.jsxs)("div",{children:[(0,s.jsx)("h4",{className:"font-semibold text-foreground mb-1",children:"Medidas"}),(0,s.jsx)("p",{className:"text-sm text-muted-foreground leading-relaxed",children:G.tamano})]})]}),G?.color&&(0,s.jsxs)("div",{className:"bg-card border rounded-xl p-5 hover:shadow-md transition-shadow duration-300 flex gap-4 items-start group",children:[(0,s.jsx)("div",{className:"p-3 bg-purple-50 dark:bg-purple-900/20 text-purple-600 dark:text-purple-400 rounded-xl group-hover:scale-110 transition-transform",children:(0,s.jsx)(P,{className:"h-6 w-6"})}),(0,s.jsxs)("div",{children:[(0,s.jsx)("h4",{className:"font-semibold text-foreground mb-1",children:"Color"}),(0,s.jsx)("p",{className:"text-sm text-muted-foreground leading-relaxed",children:G.color})]})]}),G?.cuidados&&(0,s.jsxs)("div",{className:"bg-card border rounded-xl p-5 hover:shadow-md transition-shadow duration-300 flex gap-4 items-start group",children:[(0,s.jsx)("div",{className:"p-3 bg-sky-50 dark:bg-sky-900/20 text-sky-600 dark:text-sky-400 rounded-xl group-hover:scale-110 transition-transform",children:(0,s.jsx)(_,{className:"h-6 w-6"})}),(0,s.jsxs)("div",{children:[(0,s.jsx)("h4",{className:"font-semibold text-foreground mb-1",children:"Cuidados"}),(0,s.jsx)("p",{className:"text-sm text-muted-foreground leading-relaxed",children:G.cuidados})]})]}),G?.uso&&(0,s.jsxs)("div",{className:"md:col-span-2 bg-card border rounded-xl p-5 hover:shadow-md transition-shadow duration-300 flex gap-4 items-start group",children:[(0,s.jsx)("div",{className:"p-3 bg-amber-50 dark:bg-amber-900/20 text-amber-600 dark:text-amber-400 rounded-xl group-hover:scale-110 transition-transform",children:(0,s.jsx)(R,{className:"h-6 w-6"})}),(0,s.jsxs)("div",{children:[(0,s.jsx)("h4",{className:"font-semibold text-foreground mb-1",children:"Uso Recomendado"}),(0,s.jsx)("p",{className:"text-sm text-muted-foreground leading-relaxed",children:G.uso})]})]})]})}),"specs"===ej&&Y.length>0&&(0,s.jsx)("div",{className:"space-y-8 animate-in fade-in zoom-in-95 duration-300",children:(0,s.jsxs)("div",{className:"rounded-2xl border bg-card overflow-hidden shadow-sm",children:[(0,s.jsx)("div",{className:"bg-muted/50 p-4 border-b",children:(0,s.jsxs)("h3",{className:"font-bold text-foreground flex items-center gap-2",children:[(0,s.jsx)(L,{className:"h-5 w-5 text-muted-foreground"}),"Especificaciones Técnicas"]})}),(0,s.jsx)("div",{className:"divide-y",children:Y.map((e,a)=>(0,s.jsxs)("div",{className:"p-4 flex items-start justify-between gap-4 hover:bg-muted/30 transition-colors",children:[(0,s.jsx)("div",{className:"text-sm font-semibold text-foreground w-1/3",children:String(e.clave||"")}),(0,s.jsx)("div",{className:"text-sm text-muted-foreground text-right w-2/3 whitespace-pre-line",children:String(e.valor||"")})]},e.id))})]})}),"reviews"===ej&&(0,s.jsx)("div",{className:"space-y-6",children:(0,s.jsx)("div",{className:"rounded-2xl border bg-card overflow-hidden shadow-sm p-6 md:p-8",children:(0,s.jsx)(U,{productId:Number(G.id),section:"reviews"})})}),"questions"===ej&&(0,s.jsx)("div",{className:"space-y-6",children:(0,s.jsx)("div",{className:"rounded-2xl border bg-card overflow-hidden shadow-sm p-6 md:p-8",children:(0,s.jsx)(U,{productId:Number(G.id),section:"questions"})})})]})]})]})]}),(0,s.jsxs)("div",{className:"pt-2",children:[(0,s.jsxs)("div",{className:"flex items-end justify-between gap-3",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)("h2",{className:"text-xl md:text-2xl font-bold text-foreground",children:"Más comprados"}),(0,s.jsx)("p",{className:"text-sm text-muted-foreground",children:"Productos populares para completar tu compra"})]}),(0,s.jsx)(t.default,{href:"/productos",className:"text-sm font-semibold text-primary hover:underline",children:"Ver más"})]}),et?(0,s.jsx)("div",{className:"relative mt-4",children:(0,s.jsx)("div",{className:"flex gap-4 overflow-x-auto pb-2",children:Array.from({length:8}).map((e,a)=>(0,s.jsx)("div",{className:"min-w-[220px] max-w-[220px] h-[280px] rounded-xl border bg-card animate-pulse"},a))})}):0===el.length?(0,s.jsx)("div",{className:"mt-4 rounded-xl border bg-card p-6 text-sm text-muted-foreground",children:"No hay recomendaciones disponibles en este momento."}):(0,s.jsxs)("div",{className:"relative mt-4",children:[(0,s.jsx)("div",{className:"absolute left-0 top-0 bottom-0 w-10 bg-gradient-to-r from-background to-transparent pointer-events-none"}),(0,s.jsx)("div",{className:"absolute right-0 top-0 bottom-0 w-10 bg-gradient-to-l from-background to-transparent pointer-events-none"}),(0,s.jsx)("div",{className:"absolute left-2 top-1/2 -translate-y-1/2 z-10 hidden md:block",children:(0,s.jsx)(l.Button,{type:"button",variant:"secondary",size:"icon",className:"h-9 w-9 rounded-full shadow-sm",onClick:()=>eW(-520),"aria-label":"Ver anteriores",children:(0,s.jsx)(h.ChevronLeft,{className:"h-4 w-4"})})}),(0,s.jsx)("div",{className:"absolute right-2 top-1/2 -translate-y-1/2 z-10 hidden md:block",children:(0,s.jsx)(l.Button,{type:"button",variant:"secondary",size:"icon",className:"h-9 w-9 rounded-full shadow-sm",onClick:()=>eW(520),"aria-label":"Ver siguientes",children:(0,s.jsx)(p.ChevronRight,{className:"h-4 w-4"})})}),(0,s.jsx)("div",{ref:en,className:"flex gap-4 overflow-x-auto scroll-smooth snap-x snap-mandatory pb-2",children:el.map(e=>(0,s.jsx)("div",{className:"snap-start min-w-[220px] max-w-[220px]",children:(0,s.jsx)(T.ProductCard,{product:e})},e.id))})]})]}),(0,s.jsx)("div",{className:"md:hidden fixed bottom-0 left-0 right-0 z-40 border-t bg-background/95 backdrop-blur",children:(0,s.jsxs)("div",{className:"max-w-5xl mx-auto px-4 py-3 flex items-center justify-between gap-3",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)("div",{className:"text-xs text-muted-foreground",children:"Precio del producto"}),(0,s.jsx)("div",{className:"text-lg font-extrabold text-primary leading-none",children:(0,n.formatCurrency)(eB)})]}),(0,s.jsxs)("div",{className:"flex gap-2 flex-1",children:[(0,s.jsx)(l.Button,{variant:"outline",size:"icon",className:"h-11 w-11 border-primary text-primary hover:bg-primary hover:text-white transition-colors",disabled:!eE,onClick:()=>{if(ek(G,eq),ed.current&&eM.length>0){let e=ed.current.getBoundingClientRect();H(eM[0],e)}ef(Date.now()),ep(!0)},children:(0,s.jsx)(C.ShoppingCart,{className:"h-5 w-5"})}),(0,s.jsxs)(l.Button,{className:"h-11 flex-1 gap-2 border-2 border-transparent bg-gradient-to-r from-orange-500 to-amber-500 hover:from-orange-600 hover:to-amber-600 text-white shadow-lg font-extrabold text-base tracking-wide",disabled:!eE,onClick:()=>ew(!0),children:["COMPRAR AHORA ",(0,s.jsx)(p.ChevronRight,{className:"h-5 w-5 animate-pulse"})]})]})]})}),eh&&(0,s.jsx)("div",{className:"md:hidden fixed inset-x-0 bottom-20 z-50 flex justify-center px-4",children:(0,s.jsx)("div",{className:"w-full max-w-sm rounded-xl border border-border bg-card shadow-lg p-3 animate-in fade-in slide-in-from-bottom-4 duration-300",children:(0,s.jsxs)("div",{className:"flex items-center gap-3",children:[(0,s.jsx)("div",{className:"h-9 w-9 rounded-full bg-green-100 flex items-center justify-center text-green-700",children:(0,s.jsx)(x.CheckCircle,{className:"h-5 w-5"})}),(0,s.jsx)("div",{className:"flex-1",children:(0,s.jsx)("div",{className:"font-semibold text-foreground leading-snug",children:"Producto añadido al carrito"})})]})},eg)})]})}e.s(["default",()=>eh],71795)}]);