(globalThis.TURBOPACK||(globalThis.TURBOPACK=[])).push(["object"==typeof document?document.currentScript:void 0,87863,27488,e=>{"use strict";var a=e.i(71645),r=e.i(18566),s=e.i(53210);function t({allowedRoles:e}){let t=(0,r.useRouter)(),[i,l]=(0,a.useState)(!0),[n,d]=(0,a.useState)(null),[c,o]=(0,a.useState)(!1);return(0,a.useEffect)(()=>{let a=!1;return async function(){l(!0),o(!1);let r=null;try{let e=await s.supabase.auth.getSession(),a=e?.error;if(a)throw a;r=e?.data?.session??null}catch(a){let e;if((e=String(a?.message||"").toLowerCase()).includes("invalid refresh token")||e.includes("refresh token not found"))try{await s.supabase.auth.signOut()}catch(e){}t.replace("/auth/login");return}if(!r)return t.push("/auth/login");let{data:i}=await s.supabase.from("profiles").select("role").eq("id",r.user.id).maybeSingle(),n=String(i?.role||"worker");if(!a){if(d(n),!e.includes(n)){o(!0),l(!1);return}l(!1)}}(),()=>{a=!0}},[]),{loading:i,role:n,accessDenied:c}}e.s(["useRoleGuard",()=>t],87863);var i=e.i(43476),l=e.i(67881);let n=(0,e.i(75254).default)("shield-alert",[["path",{d:"M20 13c0 5-3.5 7.5-7.66 8.95a1 1 0 0 1-.67-.01C7.5 20.5 4 18 4 13V6a1 1 0 0 1 1-1c2 0 4.5-1.2 6.24-2.72a1.17 1.17 0 0 1 1.52 0C14.51 3.81 17 5 19 5a1 1 0 0 1 1 1z",key:"oel41y"}],["path",{d:"M12 8v4",key:"1got3b"}],["path",{d:"M12 16h.01",key:"1drbdi"}]]);function d({title:e="Acceso Restringido",message:a="No tienes permisos para acceder a esta secci贸n. Esta secci贸n est谩 disponible solo para administradores."}){let s=(0,r.useRouter)();return(0,i.jsxs)("div",{className:"flex flex-col items-center justify-center min-h-[60vh] text-center",children:[(0,i.jsx)("div",{className:"h-20 w-20 bg-red-100 rounded-full flex items-center justify-center mb-6",children:(0,i.jsx)(n,{className:"h-10 w-10 text-red-500"})}),(0,i.jsx)("h1",{className:"text-2xl font-bold text-gray-900 mb-2",children:e}),(0,i.jsx)("p",{className:"text-gray-500 max-w-md mb-6",children:a}),(0,i.jsx)(l.Button,{onClick:()=>s.push("/admin/dashboard"),children:"Volver al Dashboard"})]})}e.s(["AccessDenied",()=>d],27488)},70273,e=>{"use strict";let a=(0,e.i(75254).default)("star",[["path",{d:"M11.525 2.295a.53.53 0 0 1 .95 0l2.31 4.679a2.123 2.123 0 0 0 1.595 1.16l5.166.756a.53.53 0 0 1 .294.904l-3.736 3.638a2.123 2.123 0 0 0-.611 1.878l.882 5.14a.53.53 0 0 1-.771.56l-4.618-2.428a2.122 2.122 0 0 0-1.973 0L6.396 21.01a.53.53 0 0 1-.77-.56l.881-5.139a2.122 2.122 0 0 0-.611-1.879L2.16 9.795a.53.53 0 0 1 .294-.906l5.165-.755a2.122 2.122 0 0 0 1.597-1.16z",key:"r04s7s"}]]);e.s(["Star",()=>a],70273)},86311,e=>{"use strict";let a=(0,e.i(75254).default)("message-square",[["path",{d:"M22 17a2 2 0 0 1-2 2H6.828a2 2 0 0 0-1.414.586l-2.202 2.202A.71.71 0 0 1 2 21.286V5a2 2 0 0 1 2-2h16a2 2 0 0 1 2 2z",key:"18887p"}]]);e.s(["MessageSquare",()=>a],86311)},50965,e=>{"use strict";let a=(0,e.i(75254).default)("shopping-bag",[["path",{d:"M16 10a4 4 0 0 1-8 0",key:"1ltviw"}],["path",{d:"M3.103 6.034h17.794",key:"awc11p"}],["path",{d:"M3.4 5.467a2 2 0 0 0-.4 1.2V20a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2V6.667a2 2 0 0 0-.4-1.2l-2-2.667A2 2 0 0 0 17 2H7a2 2 0 0 0-1.6.8z",key:"o988cm"}]]);e.s(["ShoppingBag",()=>a],50965)},88844,e=>{"use strict";let a=(0,e.i(75254).default)("package",[["path",{d:"M11 21.73a2 2 0 0 0 2 0l7-4A2 2 0 0 0 21 16V8a2 2 0 0 0-1-1.73l-7-4a2 2 0 0 0-2 0l-7 4A2 2 0 0 0 3 8v8a2 2 0 0 0 1 1.73z",key:"1a0edw"}],["path",{d:"M12 22V12",key:"d0xqtd"}],["polyline",{points:"3.29 7 12 12 20.71 7",key:"ousv84"}],["path",{d:"m7.5 4.27 9 5.15",key:"1c824w"}]]);e.s(["Package",()=>a],88844)},61911,e=>{"use strict";let a=(0,e.i(75254).default)("users",[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["path",{d:"M16 3.128a4 4 0 0 1 0 7.744",key:"16gr8j"}],["path",{d:"M22 21v-2a4 4 0 0 0-3-3.87",key:"kshegd"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}]]);e.s(["Users",()=>a],61911)},8374,e=>{"use strict";var a=e.i(43476),r=e.i(18566),s=e.i(87863),t=e.i(27488),i=e.i(22016),l=e.i(53210),n=e.i(75254);let d=(0,n.default)("layout-dashboard",[["rect",{width:"7",height:"9",x:"3",y:"3",rx:"1",key:"10lvy0"}],["rect",{width:"7",height:"5",x:"14",y:"3",rx:"1",key:"16une8"}],["rect",{width:"7",height:"9",x:"14",y:"12",rx:"1",key:"1hutg5"}],["rect",{width:"7",height:"5",x:"3",y:"16",rx:"1",key:"ldoo1y"}]]);var c=e.i(50965),o=e.i(88844),u=e.i(61911);let h=(0,n.default)("circle-alert",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["line",{x1:"12",x2:"12",y1:"8",y2:"12",key:"1pkeuh"}],["line",{x1:"12",x2:"12.01",y1:"16",y2:"16",key:"4dfq90"}]]),m=(0,n.default)("log-out",[["path",{d:"m16 17 5-5-5-5",key:"1bji2h"}],["path",{d:"M21 12H9",key:"dn1m92"}],["path",{d:"M9 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h4",key:"1uf3rs"}]]),x=(0,n.default)("percent",[["line",{x1:"19",x2:"5",y1:"5",y2:"19",key:"1x9vlm"}],["circle",{cx:"6.5",cy:"6.5",r:"2.5",key:"4mh3h7"}],["circle",{cx:"17.5",cy:"17.5",r:"2.5",key:"1mdrzq"}]]);var f=e.i(73708),p=e.i(70273),y=e.i(86311);let b=(0,n.default)("megaphone",[["path",{d:"M11 6a13 13 0 0 0 8.4-2.8A1 1 0 0 1 21 4v12a1 1 0 0 1-1.6.8A13 13 0 0 0 11 14H5a2 2 0 0 1-2-2V8a2 2 0 0 1 2-2z",key:"q8bfy3"}],["path",{d:"M6 14a12 12 0 0 0 2.4 7.2 2 2 0 0 0 3.2-2.4A8 8 0 0 1 10 14",key:"1853fq"}],["path",{d:"M8 6v8",key:"15ugcq"}]]);function g({role:e}){let s=(0,r.useRouter)(),t=async()=>{await l.supabase.auth.signOut(),s.push("/auth/login")},n=[{href:"/admin/dashboard",icon:d,label:"Dashboard",roles:["admin","worker"]},{href:"/admin/pedidos",icon:c.ShoppingBag,label:"Pedidos",roles:["admin","worker"]},{href:"/admin/productos",icon:o.Package,label:"Productos",roles:["admin"]},{href:"/admin/clientes",icon:u.Users,label:"Clientes",roles:["admin"]},{href:"/admin/cupones",icon:x,label:"Cupones",roles:["admin"]},{href:"/admin/banners",icon:f.Image,label:"Banners",roles:["admin"]},{href:"/admin/announcement-bar",icon:b,label:"Announcement Bar",roles:["admin"]},{href:"/admin/resenas",icon:p.Star,label:"Rese帽as",roles:["admin"]},{href:"/admin/preguntas",icon:y.MessageSquare,label:"Preguntas",roles:["admin"]},{href:"/admin/usuarios",icon:u.Users,label:"Usuarios",roles:["admin"]},{href:"/admin/incidencias",icon:h,label:"Incidencias",roles:["admin","worker"]}].filter(a=>a.roles.includes(e));return(0,a.jsxs)("div",{className:"w-64 bg-sidebar h-screen text-sidebar-foreground flex flex-col fixed left-0 top-0 overflow-hidden",children:[(0,a.jsxs)("div",{className:"p-4 border-b border-border shrink-0",children:[(0,a.jsx)("h2",{className:"text-2xl font-bold bg-gradient-to-r from-blue-400 to-purple-500 bg-clip-text text-transparent",children:"CRM Pro"}),(0,a.jsx)("p",{className:"text-xs text-muted-foreground mt-1",children:"admin"===e?"Panel de Administraci贸n":"Panel de Trabajador"})]}),(0,a.jsx)("nav",{className:"flex-1 px-3 py-3 space-y-1 overflow-y-auto overscroll-contain",children:n.map(e=>(0,a.jsxs)(i.default,{href:e.href,className:"flex items-center gap-3 px-3 py-2 text-sm text-muted-foreground hover:bg-sidebar-accent hover:text-sidebar-accent-foreground rounded-lg transition-all",children:[(0,a.jsx)(e.icon,{className:"h-4 w-4"}),(0,a.jsx)("span",{children:e.label})]},e.href))}),(0,a.jsx)("div",{className:"px-3 pb-3 shrink-0",children:(0,a.jsx)("div",{className:"px-3 py-2 rounded-lg text-xs font-medium text-center bg-accent/10 text-accent-foreground border border-border",children:"admin"===e?" Administrador":" Trabajador"})}),(0,a.jsx)("div",{className:"p-3 border-t border-border shrink-0",children:(0,a.jsxs)("button",{onClick:t,className:"flex items-center gap-3 px-3 py-2 w-full text-sm text-destructive hover:bg-destructive/10 rounded-lg transition-all",children:[(0,a.jsx)(m,{className:"h-4 w-4"}),(0,a.jsx)("span",{children:"Cerrar Sesi贸n"})]})})]})}var k=e.i(31278);function v({children:e}){let i=(0,r.usePathname)(),l=(0,s.useRoleGuard)({allowedRoles:["admin","worker"]}),n=i?.includes("/admin/pedidos/")&&i?.endsWith("/ticket");return l.loading?(0,a.jsx)("div",{className:"h-screen w-full flex items-center justify-center bg-background",children:(0,a.jsxs)("div",{className:"flex flex-col items-center gap-2",children:[(0,a.jsx)(k.Loader2,{className:"h-8 w-8 animate-spin text-primary"}),(0,a.jsx)("p",{className:"text-sm text-muted-foreground",children:"Verificando acceso..."})]})}):l.accessDenied?(0,a.jsx)(t.AccessDenied,{}):n?(0,a.jsx)(a.Fragment,{children:e}):(0,a.jsxs)("div",{className:"flex h-screen bg-background",children:[(0,a.jsx)(g,{role:l.role||"worker"}),(0,a.jsx)("main",{className:"flex-1 overflow-y-auto p-8 ml-64",children:(0,a.jsx)("div",{className:"max-w-7xl mx-auto",children:e})})]})}e.s(["default",()=>v],8374)}]);