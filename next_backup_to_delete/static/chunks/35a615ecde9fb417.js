(globalThis.TURBOPACK||(globalThis.TURBOPACK=[])).push(["object"==typeof document?document.currentScript:void 0,70065,e=>{"use strict";var t=e.i(43476),a=e.i(47163);function r({className:e,...r}){return(0,t.jsx)("div",{"data-slot":"card",className:(0,a.cn)("bg-card text-card-foreground flex flex-col gap-6 rounded-xl border py-6 shadow-sm",e),...r})}function s({className:e,...r}){return(0,t.jsx)("div",{"data-slot":"card-header",className:(0,a.cn)("@container/card-header grid auto-rows-min grid-rows-[auto_auto] items-start gap-2 px-6 has-data-[slot=card-action]:grid-cols-[1fr_auto] [.border-b]:pb-6",e),...r})}function i({className:e,...r}){return(0,t.jsx)("div",{"data-slot":"card-title",className:(0,a.cn)("leading-none font-semibold",e),...r})}function o({className:e,...r}){return(0,t.jsx)("div",{"data-slot":"card-content",className:(0,a.cn)("px-6",e),...r})}function n({className:e,...r}){return(0,t.jsx)("div",{"data-slot":"card-footer",className:(0,a.cn)("flex items-center px-6 [.border-t]:pt-6",e),...r})}e.s(["Card",()=>r,"CardContent",()=>o,"CardFooter",()=>n,"CardHeader",()=>s,"CardTitle",()=>i])},78745,e=>{"use strict";let t=(0,e.i(75254).default)("check",[["path",{d:"M20 6 9 17l-5-5",key:"1gmf2c"}]]);e.s(["default",()=>t])},27989,20916,65658,98330,16282,31289,75611,33923,62794,12666,28276,63508,e=>{"use strict";var t=e.i(53210);async function a(e){let a=String(e.role||"worker"),r=String(e.currentUserId||""),{data:s}=await t.supabase.from("pedidos").select("id, total, status, asignado_a, created_at"),i=(s||[]).filter(e=>"Entregado"===e.status),o=i.reduce((e,t)=>e+(Number(t.total)||0),0),n=new Date,l=n.getFullYear(),d=String(n.getMonth()+1).padStart(2,"0"),c=String(n.getDate()).padStart(2,"0"),u=`${l}-${d}-${c}`,p=i.filter(e=>"string"==typeof e.created_at&&e.created_at.startsWith(u)).reduce((e,t)=>e+(Number(t.total)||0),0),m=(s||[]).filter(e=>"Pendiente"===e.status).length,f=(s||[]).filter(e=>["Confirmado","Preparando","Enviado"].includes(e.status)).length,h=i.length,g=(s||[]).filter(e=>e.asignado_a===r&&!["Fallido","Devuelto","Entregado"].includes(e.status)).length,b=0;if("admin"===a){let{count:e}=await t.supabase.from("clientes").select("*",{count:"exact",head:!0});b=e||0}let w=0;if("admin"===a){let{count:e}=await t.supabase.from("productos").select("*",{count:"exact",head:!0}).lt("stock",5);w=e||0}return{totalVentasReales:o,ventasHoy:p,pedidosPendientes:m,pedidosEnProceso:f,pedidosEntregados:h,pedidosAsignados:g,totalClientes:b,productosLowStock:w}}async function r(e){let a=e.from?`${e.from}T00:00:00.000Z`:void 0,r=e.to?`${e.to}T23:59:59.999Z`:void 0,s=t.supabase.from("pedidos").select("id, total, status, created_at, clientes (nombre, telefono, dni)").eq("status","Entregado").order("created_at",{ascending:!1});a&&(s=s.gte("created_at",a)),r&&(s=s.lte("created_at",r));let{data:i,error:o}=await s;if(o)throw o;return i||[]}async function s(e){let a=Number(e.threshold),{data:r,error:s}=await t.supabase.from("productos").select("id, nombre, precio, stock, imagen_url").lt("stock",a).order("stock",{ascending:!0});if(s)throw s;return r||[]}async function i(){let{data:e,error:a}=await t.supabase.from("pedidos").select("id, total, status, created_at, clientes (nombre, telefono, dni)").eq("status","Pendiente").order("created_at",{ascending:!1});if(a)throw a;return e||[]}let o=["Confirmado","Preparando","Enviado"];async function n(e){let a=e.from?`${e.from}T00:00:00.000Z`:void 0,r=e.to?`${e.to}T23:59:59.999Z`:void 0,s=t.supabase.from("pedidos").select("id, total, status, created_at, asignado_a, clientes (nombre, telefono, dni)").in("status",o).order("created_at",{ascending:!1});"all"!==e.status&&(s=s.eq("status",e.status)),a&&(s=s.gte("created_at",a)),r&&(s=s.lte("created_at",r));let{data:i,error:n}=await s;if(n)throw n;return i||[]}async function l(){let{data:e,error:a}=await t.supabase.from("profiles").select("id, email, nombre, role").eq("role","worker");if(a)throw a;return e||[]}async function d(e){let a=String(e.role||"worker"),r=String(e.currentUserId||""),s=t.supabase.from("pedidos").select(`
        *,
        clientes (nombre, telefono, dni)
      `).order("created_at",{ascending:!1});"worker"===a&&(s=s.eq("asignado_a",r));let{data:i,error:o}=await s;if(o){if(String(o.message||"").includes("asignado_a")){let{data:e}=await t.supabase.from("pedidos").select("*, clientes (nombre, telefono, dni)").order("created_at",{ascending:!1});return e||[]}throw o}return await Promise.all((i||[]).map(async e=>{if(e.asignado_a){let{data:a}=await t.supabase.from("profiles").select("id, email, nombre").eq("id",e.asignado_a).single();return{...e,asignado_perfil:a||null}}return{...e,asignado_perfil:null}}))}async function c(e){let a=e.workerId?String(e.workerId):null,{error:r}=await t.supabase.from("pedidos").update({asignado_a:a,fecha_asignacion:a?new Date().toISOString():null}).eq("id",e.pedidoId);if(r)throw r}async function u(e){let{data:a,error:r}=await t.supabase.from("pedidos").select(`
        *,
        clientes (*)
      `).eq("id",e).single();if(r)throw r;let s=null;if(a?.asignado_a){let{data:e}=await t.supabase.from("profiles").select("id, email, nombre").eq("id",a.asignado_a).single();s=e}let i={...a,asignado_perfil:s},{data:o,error:n}=await t.supabase.from("pedido_items").select(`
        *,
        productos (nombre, precio, imagen_url)
      `).eq("pedido_id",e);if(n)throw n;return{pedido:i,items:o||[]}}async function p(e){let a=Number(e.pedidoId),r=String(e.nextStatus||"");if("Confirmado"===r&&!e.stockDescontado){let{data:e,error:r}=await t.supabase.from("pedido_items").select("producto_id, producto_variante_id, cantidad").eq("pedido_id",a);if(r)throw r;for(let a of(e||[]).filter(e=>e.producto_id)){let e=Number(a.producto_id),r=null!=a.producto_variante_id?Number(a.producto_variante_id):null,s=Number(a.cantidad||0);if(e&&!(s<=0))if(r){let{data:e,error:a}=await t.supabase.from("producto_variantes").select("stock").eq("id",r).single();if(a)throw a;let i=Math.max(0,Number(e?.stock??0)-s),{error:o}=await t.supabase.from("producto_variantes").update({stock:i}).eq("id",r);if(o)throw o}else{let{data:a,error:r}=await t.supabase.from("productos").select("stock").eq("id",e).single();if(r)throw r;let i=Math.max(0,Number(a?.stock??0)-s),{error:o}=await t.supabase.from("productos").update({stock:i}).eq("id",e);if(o)throw o}}let{error:s}=await t.supabase.from("pedidos").update({stock_descontado:!0}).eq("id",a);if(s)throw s}let{error:s}=await t.supabase.from("pedidos").update({status:r}).eq("id",a);if(s)throw s}async function m(){let{data:e,error:a}=await t.supabase.from("productos").select("*").order("id",{ascending:!0});if(a)throw a;return e||[]}async function f(e){let{data:a,error:r}=await t.supabase.from("productos").select("*").eq("id",e).single();if(r)throw r;return a}async function h(){let{data:e,error:a}=await t.supabase.from("categorias").select("*");if(a)throw a;return e||[]}async function g(e){let a=String(e.nombre||"").trim(),r=a.toLowerCase().replace(/ /g,"-").replace(/[^\w-]+/g,""),{data:s,error:i}=await t.supabase.from("categorias").insert({nombre:a,slug:r}).select().single();if(i)throw i;return s}async function b(e){let[a,r]=await Promise.all([t.supabase.from("producto_especificaciones").select("*").eq("producto_id",e).order("orden",{ascending:!0}).order("id",{ascending:!0}),t.supabase.from("producto_variantes").select("*").eq("producto_id",e).order("id",{ascending:!0})]);return{specs:a.data||[],variants:r.data||[]}}async function w(e){let a=Array.isArray(e.files)?e.files:[],r=[];for(let e of a){let a=e.name.split(".").pop()||"jpg",s=`${Date.now()}-${Math.random().toString(16).slice(2)}.${a}`,i=`imagenes/${s}`,{error:o}=await t.supabase.storage.from("productos").upload(i,e);if(o)throw o;let{data:n}=t.supabase.storage.from("productos").getPublicUrl(i);n?.publicUrl&&r.push(n.publicUrl)}return r}async function x(e){let a=Array.isArray(e.files)?e.files:[],r=[];for(let e of a){let a=e.name.split(".").pop()||"mp4",s=`${Date.now()}-${Math.random().toString(16).slice(2)}.${a}`,i=`videos/${s}`,{error:o}=await t.supabase.storage.from("productos").upload(i,e,{upsert:!1,contentType:e.type||"video/mp4"});if(o)throw o;let{data:n}=t.supabase.storage.from("productos").getPublicUrl(i);n?.publicUrl&&r.push(n.publicUrl)}return r}async function j(e){let t=await fetch("/api/admin/productos",{method:e.method,headers:{"Content-Type":"application/json",Authorization:`Bearer ${e.accessToken}`},body:JSON.stringify(e.body)}),a=null;try{a=await t.json()}catch(e){a=null}if(!t.ok||!a?.ok)throw Error(String(a?.error||"No se pudo guardar el producto"));return a}async function y(e){let t=await fetch("/api/admin/productos",{method:"DELETE",headers:{"Content-Type":"application/json",Authorization:`Bearer ${e.accessToken}`},body:JSON.stringify({id:e.id})}),a=null;try{a=await t.json()}catch(e){a=null}if(!t.ok||!a?.ok)throw Error(String(a?.error||"No se pudo eliminar"));return a}async function v(){let{data:e,error:a}=await t.supabase.from("profiles").select("id, email, nombre, role, created_at").order("created_at",{ascending:!1});if(a)throw a;return e||[]}async function _(e){let t=await fetch("/api/admin/create-worker",{method:"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${e.accessToken}`},body:JSON.stringify({email:e.email,nombre:e.nombre,password:e.password})}),a=await t.json();if(!t.ok)throw Error(String(a?.error||"Error"));return a}async function S(){let{data:e,error:a}=await t.supabase.from("cupones").select("*").order("created_at",{ascending:!1});if(a)throw a;return e||[]}async function N(e){let{error:a}=await t.supabase.from("cupones").insert(e);if(a)throw a}async function C(e,a){let{error:r}=await t.supabase.from("cupones").update(a).eq("id",e);if(r)throw r}async function T(e){let{error:a}=await t.supabase.from("cupones").delete().eq("id",e);if(a)throw a}async function A(){let{data:e,error:a}=await t.supabase.from("home_banners").select("*").order("orden",{ascending:!0}).order("id",{ascending:!0});if(a)throw a;return e||[]}async function k(e){if(null!=e.id){let{error:a}=await t.supabase.from("home_banners").update(e.payload).eq("id",e.id);if(a)throw a;return}let{error:a}=await t.supabase.from("home_banners").insert(e.payload);if(a)throw a}async function q(e){let{error:a}=await t.supabase.from("home_banners").delete().eq("id",e);if(a)throw a}async function I(){let e=await t.supabase.auth.getSession();return e?.data?.session?.access_token||""}async function P(){let e=await I();if(!e)throw Error("No autorizado");let t=await fetch("/api/admin/announcement-bar",{method:"GET",headers:{Authorization:`Bearer ${e}`}}),a=null;try{a=await t.json()}catch(e){a=null}if(!t.ok||!a?.ok)throw Error(String(a?.error||"No se pudo obtener la configuración"));let r=a?.data||{};return{enabled:!!r.enabled,interval_ms:Number(r.interval_ms)||3500,messages:Array.isArray(r.messages)?r.messages:[]}}async function $(e){let t=await I();if(!t)throw Error("No autorizado");let a=await fetch("/api/admin/announcement-bar",{method:"PUT",headers:{"Content-Type":"application/json",Authorization:`Bearer ${t}`},body:JSON.stringify(e)}),r=null;try{r=await a.json()}catch(e){r=null}if(!a.ok||!r?.ok)throw Error(String(r?.error||"No se pudo guardar"));return r}async function E(){let{data:e,error:a}=await t.supabase.from("pedidos").select("id, status, created_at, clientes (nombre, telefono)").order("created_at",{ascending:!1}).limit(200);if(a)throw a;return e||[]}async function M(){let{data:e,error:a}=await t.supabase.from("incidencias").select("*, pedidos (id, status, created_at, clientes (nombre, telefono))").order("created_at",{ascending:!1});if(a)throw a;return e||[]}async function B(e){let a=String(e.pedidoId||"").trim(),r=Array.isArray(e.files)?e.files:[],s=[];for(let e of r){let r=e.name.split(".").pop()||"jpg",i=`${Date.now()}-${Math.random().toString(16).slice(2)}.${r}`,o=a?`incidencias/${a}`:"incidencias",n=`${o}/${i}`,{error:l}=await t.supabase.storage.from("productos").upload(n,e);if(l)throw l;let{data:d}=t.supabase.storage.from("productos").getPublicUrl(n);d?.publicUrl&&s.push(d.publicUrl)}return s}async function H(e){async function a(a){let r={...e};return a||delete r.fotos,t.supabase.from("incidencias").insert(r)}let r=(await a(!0)).error;if(r&&"string"==typeof r.message&&r.message.toLowerCase().includes("fotos")&&(r=(await a(!1)).error),r)throw Error(r.message)}async function D(e){let{error:a}=await t.supabase.from("incidencias").delete().eq("id",e);if(a)throw a}async function U(){let{data:e,error:a}=await t.supabase.from("product_questions").select("id, product_id, question, asker_name, asker_phone, published, created_at, productos(nombre), product_answers(id, answer, answered_by, created_at, published)").order("created_at",{ascending:!1}).limit(200);if(a)throw a;return e||[]}async function F(e){let{error:a}=await t.supabase.from("product_questions").update({published:e.published}).eq("id",e.id);if(a)throw a}async function L(e){let a=String(e.answer||"").trim(),{data:r}=await t.supabase.auth.getSession(),s=r?.session?.user?.id||null,i=null;if(s){let{data:e}=await t.supabase.from("profiles").select("email, nombre").eq("id",s).maybeSingle();i=String(e?.nombre||e?.email||"Admin")}let{data:o}=await t.supabase.from("product_questions").select("id, product_answers(id)").eq("id",e.questionId).maybeSingle(),n=o&&Array.isArray(o.product_answers)&&o.product_answers.length>0?Number(o.product_answers[0]?.id):null;if(n){let{error:e}=await t.supabase.from("product_answers").update({answer:a,answered_by:i,published:!0}).eq("id",n);if(e)throw e}else{let{error:r}=await t.supabase.from("product_answers").insert({question_id:e.questionId,answer:a,answered_by:i,published:!0});if(r)throw r}let{error:l}=await t.supabase.from("product_questions").update({published:!0}).eq("id",e.questionId);if(l)throw l}async function R(){let{data:e,error:a}=await t.supabase.from("product_reviews").select("id, product_id, rating, title, body, customer_name, customer_city, verified, approved, created_at, productos(nombre)").order("created_at",{ascending:!1}).limit(200);if(a)throw a;return e||[]}async function V(e){let{error:a}=await t.supabase.from("product_reviews").update({approved:e.approved}).eq("id",e.id);if(a)throw a}async function O(e){let{error:a}=await t.supabase.from("product_reviews").delete().eq("id",e);if(a)throw a}async function z(){let{data:e,error:a}=await t.supabase.from("clientes").select("*").order("id",{ascending:!1});if(a)throw a;return e||[]}e.s(["fetchAdminDashboardStats",()=>a,"fetchAdminPedidosEnProceso",()=>n,"fetchAdminPedidosPendientes",()=>i,"fetchAdminStockBajo",()=>s,"fetchAdminVentasEntregadas",()=>r],20916),e.s(["assignPedidoToWorker",()=>c,"fetchAdminWorkers",()=>l,"fetchPedidoDetail",()=>u,"fetchPedidosForRole",()=>d,"updatePedidoStatusWithStock",()=>p],65658),e.s(["createAdminCategoria",()=>g,"deleteAdminProductoViaApi",()=>y,"fetchAdminCategorias",()=>h,"fetchAdminProductoById",()=>f,"fetchAdminProductos",()=>m,"fetchProductoSpecsAndVariants",()=>b,"saveAdminProductoViaApi",()=>j,"uploadProductImages",()=>w,"uploadProductVideos",()=>x],98330),e.s(["createWorkerViaApi",()=>_,"fetchAdminProfiles",()=>v],16282),e.s(["createAdminCupon",()=>N,"deleteAdminCupon",()=>T,"fetchAdminCupones",()=>S,"updateAdminCupon",()=>C],31289),e.s(["deleteHomeBanner",()=>q,"fetchHomeBanners",()=>A,"saveHomeBanner",()=>k],75611),e.s(["fetchAnnouncementBarConfigViaApi",()=>P,"saveAnnouncementBarConfigViaApi",()=>$],33923),e.s(["createIncidencia",()=>H,"deleteIncidencia",()=>D,"fetchIncidencias",()=>M,"fetchPedidosForIncidencias",()=>E,"uploadIncidenciaImages",()=>B],62794),e.s(["fetchAdminQuestions",()=>U,"saveQuestionAnswer",()=>L,"setQuestionPublished",()=>F],12666),e.s(["deleteReview",()=>O,"fetchAdminReviews",()=>R,"setReviewApproved",()=>V],28276),e.s(["fetchAdminClientes",()=>z],63508),e.s([],27989)},47627,e=>{"use strict";var t=e.i(43476),a=e.i(47163);function r({className:e,...r}){return(0,t.jsx)("div",{"data-slot":"table-container",className:"relative w-full overflow-x-auto",children:(0,t.jsx)("table",{"data-slot":"table",className:(0,a.cn)("w-full caption-bottom text-sm",e),...r})})}function s({className:e,...r}){return(0,t.jsx)("thead",{"data-slot":"table-header",className:(0,a.cn)("[&_tr]:border-b",e),...r})}function i({className:e,...r}){return(0,t.jsx)("tbody",{"data-slot":"table-body",className:(0,a.cn)("[&_tr:last-child]:border-0",e),...r})}function o({className:e,...r}){return(0,t.jsx)("tr",{"data-slot":"table-row",className:(0,a.cn)("hover:bg-muted/50 data-[state=selected]:bg-muted border-b transition-colors",e),...r})}function n({className:e,...r}){return(0,t.jsx)("th",{"data-slot":"table-head",className:(0,a.cn)("text-foreground h-10 px-2 text-left align-middle font-medium whitespace-nowrap [&:has([role=checkbox])]:pr-0 [&>[role=checkbox]]:translate-y-[2px]",e),...r})}function l({className:e,...r}){return(0,t.jsx)("td",{"data-slot":"table-cell",className:(0,a.cn)("p-2 align-middle whitespace-nowrap [&:has([role=checkbox])]:pr-0 [&>[role=checkbox]]:translate-y-[2px]",e),...r})}e.s(["Table",()=>r,"TableBody",()=>i,"TableCell",()=>l,"TableHead",()=>n,"TableHeader",()=>s,"TableRow",()=>o])},16715,e=>{"use strict";let t=(0,e.i(75254).default)("refresh-cw",[["path",{d:"M3 12a9 9 0 0 1 9-9 9.75 9.75 0 0 1 6.74 2.74L21 8",key:"v9h5vc"}],["path",{d:"M21 3v5h-5",key:"1q7to0"}],["path",{d:"M21 12a9 9 0 0 1-9 9 9.75 9.75 0 0 1-6.74-2.74L3 16",key:"3uifl3"}],["path",{d:"M8 16H3v5",key:"1cv678"}]]);e.s(["RefreshCw",()=>t],16715)},42484,e=>{"use strict";var t=e.i(43476),a=e.i(71645),r=e.i(87863),s=e.i(27488),i=e.i(67881),o=e.i(70065),n=e.i(23750),l=e.i(10708),d=e.i(47627),c=e.i(52917),u=e.i(62870),p=e.i(16715),m=e.i(7233),f=e.i(27612);let h=(0,e.i(75254).default)("pencil",[["path",{d:"M21.174 6.812a1 1 0 0 0-3.986-3.987L3.842 16.174a2 2 0 0 0-.5.83l-1.321 4.352a.5.5 0 0 0 .623.622l4.353-1.32a2 2 0 0 0 .83-.497z",key:"1a8usu"}],["path",{d:"m15 5 4 4",key:"1mk7zo"}]]);e.i(27989);var g=e.i(31289);function b(e){if(!e)return"";let t=new Date(e);if(Number.isNaN(t.getTime()))return"";let a=t.getFullYear(),r=String(t.getMonth()+1).padStart(2,"0"),s=String(t.getDate()).padStart(2,"0");return`${a}-${r}-${s}`}function w(){let[e,w]=(0,a.useState)(!0),x=(0,r.useRoleGuard)({allowedRoles:["admin"]}),[j,y]=(0,a.useState)([]),[v,_]=(0,a.useState)(!1),[S,N]=(0,a.useState)(!1),[C,T]=(0,a.useState)(null),[A,k]=(0,a.useState)(""),[q,I]=(0,a.useState)("porcentaje"),[P,$]=(0,a.useState)(""),[E,M]=(0,a.useState)("true"),[B,H]=(0,a.useState)("0"),[D,U]=(0,a.useState)(""),[F,L]=(0,a.useState)(""),[R,V]=(0,a.useState)(""),O=(0,a.useCallback)(async()=>{try{let e=await (0,g.fetchAdminCupones)();y(e)}catch(e){console.error("Error fetching cupones:",e),y([])}},[]);function z(){T(null),k(""),I("porcentaje"),$(""),M("true"),H("0"),U(""),L(""),V("")}async function W(){let e=A.trim().toUpperCase();if(!e)return void alert("Ingresa un código");let t=Number(P);if(!Number.isFinite(t)||t<=0)return void alert("Ingresa un valor válido");let a=Number(B);if(!Number.isFinite(a)||a<0)return void alert("Ingresa un mínimo total válido");let r=String(D||"").trim()?Number(D):null;if(null!=r&&(!Number.isFinite(r)||r<1))return void alert("Ingresa un máximo de usos válido");let s={codigo:e,tipo:q,valor:t,activo:"true"===E,min_total:a,max_usos:r,starts_at:function(e){let t=String(e||"").trim();if(!t)return null;let a=new Date(`${t}T00:00:00.000`);return Number.isNaN(a.getTime())?null:a.toISOString()}(F),expires_at:function(e){let t=String(e||"").trim();if(!t)return null;let a=new Date(`${t}T23:59:59.999`);return Number.isNaN(a.getTime())?null:a.toISOString()}(R)};N(!0);try{C?await (0,g.updateAdminCupon)(C.id,s):await (0,g.createAdminCupon)(s),_(!1),z(),await O(),alert("Cupón guardado")}catch(e){console.error("Error saving cupon:",e),alert(e?.message||"No se pudo guardar")}finally{N(!1)}}async function G(e){if(confirm(`Eliminar cup\xf3n ${e.codigo}?`))try{await (0,g.deleteAdminCupon)(e.id),await O()}catch(e){console.error("Error deleting cupon:",e),alert(e?.message||"No se pudo eliminar")}}(0,a.useEffect)(()=>{x.loading||x.accessDenied||(async()=>{w(!0),await O(),w(!1)})()},[x.loading,x.accessDenied,O]);let J=(0,a.useMemo)(()=>({total:j.length,activos:j.filter(e=>e.activo).length}),[j]);return x.loading||e?(0,t.jsx)("div",{className:"p-10",children:"Cargando..."}):x.accessDenied?(0,t.jsx)(s.AccessDenied,{message:"Solo administradores pueden gestionar cupones."}):(0,t.jsxs)("div",{className:"space-y-6",children:[(0,t.jsxs)("div",{className:"flex items-center justify-between",children:[(0,t.jsxs)("div",{children:[(0,t.jsx)("h1",{className:"text-3xl font-bold",children:"Cupones"}),(0,t.jsxs)("p",{className:"text-muted-foreground",children:["Total: ",J.total," | Activos: ",J.activos]})]}),(0,t.jsxs)("div",{className:"flex items-center gap-2",children:[(0,t.jsxs)(i.Button,{variant:"outline",className:"gap-2",onClick:O,children:[(0,t.jsx)(p.RefreshCw,{className:"h-4 w-4"})," Actualizar"]}),(0,t.jsxs)(c.Sheet,{open:v,onOpenChange:_,children:[(0,t.jsx)(c.SheetTrigger,{asChild:!0,children:(0,t.jsxs)(i.Button,{className:"gap-2",onClick:function(){z(),_(!0)},children:[(0,t.jsx)(m.Plus,{className:"h-4 w-4"})," Nuevo"]})}),(0,t.jsxs)(c.SheetContent,{side:"right",className:"w-[90%] sm:max-w-[420px]",children:[(0,t.jsx)(c.SheetHeader,{children:(0,t.jsx)(c.SheetTitle,{children:C?`Editar cup\xf3n`:"Nuevo cupón"})}),(0,t.jsxs)("div",{className:"mt-4 space-y-4",children:[(0,t.jsxs)("div",{className:"space-y-2",children:[(0,t.jsx)(l.Label,{htmlFor:"codigo",children:"Código"}),(0,t.jsx)(n.Input,{id:"codigo",value:A,onChange:e=>k(e.target.value),placeholder:"PROMO10",disabled:S})]}),(0,t.jsxs)("div",{className:"space-y-2",children:[(0,t.jsx)(l.Label,{children:"Tipo"}),(0,t.jsxs)(u.Select,{value:q,onValueChange:e=>I(e),children:[(0,t.jsx)(u.SelectTrigger,{children:(0,t.jsx)(u.SelectValue,{})}),(0,t.jsxs)(u.SelectContent,{children:[(0,t.jsx)(u.SelectItem,{value:"porcentaje",children:"Porcentaje"}),(0,t.jsx)(u.SelectItem,{value:"monto",children:"Monto fijo"})]})]})]}),(0,t.jsxs)("div",{className:"space-y-2",children:[(0,t.jsx)(l.Label,{htmlFor:"valor",children:"Valor"}),(0,t.jsx)(n.Input,{id:"valor",inputMode:"decimal",value:P,onChange:e=>$(e.target.value),placeholder:"porcentaje"===q?"10":"15",disabled:S})]}),(0,t.jsxs)("div",{className:"space-y-2",children:[(0,t.jsx)(l.Label,{children:"Estado"}),(0,t.jsxs)(u.Select,{value:E,onValueChange:e=>M(e),children:[(0,t.jsx)(u.SelectTrigger,{children:(0,t.jsx)(u.SelectValue,{})}),(0,t.jsxs)(u.SelectContent,{children:[(0,t.jsx)(u.SelectItem,{value:"true",children:"Activo"}),(0,t.jsx)(u.SelectItem,{value:"false",children:"Inactivo"})]})]})]}),(0,t.jsxs)("div",{className:"grid grid-cols-2 gap-3",children:[(0,t.jsxs)("div",{className:"space-y-2",children:[(0,t.jsx)(l.Label,{htmlFor:"minTotal",children:"Mínimo total"}),(0,t.jsx)(n.Input,{id:"minTotal",inputMode:"decimal",value:B,onChange:e=>H(e.target.value),disabled:S})]}),(0,t.jsxs)("div",{className:"space-y-2",children:[(0,t.jsx)(l.Label,{htmlFor:"maxUsos",children:"Máx usos"}),(0,t.jsx)(n.Input,{id:"maxUsos",inputMode:"numeric",value:D,onChange:e=>U(e.target.value),placeholder:"(vacío = ilimitado)",disabled:S})]})]}),(0,t.jsxs)("div",{className:"grid grid-cols-2 gap-3",children:[(0,t.jsxs)("div",{className:"space-y-2",children:[(0,t.jsx)(l.Label,{htmlFor:"startsAt",children:"Inicio"}),(0,t.jsx)(n.Input,{id:"startsAt",type:"date",value:F,onChange:e=>L(e.target.value),disabled:S})]}),(0,t.jsxs)("div",{className:"space-y-2",children:[(0,t.jsx)(l.Label,{htmlFor:"expiresAt",children:"Expira"}),(0,t.jsx)(n.Input,{id:"expiresAt",type:"date",value:R,onChange:e=>V(e.target.value),disabled:S})]})]}),(0,t.jsx)("div",{className:"pt-2",children:(0,t.jsx)(i.Button,{className:"w-full",onClick:W,disabled:S,children:S?"Guardando...":"Guardar"})})]})]})]})]})]}),(0,t.jsxs)(o.Card,{children:[(0,t.jsx)(o.CardHeader,{children:(0,t.jsx)(o.CardTitle,{children:"Listado"})}),(0,t.jsx)(o.CardContent,{children:(0,t.jsx)("div",{className:"overflow-x-auto",children:(0,t.jsxs)(d.Table,{children:[(0,t.jsx)(d.TableHeader,{children:(0,t.jsxs)(d.TableRow,{children:[(0,t.jsx)(d.TableHead,{children:"Código"}),(0,t.jsx)(d.TableHead,{children:"Tipo"}),(0,t.jsx)(d.TableHead,{children:"Valor"}),(0,t.jsx)(d.TableHead,{children:"Estado"}),(0,t.jsx)(d.TableHead,{children:"Usos"}),(0,t.jsx)(d.TableHead,{children:"Máx"}),(0,t.jsx)(d.TableHead,{children:"Min"}),(0,t.jsx)(d.TableHead,{children:"Inicio"}),(0,t.jsx)(d.TableHead,{children:"Expira"}),(0,t.jsx)(d.TableHead,{className:"text-right",children:"Acciones"})]})}),(0,t.jsxs)(d.TableBody,{children:[j.map(e=>(0,t.jsxs)(d.TableRow,{children:[(0,t.jsx)(d.TableCell,{className:"font-medium",children:e.codigo}),(0,t.jsx)(d.TableCell,{children:e.tipo}),(0,t.jsx)(d.TableCell,{children:String(e.valor)}),(0,t.jsx)(d.TableCell,{children:e.activo?"Activo":"Inactivo"}),(0,t.jsx)(d.TableCell,{children:e.usos}),(0,t.jsx)(d.TableCell,{children:null==e.max_usos?"∞":e.max_usos}),(0,t.jsx)(d.TableCell,{children:String(e.min_total??0)}),(0,t.jsx)(d.TableCell,{children:b(e.starts_at)||"-"}),(0,t.jsx)(d.TableCell,{children:b(e.expires_at)||"-"}),(0,t.jsx)(d.TableCell,{className:"text-right",children:(0,t.jsxs)("div",{className:"flex items-center justify-end gap-2",children:[(0,t.jsx)(i.Button,{variant:"outline",size:"icon",onClick:()=>{T(e),k(String(e.codigo||"")),I(e.tipo||"porcentaje"),$(String(e.valor??"")),M(e.activo?"true":"false"),H(String(e.min_total??0)),U(null==e.max_usos?"":String(e.max_usos)),L(b(e.starts_at)),V(b(e.expires_at)),_(!0)},children:(0,t.jsx)(h,{className:"h-4 w-4"})}),(0,t.jsx)(i.Button,{variant:"destructive",size:"icon",onClick:()=>G(e),children:(0,t.jsx)(f.Trash2,{className:"h-4 w-4"})})]})})]},e.id)),0===j.length&&(0,t.jsx)(d.TableRow,{children:(0,t.jsx)(d.TableCell,{colSpan:10,className:"text-muted-foreground py-8 text-center",children:"No hay cupones."})})]})]})})})]})]})}e.s(["default",()=>w],42484)}]);