(globalThis.TURBOPACK||(globalThis.TURBOPACK=[])).push(["object"==typeof document?document.currentScript:void 0,70065,e=>{"use strict";var a=e.i(43476),t=e.i(47163);function r({className:e,...r}){return(0,a.jsx)("div",{"data-slot":"card",className:(0,t.cn)("bg-card text-card-foreground flex flex-col gap-6 rounded-xl border py-6 shadow-sm",e),...r})}function s({className:e,...r}){return(0,a.jsx)("div",{"data-slot":"card-header",className:(0,t.cn)("@container/card-header grid auto-rows-min grid-rows-[auto_auto] items-start gap-2 px-6 has-data-[slot=card-action]:grid-cols-[1fr_auto] [.border-b]:pb-6",e),...r})}function i({className:e,...r}){return(0,a.jsx)("div",{"data-slot":"card-title",className:(0,t.cn)("leading-none font-semibold",e),...r})}function n({className:e,...r}){return(0,a.jsx)("div",{"data-slot":"card-content",className:(0,t.cn)("px-6",e),...r})}function o({className:e,...r}){return(0,a.jsx)("div",{"data-slot":"card-footer",className:(0,t.cn)("flex items-center px-6 [.border-t]:pt-6",e),...r})}e.s(["Card",()=>r,"CardContent",()=>n,"CardFooter",()=>o,"CardHeader",()=>s,"CardTitle",()=>i])},27989,20916,65658,98330,16282,31289,75611,33923,62794,12666,28276,63508,e=>{"use strict";var a=e.i(53210);async function t(e){let t=String(e.role||"worker"),r=String(e.currentUserId||""),{data:s}=await a.supabase.from("pedidos").select("id, total, status, asignado_a, created_at"),i=(s||[]).filter(e=>"Entregado"===e.status),n=i.reduce((e,a)=>e+(Number(a.total)||0),0),o=new Date,l=o.getFullYear(),c=String(o.getMonth()+1).padStart(2,"0"),d=String(o.getDate()).padStart(2,"0"),u=`${l}-${c}-${d}`,m=i.filter(e=>"string"==typeof e.created_at&&e.created_at.startsWith(u)).reduce((e,a)=>e+(Number(a.total)||0),0),p=(s||[]).filter(e=>"Pendiente"===e.status).length,h=(s||[]).filter(e=>["Confirmado","Preparando","Enviado"].includes(e.status)).length,f=i.length,g=(s||[]).filter(e=>e.asignado_a===r&&!["Fallido","Devuelto","Entregado"].includes(e.status)).length,x=0;if("admin"===t){let{count:e}=await a.supabase.from("clientes").select("*",{count:"exact",head:!0});x=e||0}let b=0;if("admin"===t){let{count:e}=await a.supabase.from("productos").select("*",{count:"exact",head:!0}).lt("stock",5);b=e||0}return{totalVentasReales:n,ventasHoy:m,pedidosPendientes:p,pedidosEnProceso:h,pedidosEntregados:f,pedidosAsignados:g,totalClientes:x,productosLowStock:b}}async function r(e){let t=e.from?`${e.from}T00:00:00.000Z`:void 0,r=e.to?`${e.to}T23:59:59.999Z`:void 0,s=a.supabase.from("pedidos").select("id, total, status, created_at, clientes (nombre, telefono, dni)").eq("status","Entregado").order("created_at",{ascending:!1});t&&(s=s.gte("created_at",t)),r&&(s=s.lte("created_at",r));let{data:i,error:n}=await s;if(n)throw n;return i||[]}async function s(e){let t=Number(e.threshold),{data:r,error:s}=await a.supabase.from("productos").select("id, nombre, precio, stock, imagen_url").lt("stock",t).order("stock",{ascending:!0});if(s)throw s;return r||[]}async function i(){let{data:e,error:t}=await a.supabase.from("pedidos").select("id, total, status, created_at, clientes (nombre, telefono, dni)").eq("status","Pendiente").order("created_at",{ascending:!1});if(t)throw t;return e||[]}let n=["Confirmado","Preparando","Enviado"];async function o(e){let t=e.from?`${e.from}T00:00:00.000Z`:void 0,r=e.to?`${e.to}T23:59:59.999Z`:void 0,s=a.supabase.from("pedidos").select("id, total, status, created_at, asignado_a, clientes (nombre, telefono, dni)").in("status",n).order("created_at",{ascending:!1});"all"!==e.status&&(s=s.eq("status",e.status)),t&&(s=s.gte("created_at",t)),r&&(s=s.lte("created_at",r));let{data:i,error:o}=await s;if(o)throw o;return i||[]}async function l(){let{data:e,error:t}=await a.supabase.from("profiles").select("id, email, nombre, role").eq("role","worker");if(t)throw t;return e||[]}async function c(e){let t=String(e.role||"worker"),r=String(e.currentUserId||""),s=a.supabase.from("pedidos").select(`
        *,
        clientes (nombre, telefono, dni)
      `).order("created_at",{ascending:!1});"worker"===t&&(s=s.eq("asignado_a",r));let{data:i,error:n}=await s;if(n){if(String(n.message||"").includes("asignado_a")){let{data:e}=await a.supabase.from("pedidos").select("*, clientes (nombre, telefono, dni)").order("created_at",{ascending:!1});return e||[]}throw n}return await Promise.all((i||[]).map(async e=>{if(e.asignado_a){let{data:t}=await a.supabase.from("profiles").select("id, email, nombre").eq("id",e.asignado_a).single();return{...e,asignado_perfil:t||null}}return{...e,asignado_perfil:null}}))}async function d(e){let t=e.workerId?String(e.workerId):null,{error:r}=await a.supabase.from("pedidos").update({asignado_a:t,fecha_asignacion:t?new Date().toISOString():null}).eq("id",e.pedidoId);if(r)throw r}async function u(e){let{data:t,error:r}=await a.supabase.from("pedidos").select(`
        *,
        clientes (*)
      `).eq("id",e).single();if(r)throw r;let s=null;if(t?.asignado_a){let{data:e}=await a.supabase.from("profiles").select("id, email, nombre").eq("id",t.asignado_a).single();s=e}let i={...t,asignado_perfil:s},{data:n,error:o}=await a.supabase.from("pedido_items").select(`
        *,
        productos (nombre, precio, imagen_url)
      `).eq("pedido_id",e);if(o)throw o;return{pedido:i,items:n||[]}}async function m(e){let t=Number(e.pedidoId),r=String(e.nextStatus||"");if("Confirmado"===r&&!e.stockDescontado){let{data:e,error:r}=await a.supabase.from("pedido_items").select("producto_id, producto_variante_id, cantidad").eq("pedido_id",t);if(r)throw r;for(let t of(e||[]).filter(e=>e.producto_id)){let e=Number(t.producto_id),r=null!=t.producto_variante_id?Number(t.producto_variante_id):null,s=Number(t.cantidad||0);if(e&&!(s<=0))if(r){let{data:e,error:t}=await a.supabase.from("producto_variantes").select("stock").eq("id",r).single();if(t)throw t;let i=Math.max(0,Number(e?.stock??0)-s),{error:n}=await a.supabase.from("producto_variantes").update({stock:i}).eq("id",r);if(n)throw n}else{let{data:t,error:r}=await a.supabase.from("productos").select("stock").eq("id",e).single();if(r)throw r;let i=Math.max(0,Number(t?.stock??0)-s),{error:n}=await a.supabase.from("productos").update({stock:i}).eq("id",e);if(n)throw n}}let{error:s}=await a.supabase.from("pedidos").update({stock_descontado:!0}).eq("id",t);if(s)throw s}let{error:s}=await a.supabase.from("pedidos").update({status:r}).eq("id",t);if(s)throw s}async function p(){let{data:e,error:t}=await a.supabase.from("productos").select("*").order("id",{ascending:!0});if(t)throw t;return e||[]}async function h(e){let{data:t,error:r}=await a.supabase.from("productos").select("*").eq("id",e).single();if(r)throw r;return t}async function f(){let{data:e,error:t}=await a.supabase.from("categorias").select("*");if(t)throw t;return e||[]}async function g(e){let t=String(e.nombre||"").trim(),r=t.toLowerCase().replace(/ /g,"-").replace(/[^\w-]+/g,""),{data:s,error:i}=await a.supabase.from("categorias").insert({nombre:t,slug:r}).select().single();if(i)throw i;return s}async function x(e){let[t,r]=await Promise.all([a.supabase.from("producto_especificaciones").select("*").eq("producto_id",e).order("orden",{ascending:!0}).order("id",{ascending:!0}),a.supabase.from("producto_variantes").select("*").eq("producto_id",e).order("id",{ascending:!0})]);return{specs:t.data||[],variants:r.data||[]}}async function b(e){let t=Array.isArray(e.files)?e.files:[],r=[];for(let e of t){let t=e.name.split(".").pop()||"jpg",s=`${Date.now()}-${Math.random().toString(16).slice(2)}.${t}`,i=`imagenes/${s}`,{error:n}=await a.supabase.storage.from("productos").upload(i,e);if(n)throw n;let{data:o}=a.supabase.storage.from("productos").getPublicUrl(i);o?.publicUrl&&r.push(o.publicUrl)}return r}async function v(e){let t=Array.isArray(e.files)?e.files:[],r=[];for(let e of t){let t=e.name.split(".").pop()||"mp4",s=`${Date.now()}-${Math.random().toString(16).slice(2)}.${t}`,i=`videos/${s}`,{error:n}=await a.supabase.storage.from("productos").upload(i,e,{upsert:!1,contentType:e.type||"video/mp4"});if(n)throw n;let{data:o}=a.supabase.storage.from("productos").getPublicUrl(i);o?.publicUrl&&r.push(o.publicUrl)}return r}async function w(e){let a=await fetch("/api/admin/productos",{method:e.method,headers:{"Content-Type":"application/json",Authorization:`Bearer ${e.accessToken}`},body:JSON.stringify(e.body)}),t=null;try{t=await a.json()}catch(e){t=null}if(!a.ok||!t?.ok)throw Error(String(t?.error||"No se pudo guardar el producto"));return t}async function j(e){let a=await fetch("/api/admin/productos",{method:"DELETE",headers:{"Content-Type":"application/json",Authorization:`Bearer ${e.accessToken}`},body:JSON.stringify({id:e.id})}),t=null;try{t=await a.json()}catch(e){t=null}if(!a.ok||!t?.ok)throw Error(String(t?.error||"No se pudo eliminar"));return t}async function y(){let{data:e,error:t}=await a.supabase.from("profiles").select("id, email, nombre, role, created_at").order("created_at",{ascending:!1});if(t)throw t;return e||[]}async function N(e){let a=await fetch("/api/admin/create-worker",{method:"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${e.accessToken}`},body:JSON.stringify({email:e.email,nombre:e.nombre,password:e.password})}),t=await a.json();if(!a.ok)throw Error(String(t?.error||"Error"));return t}async function S(){let{data:e,error:t}=await a.supabase.from("cupones").select("*").order("created_at",{ascending:!1});if(t)throw t;return e||[]}async function _(e){let{error:t}=await a.supabase.from("cupones").insert(e);if(t)throw t}async function C(e,t){let{error:r}=await a.supabase.from("cupones").update(t).eq("id",e);if(r)throw r}async function k(e){let{error:t}=await a.supabase.from("cupones").delete().eq("id",e);if(t)throw t}async function A(){let{data:e,error:t}=await a.supabase.from("home_banners").select("*").order("orden",{ascending:!0}).order("id",{ascending:!0});if(t)throw t;return e||[]}async function q(e){if(null!=e.id){let{error:t}=await a.supabase.from("home_banners").update(e.payload).eq("id",e.id);if(t)throw t;return}let{error:t}=await a.supabase.from("home_banners").insert(e.payload);if(t)throw t}async function P(e){let{error:t}=await a.supabase.from("home_banners").delete().eq("id",e);if(t)throw t}async function I(){let e=await a.supabase.auth.getSession();return e?.data?.session?.access_token||""}async function B(){let e=await I();if(!e)throw Error("No autorizado");let a=await fetch("/api/admin/announcement-bar",{method:"GET",headers:{Authorization:`Bearer ${e}`}}),t=null;try{t=await a.json()}catch(e){t=null}if(!a.ok||!t?.ok)throw Error(String(t?.error||"No se pudo obtener la configuración"));let r=t?.data||{};return{enabled:!!r.enabled,interval_ms:Number(r.interval_ms)||3500,messages:Array.isArray(r.messages)?r.messages:[]}}async function L(e){let a=await I();if(!a)throw Error("No autorizado");let t=await fetch("/api/admin/announcement-bar",{method:"PUT",headers:{"Content-Type":"application/json",Authorization:`Bearer ${a}`},body:JSON.stringify(e)}),r=null;try{r=await t.json()}catch(e){r=null}if(!t.ok||!r?.ok)throw Error(String(r?.error||"No se pudo guardar"));return r}async function T(){let{data:e,error:t}=await a.supabase.from("pedidos").select("id, status, created_at, clientes (nombre, telefono)").order("created_at",{ascending:!1}).limit(200);if(t)throw t;return e||[]}async function $(){let{data:e,error:t}=await a.supabase.from("incidencias").select("*, pedidos (id, status, created_at, clientes (nombre, telefono))").order("created_at",{ascending:!1});if(t)throw t;return e||[]}async function E(e){let t=String(e.pedidoId||"").trim(),r=Array.isArray(e.files)?e.files:[],s=[];for(let e of r){let r=e.name.split(".").pop()||"jpg",i=`${Date.now()}-${Math.random().toString(16).slice(2)}.${r}`,n=t?`incidencias/${t}`:"incidencias",o=`${n}/${i}`,{error:l}=await a.supabase.storage.from("productos").upload(o,e);if(l)throw l;let{data:c}=a.supabase.storage.from("productos").getPublicUrl(o);c?.publicUrl&&s.push(c.publicUrl)}return s}async function F(e){async function t(t){let r={...e};return t||delete r.fotos,a.supabase.from("incidencias").insert(r)}let r=(await t(!0)).error;if(r&&"string"==typeof r.message&&r.message.toLowerCase().includes("fotos")&&(r=(await t(!1)).error),r)throw Error(r.message)}async function z(e){let{error:t}=await a.supabase.from("incidencias").delete().eq("id",e);if(t)throw t}async function V(){let{data:e,error:t}=await a.supabase.from("product_questions").select("id, product_id, question, asker_name, asker_phone, published, created_at, productos(nombre), product_answers(id, answer, answered_by, created_at, published)").order("created_at",{ascending:!1}).limit(200);if(t)throw t;return e||[]}async function M(e){let{error:t}=await a.supabase.from("product_questions").update({published:e.published}).eq("id",e.id);if(t)throw t}async function U(e){let t=String(e.answer||"").trim(),{data:r}=await a.supabase.auth.getSession(),s=r?.session?.user?.id||null,i=null;if(s){let{data:e}=await a.supabase.from("profiles").select("email, nombre").eq("id",s).maybeSingle();i=String(e?.nombre||e?.email||"Admin")}let{data:n}=await a.supabase.from("product_questions").select("id, product_answers(id)").eq("id",e.questionId).maybeSingle(),o=n&&Array.isArray(n.product_answers)&&n.product_answers.length>0?Number(n.product_answers[0]?.id):null;if(o){let{error:e}=await a.supabase.from("product_answers").update({answer:t,answered_by:i,published:!0}).eq("id",o);if(e)throw e}else{let{error:r}=await a.supabase.from("product_answers").insert({question_id:e.questionId,answer:t,answered_by:i,published:!0});if(r)throw r}let{error:l}=await a.supabase.from("product_questions").update({published:!0}).eq("id",e.questionId);if(l)throw l}async function D(){let{data:e,error:t}=await a.supabase.from("product_reviews").select("id, product_id, rating, title, body, customer_name, customer_city, verified, approved, created_at, productos(nombre)").order("created_at",{ascending:!1}).limit(200);if(t)throw t;return e||[]}async function W(e){let{error:t}=await a.supabase.from("product_reviews").update({approved:e.approved}).eq("id",e.id);if(t)throw t}async function R(e){let{error:t}=await a.supabase.from("product_reviews").delete().eq("id",e);if(t)throw t}async function O(){let{data:e,error:t}=await a.supabase.from("clientes").select("*").order("id",{ascending:!1});if(t)throw t;return e||[]}e.s(["fetchAdminDashboardStats",()=>t,"fetchAdminPedidosEnProceso",()=>o,"fetchAdminPedidosPendientes",()=>i,"fetchAdminStockBajo",()=>s,"fetchAdminVentasEntregadas",()=>r],20916),e.s(["assignPedidoToWorker",()=>d,"fetchAdminWorkers",()=>l,"fetchPedidoDetail",()=>u,"fetchPedidosForRole",()=>c,"updatePedidoStatusWithStock",()=>m],65658),e.s(["createAdminCategoria",()=>g,"deleteAdminProductoViaApi",()=>j,"fetchAdminCategorias",()=>f,"fetchAdminProductoById",()=>h,"fetchAdminProductos",()=>p,"fetchProductoSpecsAndVariants",()=>x,"saveAdminProductoViaApi",()=>w,"uploadProductImages",()=>b,"uploadProductVideos",()=>v],98330),e.s(["createWorkerViaApi",()=>N,"fetchAdminProfiles",()=>y],16282),e.s(["createAdminCupon",()=>_,"deleteAdminCupon",()=>k,"fetchAdminCupones",()=>S,"updateAdminCupon",()=>C],31289),e.s(["deleteHomeBanner",()=>P,"fetchHomeBanners",()=>A,"saveHomeBanner",()=>q],75611),e.s(["fetchAnnouncementBarConfigViaApi",()=>B,"saveAnnouncementBarConfigViaApi",()=>L],33923),e.s(["createIncidencia",()=>F,"deleteIncidencia",()=>z,"fetchIncidencias",()=>$,"fetchPedidosForIncidencias",()=>T,"uploadIncidenciaImages",()=>E],62794),e.s(["fetchAdminQuestions",()=>V,"saveQuestionAnswer",()=>U,"setQuestionPublished",()=>M],12666),e.s(["deleteReview",()=>R,"fetchAdminReviews",()=>D,"setReviewApproved",()=>W],28276),e.s(["fetchAdminClientes",()=>O],63508),e.s([],27989)},78745,e=>{"use strict";let a=(0,e.i(75254).default)("check",[["path",{d:"M20 6 9 17l-5-5",key:"1gmf2c"}]]);e.s(["default",()=>a])},84762,e=>{"use strict";var a=e.i(43476),t=e.i(47163);function r({className:e,...r}){return(0,a.jsx)("textarea",{"data-slot":"textarea",className:(0,t.cn)("border-input placeholder:text-muted-foreground focus-visible:border-ring focus-visible:ring-ring/50 aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive dark:bg-input/30 flex field-sizing-content min-h-16 w-full rounded-md border bg-transparent px-3 py-2 text-base shadow-xs transition-[color,box-shadow] outline-none focus-visible:ring-[3px] disabled:cursor-not-allowed disabled:opacity-50 md:text-sm",e),...r})}e.s(["Textarea",()=>r])},56909,e=>{"use strict";let a=(0,e.i(75254).default)("save",[["path",{d:"M15.2 3a2 2 0 0 1 1.4.6l3.8 3.8a2 2 0 0 1 .6 1.4V19a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2z",key:"1c8476"}],["path",{d:"M17 21v-7a1 1 0 0 0-1-1H8a1 1 0 0 0-1 1v7",key:"1ydtos"}],["path",{d:"M7 3v4a1 1 0 0 0 1 1h7",key:"t51u73"}]]);e.s(["Save",()=>a],56909)},66531,e=>{"use strict";let a=(0,e.i(75254).default)("cloud-upload",[["path",{d:"M12 13v8",key:"1l5pq0"}],["path",{d:"M4 14.899A7 7 0 1 1 15.71 8h1.79a4.5 4.5 0 0 1 2.5 8.242",key:"1pljnt"}],["path",{d:"m8 17 4-4 4 4",key:"1quai1"}]]);e.s(["UploadCloud",()=>a],66531)},23787,e=>{"use strict";var a=e.i(43476),t=e.i(71645),r=e.i(53210);e.i(27989);var s=e.i(98330),i=e.i(67881),n=e.i(23750),o=e.i(10708),l=e.i(84762),c=e.i(75254);let d=(0,c.default)("arrow-down",[["path",{d:"M12 5v14",key:"s699le"}],["path",{d:"m19 12-7 7-7-7",key:"1idqje"}]]),u=(0,c.default)("arrow-up",[["path",{d:"m5 12 7-7 7 7",key:"hav0vg"}],["path",{d:"M12 19V5",key:"x0mq9r"}]]);var m=e.i(31278),p=e.i(56909),h=e.i(70273),f=e.i(27612),g=e.i(66531),x=e.i(62870);function b({productToEdit:e,categories:c=[],onSuccess:b,onCancel:v}){let[w,j]=(0,t.useState)(!1),[y,N]=(0,t.useState)(!1),[S,_]=(0,t.useState)(""),[C,k]=(0,t.useState)(""),[A,q]=(0,t.useState)(""),[P,I]=(0,t.useState)(""),[B,L]=(0,t.useState)("5"),[T,$]=(0,t.useState)(""),[E,F]=(0,t.useState)([]),[z,V]=(0,t.useState)(""),[M,U]=(0,t.useState)([]),[D,W]=(0,t.useState)("default"),[R,O]=(0,t.useState)("default"),[G,H]=(0,t.useState)(""),[Z,J]=(0,t.useState)(""),[Q,K]=(0,t.useState)(""),[Y,X]=(0,t.useState)(""),[ee,ea]=(0,t.useState)(""),[et,er]=(0,t.useState)(""),[es,ei]=(0,t.useState)([]),[en,eo]=(0,t.useState)([]),[el,ec]=(0,t.useState)(!1),[ed,eu]=(0,t.useState)(!1),[em,ep]=(0,t.useState)("");function eh(e){let a=[];for(let t of e){let e=String(t||"").trim();if(e&&(a.includes(e)||a.push(e),a.length>=10))break}return a}function ef(e){let a=[];for(let t of e){let e=String(t||"").trim();if(e&&(a.includes(e)||a.push(e),a.length>=6))break}return a}async function eg(e){if(e.target.files&&0!==e.target.files.length)try{N(!0);let a=Array.from(e.target.files),t=Math.max(0,6-M.length),r=a.slice(0,t),i=await (0,s.uploadProductVideos)({files:r}),n=ef([...M,...i]);U(n)}catch(e){alert("Error subiendo video: "+e.message)}finally{N(!1),e.target.value=""}}function ex(e,a){if(e===a||e<0||a<0||e>=E.length||a>=E.length)return;let t=[...E],[r]=t.splice(e,1);t.splice(a,0,r),F(t),t.length>0&&$(t[0])}function eb(e,a){if(e===a||e<0||a<0||e>=M.length||a>=M.length)return;let t=[...M],[r]=t.splice(e,1);t.splice(a,0,r),U(t)}async function ev(){if(em.trim())try{j(!0);let e=await (0,s.createAdminCategoria)({nombre:em});W(e.id.toString()),eu(!1),ep("")}catch(e){alert("Error creando categoría: "+e.message)}finally{j(!1)}}async function ew(e){if(e.target.files&&0!==e.target.files.length)try{N(!0);let a=Array.from(e.target.files).filter(e=>{let a=String(e?.type||"").toLowerCase(),t=String(e?.name||"").toLowerCase();return a?a.startsWith("image/"):t.endsWith(".png")||t.endsWith(".jpg")||t.endsWith(".jpeg")||t.endsWith(".webp")||t.endsWith(".gif")}),t=Math.max(0,10-E.length),r=a.slice(0,t),i=await (0,s.uploadProductImages)({files:r}),n=eh([...E,...i]);F(n),!T&&n.length>0&&$(n[0])}catch(e){alert("Error subiendo imagen: "+e.message)}finally{N(!1),e.target.value=""}}async function ej(a){a.preventDefault(),j(!0);try{let a=await r.supabase.auth.getSession(),t=a?.data?.session?.access_token;if(!t){alert("Tu sesión expiró. Vuelve a iniciar sesión."),j(!1);return}let i=null;if(!e?.categoria_id||el){if(!D||"default"===D){alert("Debes seleccionar una Categoría Principal."),j(!1);return}if(i=D,c.some(e=>String(e.parent_id)===D)&&(!R||"default"===R)){alert("Debes seleccionar una Subcategoría para la nueva categoría seleccionada."),j(!1);return}R&&"default"!==R&&(i=R)}else if(e?.categoria_id)i=e.categoria_id;else{alert("Error de lógica: No hay categoría asignada y no se seleccionó ninguna."),j(!1);return}let n=Number(C);if(!Number.isFinite(n)||n<=0){alert("Ingresa un precio actual válido"),j(!1);return}let o=String(A||"").trim(),l=o?Number(o):null;if(null!=l&&(!Number.isFinite(l)||l<=0)){alert("Ingresa un precio antes válido o déjalo vacío"),j(!1);return}if(null!=l&&l<=n){alert("El precio antes debe ser mayor que el precio actual para mostrar oferta"),j(!1);return}let d=Number(P);if(!Number.isFinite(d)||d<0){alert("Ingresa un stock válido"),j(!1);return}let u=Number(B);if(!Number.isFinite(u)||u<0||u>5){alert("Ingresa una calificación válida (0-5)"),j(!1);return}let m=E.length>0?eh(E):eh([...T?[T]:[]]),p=m.filter(e=>{let a=String(e||"").toLowerCase();return!(a.endsWith(".mp4")||a.endsWith(".webm")||a.endsWith(".mov")||a.endsWith(".m4v"))}),h=m.filter(e=>{let a=String(e||"").toLowerCase();return a.endsWith(".mp4")||a.endsWith(".webm")||a.endsWith(".mov")||a.endsWith(".m4v")}),f=ef([...M,...h]),g=p[0]||T||null,x={nombre:S,precio:n,precio_antes:l,stock:d,calificacion:u,imagen_url:g,imagenes:p,videos:f,descripcion:G.trim()||null,materiales:Z.trim()||null,tamano:Q.trim()||null,color:Y.trim()||null,cuidados:ee.trim()||null,uso:et.trim()||null,categoria_id:i?parseInt(String(i)):null},v=es.map(e=>({clave:String(e.clave||"").trim(),valor:String(e.valor||"").trim(),orden:Number(e.orden||0)})).filter(e=>e.clave.length>0),w=en.map(e=>({etiqueta:String(e.etiqueta||"").trim(),precio:String(e.precio||"").trim(),precio_antes:String(e.precio_antes||"").trim(),stock:String(e.stock||"").trim(),activo:!!e.activo})).filter(e=>e.etiqueta.length>0),y=e?"PUT":"POST",N={product:x,specs:v,variants:w.map(e=>({etiqueta:e.etiqueta,precio:e.precio?Number(e.precio):null,precio_antes:e.precio_antes?Number(e.precio_antes):null,stock:Number(e.stock||0),activo:e.activo}))};e&&(N.id=Number(e.id)),await (0,s.saveAdminProductoViaApi)({accessToken:t,method:y,body:N}),b()}catch(e){alert("Error al guardar: "+e.message)}finally{j(!1)}}return(0,t.useEffect)(()=>{if(e){_(e.nombre||""),k(e.precio?.toString()||""),q(null!=e.precio_antes?String(e.precio_antes):""),I(e.stock?.toString()||""),L(null!=e.calificacion?String(e.calificacion):"5"),$(e.imagen_url||""),H(e.descripcion||""),J(e.materiales||""),K(e.tamano||""),X(e.color||""),ea(e.cuidados||""),er(e.uso||"");let a=Array.isArray(e.imagenes)?e.imagenes:[];F(Array.from(new Set([...e.imagen_url?[e.imagen_url]:[],...a].map(e=>String(e||"").trim()).filter(Boolean))).slice(0,10)),V(""),U(Array.from(new Set((Array.isArray(e.videos)?e.videos:[]).map(e=>String(e||"").trim()).filter(Boolean))).slice(0,6)),e.categoria_id||(W("default"),O("default")),(async()=>{try{let a=Number(e.id);if(!a){ei([]),eo([]);return}let{specs:t,variants:r}=await (0,s.fetchProductoSpecsAndVariants)(a),i=Array.isArray(t)?t.map(e=>({id:Number(e.id),clave:String(e.clave||""),valor:String(e.valor||""),orden:Number(e.orden||0)})):[];ei(i);let n=Array.isArray(r)?r.map(e=>({id:Number(e.id),etiqueta:String(e.etiqueta||""),precio:null!=e.precio?String(e.precio):"",precio_antes:null!=e.precio_antes?String(e.precio_antes):"",stock:String(e.stock??0),activo:!!(e.activo??!0)})):[];eo(n)}catch(e){ei([]),eo([])}})()}else _(""),k(""),q(""),I(""),L("5"),$(""),H(""),J(""),K(""),X(""),ea(""),er(""),F([]),V(""),U([]),W("default"),O("default"),ei([]),eo([])},[e,c]),(0,a.jsxs)("form",{onSubmit:ej,className:"space-y-6 py-4",children:[(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)(o.Label,{htmlFor:"name",children:"Nombre del Producto"}),(0,a.jsx)(n.Input,{id:"name",placeholder:"Ej: Zapatillas Nike Air",required:!0,value:S,onChange:e=>_(e.target.value)})]}),(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)(o.Label,{htmlFor:"descripcion",children:"Descripción (general)"}),(0,a.jsx)(l.Textarea,{id:"descripcion",placeholder:"Descripción completa del producto...",value:G,onChange:e=>H(e.target.value)})]}),(0,a.jsxs)("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-4",children:[(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)(o.Label,{htmlFor:"materiales",children:"Materiales"}),(0,a.jsx)(l.Textarea,{id:"materiales",value:Z,onChange:e=>J(e.target.value)})]}),(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)(o.Label,{htmlFor:"tamano",children:"Tamaño / Medidas"}),(0,a.jsx)(l.Textarea,{id:"tamano",value:Q,onChange:e=>K(e.target.value)})]}),(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)(o.Label,{htmlFor:"color",children:"Color"}),(0,a.jsx)(l.Textarea,{id:"color",value:Y,onChange:e=>X(e.target.value)})]}),(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)(o.Label,{htmlFor:"cuidados",children:"Cuidados"}),(0,a.jsx)(l.Textarea,{id:"cuidados",value:ee,onChange:e=>ea(e.target.value)})]}),(0,a.jsxs)("div",{className:"space-y-2 sm:col-span-2",children:[(0,a.jsx)(o.Label,{htmlFor:"uso",children:"Uso recomendado"}),(0,a.jsx)(l.Textarea,{id:"uso",value:et,onChange:e=>er(e.target.value)})]})]}),(0,a.jsxs)("div",{className:"space-y-3",children:[(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsx)(o.Label,{children:"Ficha técnica (especificaciones)"}),(0,a.jsx)(i.Button,{type:"button",variant:"outline",size:"sm",onClick:()=>ei(e=>[...e,{clave:"",valor:"",orden:e.length}]),children:"Agregar"})]}),0===es.length?(0,a.jsx)("div",{className:"text-sm text-muted-foreground",children:"Sin especificaciones"}):(0,a.jsx)("div",{className:"space-y-2",children:es.slice().sort((e,a)=>Number(e.orden||0)-Number(a.orden||0)).map((e,t)=>(0,a.jsxs)("div",{className:"grid grid-cols-1 sm:grid-cols-12 gap-2 rounded-lg border bg-popover p-3",children:[(0,a.jsxs)("div",{className:"sm:col-span-4",children:[(0,a.jsx)(o.Label,{className:"text-xs",children:"Clave"}),(0,a.jsx)(n.Input,{value:e.clave,onChange:a=>{let t=a.target.value;ei(a=>a.map(a=>a===e?{...a,clave:t}:a))}})]}),(0,a.jsxs)("div",{className:"sm:col-span-6",children:[(0,a.jsx)(o.Label,{className:"text-xs",children:"Valor"}),(0,a.jsx)(n.Input,{value:e.valor,onChange:a=>{let t=a.target.value;ei(a=>a.map(a=>a===e?{...a,valor:t}:a))}})]}),(0,a.jsxs)("div",{className:"sm:col-span-2 flex items-end gap-2",children:[(0,a.jsx)(i.Button,{type:"button",variant:"ghost",size:"icon",className:"h-9 w-9",onClick:()=>ei(a=>a.map(a=>a===e?{...a,orden:Math.max(0,Number(a.orden||0)-1)}:a)),children:(0,a.jsx)(u,{className:"h-4 w-4"})}),(0,a.jsx)(i.Button,{type:"button",variant:"ghost",size:"icon",className:"h-9 w-9",onClick:()=>ei(a=>a.map(a=>a===e?{...a,orden:Number(a.orden||0)+1}:a)),children:(0,a.jsx)(d,{className:"h-4 w-4"})}),(0,a.jsx)(i.Button,{type:"button",variant:"ghost",size:"icon",className:"h-9 w-9",onClick:()=>ei(a=>a.filter(a=>a!==e)),children:(0,a.jsx)(f.Trash2,{className:"h-4 w-4"})})]})]},e.id??`new-${t}`))})]}),(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsx)(o.Label,{children:"Videos (hasta 6)"}),(0,a.jsxs)("span",{className:"text-xs text-muted-foreground",children:[M.length,"/6"]})]}),(0,a.jsx)("div",{className:"flex items-center gap-3",children:(0,a.jsx)(n.Input,{type:"file",accept:"video/mp4,video/webm",multiple:!0,onChange:eg,disabled:y||M.length>=6})}),M.length>0&&(0,a.jsx)("div",{className:"space-y-2",children:M.map((e,t)=>(0,a.jsxs)("div",{className:"flex items-center gap-3 rounded-lg border bg-popover p-2",children:[(0,a.jsx)("div",{className:"h-7 w-7 rounded-md bg-primary text-primary-foreground flex items-center justify-center text-xs font-bold",children:t+1}),(0,a.jsx)("div",{className:"min-w-0 flex-1",children:(0,a.jsx)("p",{className:"text-xs text-muted-foreground truncate",children:e})}),(0,a.jsxs)("div",{className:"flex items-center gap-1",children:[(0,a.jsx)(i.Button,{type:"button",variant:"ghost",size:"icon",className:"h-8 w-8",onClick:()=>eb(t,t-1),disabled:0===t,children:(0,a.jsx)(u,{className:"h-4 w-4"})}),(0,a.jsx)(i.Button,{type:"button",variant:"ghost",size:"icon",className:"h-8 w-8",onClick:()=>eb(t,t+1),disabled:t===M.length-1,children:(0,a.jsx)(d,{className:"h-4 w-4"})}),(0,a.jsx)(i.Button,{type:"button",variant:"ghost",size:"icon",className:"h-8 w-8",onClick:()=>U(a=>a.filter(a=>a!==e)),children:(0,a.jsx)(f.Trash2,{className:"h-4 w-4"})})]})]},`${e}-${t}`))})]}),(0,a.jsxs)("div",{className:"space-y-3",children:[(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsx)(o.Label,{children:"Variantes (talla / color / modelo)"}),(0,a.jsx)(i.Button,{type:"button",variant:"outline",size:"sm",onClick:()=>eo(e=>[...e,{etiqueta:"",precio:"",precio_antes:"",stock:"0",activo:!0}]),children:"Agregar"})]}),0===en.length?(0,a.jsx)("div",{className:"text-sm text-muted-foreground",children:"Sin variantes"}):(0,a.jsx)("div",{className:"space-y-2",children:en.map((e,t)=>(0,a.jsxs)("div",{className:"grid grid-cols-1 sm:grid-cols-12 gap-2 rounded-lg border bg-popover p-3",children:[(0,a.jsxs)("div",{className:"sm:col-span-4",children:[(0,a.jsx)(o.Label,{className:"text-xs",children:"Etiqueta"}),(0,a.jsx)(n.Input,{value:e.etiqueta,onChange:a=>{let t=a.target.value;eo(a=>a.map(a=>a===e?{...a,etiqueta:t}:a))}})]}),(0,a.jsxs)("div",{className:"sm:col-span-2",children:[(0,a.jsx)(o.Label,{className:"text-xs",children:"Precio (opcional)"}),(0,a.jsx)(n.Input,{inputMode:"decimal",value:e.precio,onChange:a=>{let t=a.target.value;eo(a=>a.map(a=>a===e?{...a,precio:t}:a))}})]}),(0,a.jsxs)("div",{className:"sm:col-span-2",children:[(0,a.jsx)(o.Label,{className:"text-xs",children:"Precio antes (opcional)"}),(0,a.jsx)(n.Input,{inputMode:"decimal",value:e.precio_antes,onChange:a=>{let t=a.target.value;eo(a=>a.map(a=>a===e?{...a,precio_antes:t}:a))}})]}),(0,a.jsxs)("div",{className:"sm:col-span-2",children:[(0,a.jsx)(o.Label,{className:"text-xs",children:"Stock"}),(0,a.jsx)(n.Input,{inputMode:"numeric",value:e.stock,onChange:a=>{let t=a.target.value;eo(a=>a.map(a=>a===e?{...a,stock:t}:a))}})]}),(0,a.jsxs)("div",{className:"sm:col-span-2 flex items-end gap-2",children:[(0,a.jsx)(i.Button,{type:"button",variant:"outline",size:"sm",onClick:()=>eo(a=>a.map(a=>a===e?{...a,activo:!a.activo}:a)),children:e.activo?"Activa":"Inactiva"}),(0,a.jsx)(i.Button,{type:"button",variant:"ghost",size:"icon",className:"h-9 w-9",onClick:()=>eo(a=>a.filter(a=>a!==e)),children:(0,a.jsx)(f.Trash2,{className:"h-4 w-4"})})]})]},e.id??`vnew-${t}`))})]}),(0,a.jsxs)("div",{className:"grid grid-cols-1 sm:grid-cols-3 gap-4",children:[(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)(o.Label,{htmlFor:"price",children:"Precio actual (S/)"}),(0,a.jsx)(n.Input,{id:"price",type:"number",step:"0.01",required:!0,placeholder:"0.00",value:C,onChange:e=>k(e.target.value)})]}),(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)(o.Label,{htmlFor:"priceBefore",children:"Precio antes (S/) (opcional)"}),(0,a.jsx)(n.Input,{id:"priceBefore",type:"number",step:"0.01",placeholder:"0.00",value:A,onChange:e=>q(e.target.value)})]}),(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)(o.Label,{htmlFor:"stock",children:"Stock (Unidades)"}),(0,a.jsx)(n.Input,{id:"stock",type:"number",required:!0,placeholder:"10",value:P,onChange:e=>I(e.target.value)})]}),(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)(o.Label,{htmlFor:"calificacion",children:"Calificación (0-5)"}),(0,a.jsx)(n.Input,{id:"calificacion",type:"number",step:"0.1",min:"0",max:"5",required:!0,placeholder:"5.0",value:B,onChange:e=>L(e.target.value)})]})]}),(0,a.jsx)("div",{className:"space-y-2",children:(()=>{let t=!!e?.categoria_id,r="",s="";if(t&&c.length>0){let a=String(e.categoria_id),t=c.find(e=>String(e.id)===a);if(t)if(t.parent_id){let e=c.find(e=>String(e.id)===String(t.parent_id));r=e?.nombre||"...",s=t.nombre}else r=t.nombre}return(0,a.jsxs)("div",{className:"space-y-4",children:[t&&(0,a.jsxs)("div",{className:"p-4 border rounded-md bg-muted/40",children:[(0,a.jsx)(o.Label,{className:"text-sm font-semibold mb-2 block",children:"Categoría Asignada (Actual)"}),(0,a.jsxs)("div",{className:"flex items-center gap-2 text-sm",children:[(0,a.jsx)("span",{className:"bg-primary/10 text-primary px-3 py-1 rounded-full font-medium",children:r||"Desconocida"}),s&&(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)("span",{className:"text-muted-foreground",children:"/"}),(0,a.jsx)("span",{className:"bg-secondary text-secondary-foreground px-3 py-1 rounded-full font-medium",children:s})]})]}),(0,a.jsx)("div",{className:"mt-4",children:(0,a.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,a.jsx)("input",{type:"checkbox",id:"changeCat",className:"h-4 w-4 rounded border-gray-300 text-primary focus:ring-primary",checked:el,onChange:e=>ec(e.target.checked)}),(0,a.jsx)(o.Label,{htmlFor:"changeCat",className:"font-normal cursor-pointer select-none",children:"Quiero cambiar la categoría actual"})]})})]}),(!t||el)&&(0,a.jsxs)("div",{className:`space-y-4 ${t?"p-4 border border-dashed rounded-md bg-background animate-in fade-in zoom-in-95 duration-200":""}`,children:[t&&(0,a.jsx)(o.Label,{className:"text-sm font-semibold text-primary",children:"Seleccionar Nueva Categoría"}),(0,a.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[(0,a.jsxs)("div",{className:"space-y-1",children:[(0,a.jsxs)(o.Label,{className:"text-xs text-muted-foreground",children:["Categoría Principal ",t?"(Nueva)":""]}),(0,a.jsxs)(x.Select,{value:D,onValueChange:e=>{W(e),O("default")},children:[(0,a.jsx)(x.SelectTrigger,{children:(0,a.jsx)(x.SelectValue,{placeholder:"Seleccionar Principal"})}),(0,a.jsxs)(x.SelectContent,{children:[(0,a.jsx)(x.SelectItem,{value:"default",children:"Seleccionar..."}),c.filter(e=>!e.parent_id).sort((e,a)=>e.nombre.localeCompare(a.nombre)).map(e=>(0,a.jsx)(x.SelectItem,{value:String(e.id),children:e.nombre},e.id))]})]})]}),(0,a.jsxs)("div",{className:"space-y-1",children:[(0,a.jsx)(o.Label,{className:"text-xs text-muted-foreground",children:"Subcategoría (Opcional)"}),(0,a.jsxs)(x.Select,{value:R,onValueChange:O,disabled:"default"===D||!c.some(e=>String(e.parent_id)===D),children:[(0,a.jsx)(x.SelectTrigger,{children:(0,a.jsx)(x.SelectValue,{placeholder:"Seleccionar Subcategoría"})}),(0,a.jsxs)(x.SelectContent,{children:[(0,a.jsx)(x.SelectItem,{value:"default",children:"Ninguna"}),c.filter(e=>String(e.parent_id)===D).sort((e,a)=>e.nombre.localeCompare(a.nombre)).map(e=>(0,a.jsx)(x.SelectItem,{value:String(e.id),children:e.nombre},e.id))]})]})]})]}),ed?(0,a.jsxs)("div",{className:"flex gap-2 mt-2",children:[(0,a.jsx)(n.Input,{placeholder:"Nombre nueva categoría...",value:em,onChange:e=>ep(e.target.value),className:"flex-1"}),(0,a.jsx)(i.Button,{type:"button",size:"sm",onClick:ev,disabled:!em.trim()||w,children:(0,a.jsx)(p.Save,{className:"h-4 w-4"})}),(0,a.jsx)(i.Button,{type:"button",variant:"ghost",size:"sm",onClick:()=>eu(!1),children:"Cancelar"})]}):(0,a.jsx)(i.Button,{type:"button",variant:"link",className:"h-auto p-0 text-xs text-accent mt-2",onClick:()=>eu(!0),children:"+ Crear Nueva Categoría Global"})]})]})})()}),(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)(o.Label,{children:"Imagen"}),(0,a.jsx)("div",{className:"flex gap-2 items-center",children:(0,a.jsx)(n.Input,{value:T,onChange:e=>$(e.target.value),placeholder:"https://...",className:"flex-1"})}),(0,a.jsx)("p",{className:"text-xs text-muted-foreground",children:"Pega una URL externa o sube una imagen (si tienes bucket)."}),(0,a.jsxs)("div",{className:"mt-2",children:[(0,a.jsxs)(o.Label,{htmlFor:"file-upload",className:"cursor-pointer inline-flex items-center gap-2 text-sm bg-primary text-primary-foreground px-3 py-2 rounded-md transition-colors hover:bg-primary/90 focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 shadow-sm",children:[(0,a.jsx)(g.UploadCloud,{className:"h-4 w-4"}),y?"Subiendo...":"Subir desde PC (puedes seleccionar varias)"]}),(0,a.jsx)(n.Input,{id:"file-upload",type:"file",accept:"image/*",multiple:!0,className:"hidden",onChange:ew,disabled:y})]}),T&&(0,a.jsx)("div",{className:"mt-2 h-32 w-32 rounded-lg border overflow-hidden relative bg-popover",children:(0,a.jsx)("img",{src:T,alt:"Preview",className:"h-full w-full object-cover"})})]}),(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsx)(o.Label,{children:"Galería (hasta 10)"}),(0,a.jsxs)("span",{className:"text-xs text-muted-foreground",children:[E.length,"/10"]})]}),(0,a.jsxs)("div",{className:"flex gap-2",children:[(0,a.jsx)(n.Input,{value:z,onChange:e=>V(e.target.value),placeholder:"Pega otra URL de imagen...",className:"flex-1"}),(0,a.jsx)(i.Button,{type:"button",onClick:()=>{if(z.trim()&&!(E.length>=10)){let e;F(e=eh([...E,z])),!T&&e.length>0&&$(e[0]),V("")}},disabled:!z.trim()||E.length>=10,children:"Agregar"})]}),E.length>0&&(0,a.jsx)("div",{className:"space-y-2",children:E.map((e,t)=>(0,a.jsxs)("div",{className:"flex items-center gap-3 rounded-lg border bg-popover p-2",children:[(0,a.jsx)("div",{className:"h-7 w-7 rounded-md bg-primary text-primary-foreground flex items-center justify-center text-xs font-bold",children:t+1}),(0,a.jsx)("div",{className:"h-12 w-12 rounded-md overflow-hidden border bg-background flex-shrink-0",children:(0,a.jsx)("img",{src:e,alt:"Imagen",className:"h-full w-full object-cover"})}),(0,a.jsxs)("div",{className:"min-w-0 flex-1",children:[(0,a.jsx)("p",{className:"text-xs text-muted-foreground truncate",children:e}),0===t&&(0,a.jsx)("p",{className:"text-xs font-medium",children:"Principal"})]}),(0,a.jsxs)("div",{className:"flex items-center gap-1",children:[(0,a.jsx)(i.Button,{type:"button",variant:"ghost",size:"icon",className:"h-8 w-8",onClick:()=>{let a;F(a=eh([e,...E.filter(a=>a!==e)])),$(a[0]||"")},disabled:0===t,children:(0,a.jsx)(h.Star,{className:"h-4 w-4"})}),(0,a.jsx)(i.Button,{type:"button",variant:"ghost",size:"icon",className:"h-8 w-8",onClick:()=>ex(t,t-1),disabled:0===t,children:(0,a.jsx)(u,{className:"h-4 w-4"})}),(0,a.jsx)(i.Button,{type:"button",variant:"ghost",size:"icon",className:"h-8 w-8",onClick:()=>ex(t,t+1),disabled:t===E.length-1,children:(0,a.jsx)(d,{className:"h-4 w-4"})}),(0,a.jsx)(i.Button,{type:"button",variant:"ghost",size:"icon",className:"h-8 w-8",onClick:()=>{let a;F(a=E.filter(a=>a!==e)),T===e&&$(a[0]||"")},children:(0,a.jsx)(f.Trash2,{className:"h-4 w-4"})})]})]},`${e}-${t}`))})]}),(0,a.jsxs)("div",{className:"pt-4 flex gap-3 justify-end",children:[(0,a.jsx)(i.Button,{type:"button",variant:"outline",onClick:v,children:"Cancelar"}),(0,a.jsx)(i.Button,{type:"submit",className:"bg-primary text-primary-foreground hover:bg-primary/90",disabled:w||y,children:w?(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(m.Loader2,{className:"mr-2 h-4 w-4 animate-spin"})," Guardando..."]}):(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(p.Save,{className:"mr-2 h-4 w-4"})," Guardar Producto"]})})]})]})}e.s(["ProductForm",()=>b],23787)},7648,e=>{"use strict";var a=e.i(43476),t=e.i(22016),r=e.i(18566),s=e.i(67881),i=e.i(70065),n=e.i(23787),o=e.i(71689),l=e.i(87863),c=e.i(27488);function d(){let e=(0,r.useRouter)(),d=(0,l.useRoleGuard)({allowedRoles:["admin"]});return d.accessDenied?(0,a.jsx)(c.AccessDenied,{}):d.loading?(0,a.jsx)("div",{className:"p-6 text-muted-foreground",children:"Cargando..."}):(0,a.jsxs)("div",{className:"space-y-6",children:[(0,a.jsxs)("div",{className:"flex items-center justify-between gap-3",children:[(0,a.jsx)(s.Button,{variant:"ghost",className:"gap-2",asChild:!0,children:(0,a.jsxs)(t.default,{href:"/admin/productos",children:[(0,a.jsx)(o.ArrowLeft,{className:"h-4 w-4"})," Volver"]})}),(0,a.jsxs)("div",{children:[(0,a.jsx)("h1",{className:"text-3xl font-bold text-gray-900",children:"Nuevo Producto"}),(0,a.jsx)("p",{className:"text-gray-500",children:"Completa la información del producto."})]}),(0,a.jsx)("div",{})]}),(0,a.jsx)(i.Card,{className:"bg-white rounded-xl shadow-sm border",children:(0,a.jsx)(i.CardContent,{className:"p-6",children:(0,a.jsx)(n.ProductForm,{onSuccess:()=>e.push("/admin/productos"),onCancel:()=>e.push("/admin/productos")})})})]})}e.s(["default",()=>d])}]);