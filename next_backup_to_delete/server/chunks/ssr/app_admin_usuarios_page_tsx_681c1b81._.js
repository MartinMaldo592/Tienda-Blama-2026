module.exports=[44413,a=>{"use strict";var b=a.i(87924),c=a.i(72131),d=a.i(50944),e=a.i(7291),f=a.i(40695),g=a.i(5522),h=a.i(17171),i=a.i(8999),j=a.i(46639);a.i(17209);var k=a.i(98748);function l(){let a=(0,d.useRouter)(),[l,m]=(0,c.useState)(!0),n=(0,i.useRoleGuard)({allowedRoles:["admin"]}),[o,p]=(0,c.useState)([]),[q,r]=(0,c.useState)(""),[s,t]=(0,c.useState)(""),[u,v]=(0,c.useState)(""),[w,x]=(0,c.useState)(!1),y=(0,c.useCallback)(async()=>{try{let a=await (0,k.fetchAdminProfiles)();p(a||[])}catch(a){p([])}},[]);async function z(){let{data:{session:b}}=await e.supabase.auth.getSession();if(!b)return void a.push("/auth/login");x(!0);try{let a=await (0,k.createWorkerViaApi)({accessToken:b.access_token,email:q,nombre:s,password:u||null});a?.generatedPassword?alert(`Worker creado. Contrase\xf1a generada: ${a.generatedPassword}`):alert("Worker creado"),r(""),t(""),v(""),await y()}catch(a){alert(a?.message||"Error")}finally{x(!1)}}return((0,c.useEffect)(()=>{n.loading||n.accessDenied||(async()=>{m(!0),await y(),m(!1)})()},[n.loading,n.accessDenied,y]),n.loading||l)?(0,b.jsx)("div",{className:"p-10",children:"Cargando..."}):n.accessDenied?(0,b.jsx)(j.AccessDenied,{message:"Solo administradores pueden gestionar usuarios."}):(0,b.jsxs)("div",{className:"space-y-8",children:[(0,b.jsxs)("div",{className:"flex items-center justify-between",children:[(0,b.jsxs)("div",{children:[(0,b.jsx)("h1",{className:"text-3xl font-bold",children:"Usuarios"}),(0,b.jsx)("p",{className:"text-muted-foreground",children:"Crea trabajadores y revisa perfiles."})]}),(0,b.jsx)(f.Button,{variant:"outline",onClick:y,children:"Actualizar"})]}),(0,b.jsxs)("div",{className:"bg-card border border-border rounded-xl p-6 space-y-4",children:[(0,b.jsx)("h2",{className:"text-lg font-semibold",children:"Crear worker"}),(0,b.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[(0,b.jsxs)("div",{className:"space-y-2",children:[(0,b.jsx)(h.Label,{htmlFor:"email",children:"Email"}),(0,b.jsx)(g.Input,{id:"email",value:q,onChange:a=>r(a.target.value),placeholder:"worker@tienda.com"})]}),(0,b.jsxs)("div",{className:"space-y-2",children:[(0,b.jsx)(h.Label,{htmlFor:"nombre",children:"Nombre"}),(0,b.jsx)(g.Input,{id:"nombre",value:s,onChange:a=>t(a.target.value),placeholder:"Nombre del trabajador"})]}),(0,b.jsxs)("div",{className:"space-y-2",children:[(0,b.jsx)(h.Label,{htmlFor:"password",children:"Contraseña (opcional)"}),(0,b.jsx)(g.Input,{id:"password",value:u,onChange:a=>v(a.target.value),placeholder:"Si lo dejas vacío se genera"})]})]}),(0,b.jsx)("div",{className:"flex justify-end",children:(0,b.jsx)(f.Button,{onClick:z,disabled:w||!q.trim(),children:w?"Creando...":"Crear"})})]}),(0,b.jsxs)("div",{className:"bg-card border border-border rounded-xl overflow-hidden",children:[(0,b.jsx)("div",{className:"px-6 py-4 border-b border-border",children:(0,b.jsx)("h2",{className:"text-lg font-semibold",children:"Perfiles"})}),(0,b.jsx)("div",{className:"overflow-x-auto",children:(0,b.jsxs)("table",{className:"w-full text-sm",children:[(0,b.jsx)("thead",{className:"bg-popover",children:(0,b.jsxs)("tr",{children:[(0,b.jsx)("th",{className:"text-left p-3",children:"Email"}),(0,b.jsx)("th",{className:"text-left p-3",children:"Nombre"}),(0,b.jsx)("th",{className:"text-left p-3",children:"Rol"}),(0,b.jsx)("th",{className:"text-left p-3",children:"Creado"})]})}),(0,b.jsxs)("tbody",{children:[o.map(a=>(0,b.jsxs)("tr",{className:"border-t border-border",children:[(0,b.jsx)("td",{className:"p-3",children:a.email||""}),(0,b.jsx)("td",{className:"p-3",children:a.nombre||""}),(0,b.jsx)("td",{className:"p-3",children:a.role||""}),(0,b.jsx)("td",{className:"p-3",children:a.created_at?new Date(a.created_at).toLocaleString():""})]},a.id)),0===o.length&&(0,b.jsx)("tr",{children:(0,b.jsx)("td",{className:"p-6 text-muted-foreground",colSpan:4,children:"No hay perfiles."})})]})]})})]})]})}a.s(["default",()=>l])}];

//# sourceMappingURL=app_admin_usuarios_page_tsx_681c1b81._.js.map