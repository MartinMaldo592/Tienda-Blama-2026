{"version":3,"sources":["../../../../features/admin/services/dashboard.client.ts","../../../../features/admin/services/pedidos.client.ts","../../../../features/admin/services/productos.client.ts","../../../../features/admin/services/usuarios.client.ts","../../../../features/admin/services/cupones.client.ts","../../../../features/admin/services/banners.client.ts","../../../../features/admin/services/announcement-bar.client.ts","../../../../features/admin/services/incidencias.client.ts","../../../../features/admin/services/preguntas.client.ts","../../../../features/admin/services/resenas.client.ts","../../../../features/admin/services/clientes.client.ts"],"sourcesContent":["import { supabase } from \"@/lib/supabaseClient\"\r\n\r\nimport type { AdminDashboardStats, AdminRole } from \"@/features/admin/types\"\r\n\r\nexport async function fetchAdminDashboardStats(args: { role: AdminRole | string; currentUserId: string }): Promise<AdminDashboardStats> {\r\n  const role = String(args.role || \"worker\")\r\n  const currentUserId = String(args.currentUserId || \"\")\r\n\r\n  const { data: pedidos } = await supabase\r\n    .from(\"pedidos\")\r\n    .select(\"id, total, status, asignado_a, created_at\")\r\n\r\n  const deliveredSales = (pedidos || []).filter((p: any) => p.status === \"Entregado\")\r\n  const totalVentasReales = deliveredSales.reduce((sum: number, p: any) => sum + (Number(p.total) || 0), 0)\r\n\r\n  const today = new Date()\r\n  const yyyy = today.getFullYear()\r\n  const mm = String(today.getMonth() + 1).padStart(2, \"0\")\r\n  const dd = String(today.getDate()).padStart(2, \"0\")\r\n  const todayPrefix = `${yyyy}-${mm}-${dd}`\r\n\r\n  const ventasHoy = deliveredSales\r\n    .filter((p: any) => typeof p.created_at === \"string\" && p.created_at.startsWith(todayPrefix))\r\n    .reduce((sum: number, p: any) => sum + (Number(p.total) || 0), 0)\r\n\r\n  const pedidosPendientes = (pedidos || []).filter((p: any) => p.status === \"Pendiente\").length\r\n  const pedidosEnProceso = (pedidos || []).filter((p: any) => [\"Confirmado\", \"Preparando\", \"Enviado\"].includes(p.status)).length\r\n  const pedidosEntregados = deliveredSales.length\r\n\r\n  const pedidosAsignados = (pedidos || []).filter(\r\n    (p: any) => p.asignado_a === currentUserId && ![\"Fallido\", \"Devuelto\", \"Entregado\"].includes(p.status)\r\n  ).length\r\n\r\n  let totalClientes = 0\r\n  if (role === \"admin\") {\r\n    const { count } = await supabase.from(\"clientes\").select(\"*\", { count: \"exact\", head: true })\r\n    totalClientes = count || 0\r\n  }\r\n\r\n  let productosLowStock = 0\r\n  if (role === \"admin\") {\r\n    const { count } = await supabase.from(\"productos\").select(\"*\", { count: \"exact\", head: true }).lt(\"stock\", 5)\r\n    productosLowStock = count || 0\r\n  }\r\n\r\n  return {\r\n    totalVentasReales,\r\n    ventasHoy,\r\n    pedidosPendientes,\r\n    pedidosEnProceso,\r\n    pedidosEntregados,\r\n    pedidosAsignados,\r\n    totalClientes,\r\n    productosLowStock,\r\n  }\r\n}\r\n\r\nexport async function fetchAdminVentasEntregadas(args: { from: string; to: string }) {\r\n  const fromIso = args.from ? `${args.from}T00:00:00.000Z` : undefined\r\n  const toIso = args.to ? `${args.to}T23:59:59.999Z` : undefined\r\n\r\n  let query = supabase\r\n    .from(\"pedidos\")\r\n    .select(\"id, total, status, created_at, clientes (nombre, telefono, dni)\")\r\n    .eq(\"status\", \"Entregado\")\r\n    .order(\"created_at\", { ascending: false })\r\n\r\n  if (fromIso) query = query.gte(\"created_at\", fromIso)\r\n  if (toIso) query = query.lte(\"created_at\", toIso)\r\n\r\n  const { data, error } = await query\r\n  if (error) throw error\r\n  return (data as any[]) || []\r\n}\r\n\r\nexport async function fetchAdminStockBajo(args: { threshold: number }) {\r\n  const th = Number(args.threshold)\r\n  const { data, error } = await supabase\r\n    .from(\"productos\")\r\n    .select(\"id, nombre, precio, stock, imagen_url\")\r\n    .lt(\"stock\", th)\r\n    .order(\"stock\", { ascending: true })\r\n\r\n  if (error) throw error\r\n  return (data as any[]) || []\r\n}\r\n\r\nexport async function fetchAdminPedidosPendientes() {\r\n  const { data, error } = await supabase\r\n    .from(\"pedidos\")\r\n    .select(\"id, total, status, created_at, clientes (nombre, telefono, dni)\")\r\n    .eq(\"status\", \"Pendiente\")\r\n    .order(\"created_at\", { ascending: false })\r\n\r\n  if (error) throw error\r\n  return (data as any[]) || []\r\n}\r\n\r\nconst PROCESS_STATUSES = [\"Confirmado\", \"Preparando\", \"Enviado\"] as const\r\ntype ProcessStatus = (typeof PROCESS_STATUSES)[number]\r\ntype StatusFilter = ProcessStatus | \"all\"\r\n\r\nexport async function fetchAdminPedidosEnProceso(args: { status: StatusFilter; from: string; to: string }) {\r\n  const fromIso = args.from ? `${args.from}T00:00:00.000Z` : undefined\r\n  const toIso = args.to ? `${args.to}T23:59:59.999Z` : undefined\r\n\r\n  let query = supabase\r\n    .from(\"pedidos\")\r\n    .select(\"id, total, status, created_at, asignado_a, clientes (nombre, telefono, dni)\")\r\n    .in(\"status\", PROCESS_STATUSES as unknown as string[])\r\n    .order(\"created_at\", { ascending: false })\r\n\r\n  if (args.status !== \"all\") query = query.eq(\"status\", args.status)\r\n  if (fromIso) query = query.gte(\"created_at\", fromIso)\r\n  if (toIso) query = query.lte(\"created_at\", toIso)\r\n\r\n  const { data, error } = await query\r\n  if (error) throw error\r\n  return (data as any[]) || []\r\n}\r\n","import { supabase } from \"@/lib/supabaseClient\"\r\n\r\nimport type { AdminRole, PedidoItemRow, PedidoRow, ProfileRow } from \"@/features/admin/types\"\r\n\r\nexport async function fetchAdminWorkers() {\r\n  const { data, error } = await supabase.from(\"profiles\").select(\"id, email, nombre, role\").eq(\"role\", \"worker\")\r\n  if (error) throw error\r\n  return ((data as any[]) || []) as ProfileRow[]\r\n}\r\n\r\nexport async function fetchPedidosForRole(args: { role: AdminRole | string; currentUserId: string }) {\r\n  const role = String(args.role || \"worker\")\r\n  const currentUserId = String(args.currentUserId || \"\")\r\n\r\n  let query = supabase\r\n    .from(\"pedidos\")\r\n    .select(\r\n      `\r\n        *,\r\n        clientes (nombre, telefono, dni)\r\n      `\r\n    )\r\n    .order(\"created_at\", { ascending: false })\r\n\r\n  if (role === \"worker\") {\r\n    query = query.eq(\"asignado_a\", currentUserId)\r\n  }\r\n\r\n  const { data, error } = await query\r\n\r\n  if (error) {\r\n    if (String(error.message || \"\").includes(\"asignado_a\")) {\r\n      const { data: fallbackData } = await supabase\r\n        .from(\"pedidos\")\r\n        .select(`*, clientes (nombre, telefono, dni)`)\r\n        .order(\"created_at\", { ascending: false })\r\n      return ((fallbackData as any[]) || []) as PedidoRow[]\r\n    }\r\n    throw error\r\n  }\r\n\r\n  const rows = ((data as any[]) || []) as PedidoRow[]\r\n\r\n  const withWorkers = await Promise.all(\r\n    rows.map(async (pedido: any) => {\r\n      if (pedido.asignado_a) {\r\n        const { data: workerProfile } = await supabase\r\n          .from(\"profiles\")\r\n          .select(\"id, email, nombre\")\r\n          .eq(\"id\", pedido.asignado_a)\r\n          .single()\r\n        return { ...pedido, asignado_perfil: (workerProfile as any) || null }\r\n      }\r\n      return { ...pedido, asignado_perfil: null }\r\n    })\r\n  )\r\n\r\n  return withWorkers as PedidoRow[]\r\n}\r\n\r\nexport async function assignPedidoToWorker(args: { pedidoId: number; workerId: string | null }) {\r\n  const assignValue = args.workerId ? String(args.workerId) : null\r\n  const { error } = await supabase\r\n    .from(\"pedidos\")\r\n    .update({\r\n      asignado_a: assignValue,\r\n      fecha_asignacion: assignValue ? new Date().toISOString() : null,\r\n    })\r\n    .eq(\"id\", args.pedidoId)\r\n\r\n  if (error) throw error\r\n}\r\n\r\nexport async function fetchPedidoDetail(pedidoId: number) {\r\n  const { data: pedidoData, error } = await supabase\r\n    .from(\"pedidos\")\r\n    .select(\r\n      `\r\n        *,\r\n        clientes (*)\r\n      `\r\n    )\r\n    .eq(\"id\", pedidoId)\r\n    .single()\r\n\r\n  if (error) throw error\r\n\r\n  let asignadoPerfil: any = null\r\n  if ((pedidoData as any)?.asignado_a) {\r\n    const { data: workerProfile } = await supabase\r\n      .from(\"profiles\")\r\n      .select(\"id, email, nombre\")\r\n      .eq(\"id\", (pedidoData as any).asignado_a)\r\n      .single()\r\n    asignadoPerfil = workerProfile\r\n  }\r\n\r\n  const pedido = { ...(pedidoData as any), asignado_perfil: asignadoPerfil } as PedidoRow\r\n\r\n  const { data: itemsData, error: itemsErr } = await supabase\r\n    .from(\"pedido_items\")\r\n    .select(\r\n      `\r\n        *,\r\n        productos (nombre, precio, imagen_url)\r\n      `\r\n    )\r\n    .eq(\"pedido_id\", pedidoId)\r\n\r\n  if (itemsErr) throw itemsErr\r\n\r\n  return {\r\n    pedido,\r\n    items: ((itemsData as any[]) || []) as PedidoItemRow[],\r\n  }\r\n}\r\n\r\nexport async function updatePedidoStatusWithStock(args: { pedidoId: number; nextStatus: string; stockDescontado: boolean }) {\r\n  const pedidoId = Number(args.pedidoId)\r\n  const nextStatus = String(args.nextStatus || \"\")\r\n\r\n  if (nextStatus === \"Confirmado\" && !args.stockDescontado) {\r\n    const { data: itemsData, error: itemsError } = await supabase\r\n      .from(\"pedido_items\")\r\n      .select(\"producto_id, producto_variante_id, cantidad\")\r\n      .eq(\"pedido_id\", pedidoId)\r\n\r\n    if (itemsError) throw itemsError\r\n\r\n    const safeItems = (itemsData || []).filter((it: any) => it.producto_id)\r\n\r\n    for (const it of safeItems) {\r\n      const productoId = Number(it.producto_id)\r\n      const varianteId = it.producto_variante_id != null ? Number(it.producto_variante_id) : null\r\n      const qty = Number(it.cantidad || 0)\r\n      if (!productoId || qty <= 0) continue\r\n\r\n      if (varianteId) {\r\n        const { data: variante, error: varError } = await supabase\r\n          .from(\"producto_variantes\")\r\n          .select(\"stock\")\r\n          .eq(\"id\", varianteId)\r\n          .single()\r\n\r\n        if (varError) throw varError\r\n\r\n        const currentStock = Number((variante as any)?.stock ?? 0)\r\n        const newStock = Math.max(0, currentStock - qty)\r\n\r\n        const { error: updError } = await supabase.from(\"producto_variantes\").update({ stock: newStock }).eq(\"id\", varianteId)\r\n\r\n        if (updError) throw updError\r\n      } else {\r\n        const { data: producto, error: prodError } = await supabase.from(\"productos\").select(\"stock\").eq(\"id\", productoId).single()\r\n\r\n        if (prodError) throw prodError\r\n\r\n        const currentStock = Number((producto as any)?.stock ?? 0)\r\n        const newStock = Math.max(0, currentStock - qty)\r\n\r\n        const { error: updError } = await supabase.from(\"productos\").update({ stock: newStock }).eq(\"id\", productoId)\r\n\r\n        if (updError) throw updError\r\n      }\r\n    }\r\n\r\n    const { error: markError } = await supabase.from(\"pedidos\").update({ stock_descontado: true }).eq(\"id\", pedidoId)\r\n    if (markError) throw markError\r\n  }\r\n\r\n  const { error } = await supabase.from(\"pedidos\").update({ status: nextStatus }).eq(\"id\", pedidoId)\r\n  if (error) throw error\r\n}\r\n","import { supabase } from \"@/lib/supabaseClient\"\r\n\r\nexport async function fetchAdminProductos() {\r\n  const { data, error } = await supabase.from(\"productos\").select(\"*\").order(\"id\", { ascending: true })\r\n  if (error) throw error\r\n  return (data as any[]) || []\r\n}\r\n\r\nexport async function fetchAdminProductoById(id: number) {\r\n  const { data, error } = await supabase.from(\"productos\").select(\"*\").eq(\"id\", id).single()\r\n  if (error) throw error\r\n  return data as any\r\n}\r\n\r\nexport async function fetchAdminCategorias() {\r\n  const { data, error } = await supabase.from(\"categorias\").select(\"*\")\r\n  if (error) throw error\r\n  return (data as any[]) || []\r\n}\r\n\r\nexport async function createAdminCategoria(args: { nombre: string }) {\r\n  const nombre = String(args.nombre || \"\").trim()\r\n  const slug = nombre.toLowerCase().replace(/ /g, \"-\").replace(/[^\\w-]+/g, \"\")\r\n  const { data, error } = await supabase.from(\"categorias\").insert({ nombre, slug }).select().single()\r\n  if (error) throw error\r\n  return data as any\r\n}\r\n\r\nexport async function fetchProductoSpecsAndVariants(productId: number) {\r\n  const [specRes, varRes] = await Promise.all([\r\n    supabase.from(\"producto_especificaciones\").select(\"*\").eq(\"producto_id\", productId).order(\"orden\", { ascending: true }).order(\"id\", { ascending: true }),\r\n    supabase.from(\"producto_variantes\").select(\"*\").eq(\"producto_id\", productId).order(\"id\", { ascending: true }),\r\n  ])\r\n\r\n  return {\r\n    specs: (specRes.data as any[]) || [],\r\n    variants: (varRes.data as any[]) || [],\r\n  }\r\n}\r\n\r\nexport async function uploadProductImages(args: { files: File[] }) {\r\n  const files = Array.isArray(args.files) ? args.files : []\r\n  const uploadedUrls: string[] = []\r\n\r\n  for (const file of files) {\r\n    const fileExt = file.name.split(\".\").pop() || \"jpg\"\r\n    const fileName = `${Date.now()}-${Math.random().toString(16).slice(2)}.${fileExt}`\r\n    const filePath = `imagenes/${fileName}`\r\n\r\n    const { error: uploadError } = await supabase.storage.from(\"productos\").upload(filePath, file)\r\n    if (uploadError) throw uploadError\r\n\r\n    const { data } = supabase.storage.from(\"productos\").getPublicUrl(filePath)\r\n    if (data?.publicUrl) uploadedUrls.push(data.publicUrl)\r\n  }\r\n\r\n  return uploadedUrls\r\n}\r\n\r\nexport async function uploadProductVideos(args: { files: File[] }) {\r\n  const files = Array.isArray(args.files) ? args.files : []\r\n  const uploadedUrls: string[] = []\r\n\r\n  for (const file of files) {\r\n    const fileExt = file.name.split(\".\").pop() || \"mp4\"\r\n    const fileName = `${Date.now()}-${Math.random().toString(16).slice(2)}.${fileExt}`\r\n    const filePath = `videos/${fileName}`\r\n\r\n    const { error: uploadError } = await supabase.storage\r\n      .from(\"productos\")\r\n      .upload(filePath, file, { upsert: false, contentType: file.type || \"video/mp4\" })\r\n\r\n    if (uploadError) throw uploadError\r\n\r\n    const { data } = supabase.storage.from(\"productos\").getPublicUrl(filePath)\r\n    if (data?.publicUrl) uploadedUrls.push(data.publicUrl)\r\n  }\r\n\r\n  return uploadedUrls\r\n}\r\n\r\nexport async function saveAdminProductoViaApi(args: { accessToken: string; method: \"POST\" | \"PUT\"; body: unknown }) {\r\n  const res = await fetch(\"/api/admin/productos\", {\r\n    method: args.method,\r\n    headers: {\r\n      \"Content-Type\": \"application/json\",\r\n      Authorization: `Bearer ${args.accessToken}`,\r\n    },\r\n    body: JSON.stringify(args.body),\r\n  })\r\n\r\n  let json: any = null\r\n  try {\r\n    json = await res.json()\r\n  } catch (err) {\r\n    json = null\r\n  }\r\n\r\n  if (!res.ok || !json?.ok) {\r\n    throw new Error(String(json?.error || \"No se pudo guardar el producto\"))\r\n  }\r\n\r\n  return json\r\n}\r\n\r\nexport async function deleteAdminProductoViaApi(args: { accessToken: string; id: number }) {\r\n  const res = await fetch(\"/api/admin/productos\", {\r\n    method: \"DELETE\",\r\n    headers: {\r\n      \"Content-Type\": \"application/json\",\r\n      Authorization: `Bearer ${args.accessToken}`,\r\n    },\r\n    body: JSON.stringify({ id: args.id }),\r\n  })\r\n\r\n  let json: any = null\r\n  try {\r\n    json = await res.json()\r\n  } catch (err) {\r\n    json = null\r\n  }\r\n\r\n  if (!res.ok || !json?.ok) {\r\n    throw new Error(String(json?.error || \"No se pudo eliminar\"))\r\n  }\r\n\r\n  return json\r\n}\r\n","import { supabase } from \"@/lib/supabaseClient\"\r\n\r\nimport type { ProfileRow } from \"@/features/admin/types\"\r\n\r\nexport async function fetchAdminProfiles() {\r\n  const { data, error } = await supabase.from(\"profiles\").select(\"id, email, nombre, role, created_at\").order(\"created_at\", { ascending: false })\r\n  if (error) throw error\r\n  return ((data as any[]) || []) as ProfileRow[]\r\n}\r\n\r\nexport async function createWorkerViaApi(args: { accessToken: string; email: string; nombre: string; password: string | null }) {\r\n  const res = await fetch(\"/api/admin/create-worker\", {\r\n    method: \"POST\",\r\n    headers: {\r\n      \"Content-Type\": \"application/json\",\r\n      Authorization: `Bearer ${args.accessToken}`,\r\n    },\r\n    body: JSON.stringify({\r\n      email: args.email,\r\n      nombre: args.nombre,\r\n      password: args.password,\r\n    }),\r\n  })\r\n\r\n  const json = await res.json()\r\n  if (!res.ok) {\r\n    throw new Error(String(json?.error || \"Error\"))\r\n  }\r\n\r\n  return json as any\r\n}\r\n","import { supabase } from \"@/lib/supabaseClient\"\r\n\r\nexport async function fetchAdminCupones() {\r\n  const { data, error } = await supabase.from(\"cupones\").select(\"*\").order(\"created_at\", { ascending: false })\r\n  if (error) throw error\r\n  return (data as any[]) || []\r\n}\r\n\r\nexport async function createAdminCupon(payload: any) {\r\n  const { error } = await supabase.from(\"cupones\").insert(payload)\r\n  if (error) throw error\r\n}\r\n\r\nexport async function updateAdminCupon(id: number, payload: any) {\r\n  const { error } = await supabase.from(\"cupones\").update(payload).eq(\"id\", id)\r\n  if (error) throw error\r\n}\r\n\r\nexport async function deleteAdminCupon(id: number) {\r\n  const { error } = await supabase.from(\"cupones\").delete().eq(\"id\", id)\r\n  if (error) throw error\r\n}\r\n","import { supabase } from \"@/lib/supabaseClient\"\r\n\r\nexport async function fetchHomeBanners() {\r\n  const { data, error } = await supabase.from(\"home_banners\").select(\"*\").order(\"orden\", { ascending: true }).order(\"id\", { ascending: true })\r\n  if (error) throw error\r\n  return (data as any[]) || []\r\n}\r\n\r\nexport async function saveHomeBanner(args: { id?: number | null; payload: any }) {\r\n  if (args.id != null) {\r\n    const { error } = await supabase.from(\"home_banners\").update(args.payload).eq(\"id\", args.id)\r\n    if (error) throw error\r\n    return\r\n  }\r\n\r\n  const { error } = await supabase.from(\"home_banners\").insert(args.payload)\r\n  if (error) throw error\r\n}\r\n\r\nexport async function deleteHomeBanner(id: number) {\r\n  const { error } = await supabase.from(\"home_banners\").delete().eq(\"id\", id)\r\n  if (error) throw error\r\n}\r\n","import { supabase } from \"@/lib/supabaseClient\"\r\n\r\nexport type AnnouncementBarConfig = {\r\n  enabled: boolean\r\n  interval_ms: number\r\n  messages: string[]\r\n}\r\n\r\nasync function getAccessToken() {\r\n  const res = await supabase.auth.getSession()\r\n  const token = res?.data?.session?.access_token || \"\"\r\n  return token\r\n}\r\n\r\nexport async function fetchAnnouncementBarConfigViaApi() {\r\n  const token = await getAccessToken()\r\n  if (!token) throw new Error(\"No autorizado\")\r\n\r\n  const res = await fetch(\"/api/admin/announcement-bar\", {\r\n    method: \"GET\",\r\n    headers: {\r\n      Authorization: `Bearer ${token}`,\r\n    },\r\n  })\r\n\r\n  let json: any = null\r\n  try {\r\n    json = await res.json()\r\n  } catch (e) {\r\n    json = null\r\n  }\r\n\r\n  if (!res.ok || !json?.ok) {\r\n    throw new Error(String(json?.error || \"No se pudo obtener la configuraciÃ³n\"))\r\n  }\r\n\r\n  const data = (json?.data || {}) as any\r\n  return {\r\n    enabled: Boolean(data.enabled),\r\n    interval_ms: Number(data.interval_ms) || 3500,\r\n    messages: Array.isArray(data.messages) ? (data.messages as string[]) : [],\r\n  } as AnnouncementBarConfig\r\n}\r\n\r\nexport async function saveAnnouncementBarConfigViaApi(config: AnnouncementBarConfig) {\r\n  const token = await getAccessToken()\r\n  if (!token) throw new Error(\"No autorizado\")\r\n\r\n  const res = await fetch(\"/api/admin/announcement-bar\", {\r\n    method: \"PUT\",\r\n    headers: {\r\n      \"Content-Type\": \"application/json\",\r\n      Authorization: `Bearer ${token}`,\r\n    },\r\n    body: JSON.stringify(config),\r\n  })\r\n\r\n  let json: any = null\r\n  try {\r\n    json = await res.json()\r\n  } catch (e) {\r\n    json = null\r\n  }\r\n\r\n  if (!res.ok || !json?.ok) {\r\n    throw new Error(String(json?.error || \"No se pudo guardar\"))\r\n  }\r\n\r\n  return json\r\n}\r\n","import { supabase } from \"@/lib/supabaseClient\"\r\n\r\nexport async function fetchPedidosForIncidencias() {\r\n  const { data, error } = await supabase\r\n    .from(\"pedidos\")\r\n    .select(\"id, status, created_at, clientes (nombre, telefono)\")\r\n    .order(\"created_at\", { ascending: false })\r\n    .limit(200)\r\n\r\n  if (error) throw error\r\n  return (data as any[]) || []\r\n}\r\n\r\nexport async function fetchIncidencias() {\r\n  const { data, error } = await supabase\r\n    .from(\"incidencias\")\r\n    .select(\"*, pedidos (id, status, created_at, clientes (nombre, telefono))\")\r\n    .order(\"created_at\", { ascending: false })\r\n\r\n  if (error) throw error\r\n  return (data as any[]) || []\r\n}\r\n\r\nexport async function uploadIncidenciaImages(args: { pedidoId: string; files: File[] }) {\r\n  const pedidoId = String(args.pedidoId || \"\").trim()\r\n  const files = Array.isArray(args.files) ? args.files : []\r\n\r\n  const uploadedUrls: string[] = []\r\n\r\n  for (const file of files) {\r\n    const fileExt = file.name.split(\".\").pop() || \"jpg\"\r\n    const fileName = `${Date.now()}-${Math.random().toString(16).slice(2)}.${fileExt}`\r\n    const folder = pedidoId ? `incidencias/${pedidoId}` : \"incidencias\"\r\n    const filePath = `${folder}/${fileName}`\r\n\r\n    const { error: uploadError } = await supabase.storage.from(\"productos\").upload(filePath, file)\r\n    if (uploadError) throw uploadError\r\n\r\n    const { data } = supabase.storage.from(\"productos\").getPublicUrl(filePath)\r\n    if (data?.publicUrl) uploadedUrls.push(data.publicUrl)\r\n  }\r\n\r\n  return uploadedUrls\r\n}\r\n\r\nexport async function createIncidencia(payload: any) {\r\n  async function save(withFotos: boolean) {\r\n    const p: any = { ...payload }\r\n    if (!withFotos) delete p.fotos\r\n    return supabase.from(\"incidencias\").insert(p)\r\n  }\r\n\r\n  const first = await save(true)\r\n  let error = first.error\r\n  if (error && typeof (error as any).message === \"string\" && (error as any).message.toLowerCase().includes(\"fotos\")) {\r\n    const second = await save(false)\r\n    error = second.error\r\n  }\r\n\r\n  if (error) throw new Error((error as any).message)\r\n}\r\n\r\nexport async function deleteIncidencia(id: number) {\r\n  const { error } = await supabase.from(\"incidencias\").delete().eq(\"id\", id)\r\n  if (error) throw error\r\n}\r\n","import { supabase } from \"@/lib/supabaseClient\"\r\n\r\nexport async function fetchAdminQuestions() {\r\n  const { data, error } = await supabase\r\n    .from(\"product_questions\")\r\n    .select(\r\n      \"id, product_id, question, asker_name, asker_phone, published, created_at, productos(nombre), product_answers(id, answer, answered_by, created_at, published)\"\r\n    )\r\n    .order(\"created_at\", { ascending: false })\r\n    .limit(200)\r\n\r\n  if (error) throw error\r\n  return (data as any[]) || []\r\n}\r\n\r\nexport async function setQuestionPublished(args: { id: number; published: boolean }) {\r\n  const { error } = await supabase.from(\"product_questions\").update({ published: args.published }).eq(\"id\", args.id)\r\n  if (error) throw error\r\n}\r\n\r\nexport async function saveQuestionAnswer(args: { questionId: number; answer: string }) {\r\n  const answer = String(args.answer || \"\").trim()\r\n\r\n  const { data: sessionRes } = await supabase.auth.getSession()\r\n  const userId = (sessionRes as any)?.session?.user?.id || null\r\n\r\n  let answeredBy: string | null = null\r\n  if (userId) {\r\n    const { data: profile } = await supabase.from(\"profiles\").select(\"email, nombre\").eq(\"id\", userId).maybeSingle()\r\n    answeredBy = String((profile as any)?.nombre || (profile as any)?.email || \"Admin\")\r\n  }\r\n\r\n  const { data: current } = await supabase\r\n    .from(\"product_questions\")\r\n    .select(\"id, product_answers(id)\")\r\n    .eq(\"id\", args.questionId)\r\n    .maybeSingle()\r\n\r\n  const existingId =\r\n    current && Array.isArray((current as any).product_answers) && (current as any).product_answers.length > 0\r\n      ? Number((current as any).product_answers[0]?.id)\r\n      : null\r\n\r\n  if (existingId) {\r\n    const { error } = await supabase\r\n      .from(\"product_answers\")\r\n      .update({ answer, answered_by: answeredBy, published: true })\r\n      .eq(\"id\", existingId)\r\n    if (error) throw error\r\n  } else {\r\n    const { error } = await supabase\r\n      .from(\"product_answers\")\r\n      .insert({ question_id: args.questionId, answer, answered_by: answeredBy, published: true })\r\n    if (error) throw error\r\n  }\r\n\r\n  const { error: pubErr } = await supabase.from(\"product_questions\").update({ published: true }).eq(\"id\", args.questionId)\r\n  if (pubErr) throw pubErr\r\n}\r\n","import { supabase } from \"@/lib/supabaseClient\"\r\n\r\nexport async function fetchAdminReviews() {\r\n  const { data, error } = await supabase\r\n    .from(\"product_reviews\")\r\n    .select(\"id, product_id, rating, title, body, customer_name, customer_city, verified, approved, created_at, productos(nombre)\")\r\n    .order(\"created_at\", { ascending: false })\r\n    .limit(200)\r\n\r\n  if (error) throw error\r\n  return (data as any[]) || []\r\n}\r\n\r\nexport async function setReviewApproved(args: { id: number; approved: boolean }) {\r\n  const { error } = await supabase.from(\"product_reviews\").update({ approved: args.approved }).eq(\"id\", args.id)\r\n  if (error) throw error\r\n}\r\n\r\nexport async function deleteReview(id: number) {\r\n  const { error } = await supabase.from(\"product_reviews\").delete().eq(\"id\", id)\r\n  if (error) throw error\r\n}\r\n","import { supabase } from \"@/lib/supabaseClient\"\r\n\r\nexport async function fetchAdminClientes() {\r\n  const { data, error } = await supabase.from(\"clientes\").select(\"*\").order(\"id\", { ascending: false })\r\n  if (error) throw error\r\n  return (data as any[]) || []\r\n}\r\n"],"names":[],"mappings":"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"}