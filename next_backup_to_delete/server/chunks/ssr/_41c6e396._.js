module.exports=[8999,46639,a=>{"use strict";var b=a.i(72131),c=a.i(50944),d=a.i(7291);function e({allowedRoles:a}){let e=(0,c.useRouter)(),[f,g]=(0,b.useState)(!0),[h,i]=(0,b.useState)(null),[j,k]=(0,b.useState)(!1);return(0,b.useEffect)(()=>{let b=!1;return async function(){g(!0),k(!1);let c=null;try{let a=await d.supabase.auth.getSession(),b=a?.error;if(b)throw b;c=a?.data?.session??null}catch(b){let a;if((a=String(b?.message||"").toLowerCase()).includes("invalid refresh token")||a.includes("refresh token not found"))try{await d.supabase.auth.signOut()}catch(a){}e.replace("/auth/login");return}if(!c)return e.push("/auth/login");let{data:f}=await d.supabase.from("profiles").select("role").eq("id",c.user.id).maybeSingle(),h=String(f?.role||"worker");if(!b){if(i(h),!a.includes(h)){k(!0),g(!1);return}g(!1)}}(),()=>{b=!0}},[]),{loading:f,role:h,accessDenied:j}}a.s(["useRoleGuard",()=>e],8999);var f=a.i(87924),g=a.i(40695);let h=(0,a.i(70106).default)("shield-alert",[["path",{d:"M20 13c0 5-3.5 7.5-7.66 8.95a1 1 0 0 1-.67-.01C7.5 20.5 4 18 4 13V6a1 1 0 0 1 1-1c2 0 4.5-1.2 6.24-2.72a1.17 1.17 0 0 1 1.52 0C14.51 3.81 17 5 19 5a1 1 0 0 1 1 1z",key:"oel41y"}],["path",{d:"M12 8v4",key:"1got3b"}],["path",{d:"M12 16h.01",key:"1drbdi"}]]);function i({title:a="Acceso Restringido",message:b="No tienes permisos para acceder a esta secci贸n. Esta secci贸n est谩 disponible solo para administradores."}){let d=(0,c.useRouter)();return(0,f.jsxs)("div",{className:"flex flex-col items-center justify-center min-h-[60vh] text-center",children:[(0,f.jsx)("div",{className:"h-20 w-20 bg-red-100 rounded-full flex items-center justify-center mb-6",children:(0,f.jsx)(h,{className:"h-10 w-10 text-red-500"})}),(0,f.jsx)("h1",{className:"text-2xl font-bold text-gray-900 mb-2",children:a}),(0,f.jsx)("p",{className:"text-gray-500 max-w-md mb-6",children:b}),(0,f.jsx)(g.Button,{onClick:()=>d.push("/admin/dashboard"),children:"Volver al Dashboard"})]})}a.s(["AccessDenied",()=>i],46639)},21374,a=>{"use strict";let b=(0,a.i(70106).default)("star",[["path",{d:"M11.525 2.295a.53.53 0 0 1 .95 0l2.31 4.679a2.123 2.123 0 0 0 1.595 1.16l5.166.756a.53.53 0 0 1 .294.904l-3.736 3.638a2.123 2.123 0 0 0-.611 1.878l.882 5.14a.53.53 0 0 1-.771.56l-4.618-2.428a2.122 2.122 0 0 0-1.973 0L6.396 21.01a.53.53 0 0 1-.77-.56l.881-5.139a2.122 2.122 0 0 0-.611-1.879L2.16 9.795a.53.53 0 0 1 .294-.906l5.165-.755a2.122 2.122 0 0 0 1.597-1.16z",key:"r04s7s"}]]);a.s(["Star",()=>b],21374)},63588,a=>{"use strict";let b=(0,a.i(70106).default)("message-square",[["path",{d:"M22 17a2 2 0 0 1-2 2H6.828a2 2 0 0 0-1.414.586l-2.202 2.202A.71.71 0 0 1 2 21.286V5a2 2 0 0 1 2-2h16a2 2 0 0 1 2 2z",key:"18887p"}]]);a.s(["MessageSquare",()=>b],63588)},40784,a=>{"use strict";let b=(0,a.i(70106).default)("shopping-bag",[["path",{d:"M16 10a4 4 0 0 1-8 0",key:"1ltviw"}],["path",{d:"M3.103 6.034h17.794",key:"awc11p"}],["path",{d:"M3.4 5.467a2 2 0 0 0-.4 1.2V20a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2V6.667a2 2 0 0 0-.4-1.2l-2-2.667A2 2 0 0 0 17 2H7a2 2 0 0 0-1.6.8z",key:"o988cm"}]]);a.s(["ShoppingBag",()=>b],40784)},83497,a=>{"use strict";let b=(0,a.i(70106).default)("package",[["path",{d:"M11 21.73a2 2 0 0 0 2 0l7-4A2 2 0 0 0 21 16V8a2 2 0 0 0-1-1.73l-7-4a2 2 0 0 0-2 0l-7 4A2 2 0 0 0 3 8v8a2 2 0 0 0 1 1.73z",key:"1a0edw"}],["path",{d:"M12 22V12",key:"d0xqtd"}],["polyline",{points:"3.29 7 12 12 20.71 7",key:"ousv84"}],["path",{d:"m7.5 4.27 9 5.15",key:"1c824w"}]]);a.s(["Package",()=>b],83497)},60246,a=>{"use strict";let b=(0,a.i(70106).default)("users",[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["path",{d:"M16 3.128a4 4 0 0 1 0 7.744",key:"16gr8j"}],["path",{d:"M22 21v-2a4 4 0 0 0-3-3.87",key:"kshegd"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}]]);a.s(["Users",()=>b],60246)},78170,a=>{"use strict";var b=a.i(87924),c=a.i(50944),d=a.i(8999),e=a.i(46639),f=a.i(38246),g=a.i(7291),h=a.i(70106);let i=(0,h.default)("layout-dashboard",[["rect",{width:"7",height:"9",x:"3",y:"3",rx:"1",key:"10lvy0"}],["rect",{width:"7",height:"5",x:"14",y:"3",rx:"1",key:"16une8"}],["rect",{width:"7",height:"9",x:"14",y:"12",rx:"1",key:"1hutg5"}],["rect",{width:"7",height:"5",x:"3",y:"16",rx:"1",key:"ldoo1y"}]]);var j=a.i(40784),k=a.i(83497),l=a.i(60246);let m=(0,h.default)("circle-alert",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["line",{x1:"12",x2:"12",y1:"8",y2:"12",key:"1pkeuh"}],["line",{x1:"12",x2:"12.01",y1:"16",y2:"16",key:"4dfq90"}]]),n=(0,h.default)("log-out",[["path",{d:"m16 17 5-5-5-5",key:"1bji2h"}],["path",{d:"M21 12H9",key:"dn1m92"}],["path",{d:"M9 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h4",key:"1uf3rs"}]]),o=(0,h.default)("percent",[["line",{x1:"19",x2:"5",y1:"5",y2:"19",key:"1x9vlm"}],["circle",{cx:"6.5",cy:"6.5",r:"2.5",key:"4mh3h7"}],["circle",{cx:"17.5",cy:"17.5",r:"2.5",key:"1mdrzq"}]]);var p=a.i(38632),q=a.i(21374),r=a.i(63588);let s=(0,h.default)("megaphone",[["path",{d:"M11 6a13 13 0 0 0 8.4-2.8A1 1 0 0 1 21 4v12a1 1 0 0 1-1.6.8A13 13 0 0 0 11 14H5a2 2 0 0 1-2-2V8a2 2 0 0 1 2-2z",key:"q8bfy3"}],["path",{d:"M6 14a12 12 0 0 0 2.4 7.2 2 2 0 0 0 3.2-2.4A8 8 0 0 1 10 14",key:"1853fq"}],["path",{d:"M8 6v8",key:"15ugcq"}]]);function t({role:a}){let d=(0,c.useRouter)(),e=async()=>{await g.supabase.auth.signOut(),d.push("/auth/login")},h=[{href:"/admin/dashboard",icon:i,label:"Dashboard",roles:["admin","worker"]},{href:"/admin/pedidos",icon:j.ShoppingBag,label:"Pedidos",roles:["admin","worker"]},{href:"/admin/productos",icon:k.Package,label:"Productos",roles:["admin"]},{href:"/admin/clientes",icon:l.Users,label:"Clientes",roles:["admin"]},{href:"/admin/cupones",icon:o,label:"Cupones",roles:["admin"]},{href:"/admin/banners",icon:p.Image,label:"Banners",roles:["admin"]},{href:"/admin/announcement-bar",icon:s,label:"Announcement Bar",roles:["admin"]},{href:"/admin/resenas",icon:q.Star,label:"Rese帽as",roles:["admin"]},{href:"/admin/preguntas",icon:r.MessageSquare,label:"Preguntas",roles:["admin"]},{href:"/admin/usuarios",icon:l.Users,label:"Usuarios",roles:["admin"]},{href:"/admin/incidencias",icon:m,label:"Incidencias",roles:["admin","worker"]}].filter(b=>b.roles.includes(a));return(0,b.jsxs)("div",{className:"w-64 bg-sidebar h-screen text-sidebar-foreground flex flex-col fixed left-0 top-0 overflow-hidden",children:[(0,b.jsxs)("div",{className:"p-4 border-b border-border shrink-0",children:[(0,b.jsx)("h2",{className:"text-2xl font-bold bg-gradient-to-r from-blue-400 to-purple-500 bg-clip-text text-transparent",children:"CRM Pro"}),(0,b.jsx)("p",{className:"text-xs text-muted-foreground mt-1",children:"admin"===a?"Panel de Administraci贸n":"Panel de Trabajador"})]}),(0,b.jsx)("nav",{className:"flex-1 px-3 py-3 space-y-1 overflow-y-auto overscroll-contain",children:h.map(a=>(0,b.jsxs)(f.default,{href:a.href,className:"flex items-center gap-3 px-3 py-2 text-sm text-muted-foreground hover:bg-sidebar-accent hover:text-sidebar-accent-foreground rounded-lg transition-all",children:[(0,b.jsx)(a.icon,{className:"h-4 w-4"}),(0,b.jsx)("span",{children:a.label})]},a.href))}),(0,b.jsx)("div",{className:"px-3 pb-3 shrink-0",children:(0,b.jsx)("div",{className:"px-3 py-2 rounded-lg text-xs font-medium text-center bg-accent/10 text-accent-foreground border border-border",children:"admin"===a?" Administrador":" Trabajador"})}),(0,b.jsx)("div",{className:"p-3 border-t border-border shrink-0",children:(0,b.jsxs)("button",{onClick:e,className:"flex items-center gap-3 px-3 py-2 w-full text-sm text-destructive hover:bg-destructive/10 rounded-lg transition-all",children:[(0,b.jsx)(n,{className:"h-4 w-4"}),(0,b.jsx)("span",{children:"Cerrar Sesi贸n"})]})})]})}var u=a.i(96221);function v({children:a}){let f=(0,c.usePathname)(),g=(0,d.useRoleGuard)({allowedRoles:["admin","worker"]}),h=f?.includes("/admin/pedidos/")&&f?.endsWith("/ticket");return g.loading?(0,b.jsx)("div",{className:"h-screen w-full flex items-center justify-center bg-background",children:(0,b.jsxs)("div",{className:"flex flex-col items-center gap-2",children:[(0,b.jsx)(u.Loader2,{className:"h-8 w-8 animate-spin text-primary"}),(0,b.jsx)("p",{className:"text-sm text-muted-foreground",children:"Verificando acceso..."})]})}):g.accessDenied?(0,b.jsx)(e.AccessDenied,{}):h?(0,b.jsx)(b.Fragment,{children:a}):(0,b.jsxs)("div",{className:"flex h-screen bg-background",children:[(0,b.jsx)(t,{role:g.role||"worker"}),(0,b.jsx)("main",{className:"flex-1 overflow-y-auto p-8 ml-64",children:(0,b.jsx)("div",{className:"max-w-7xl mx-auto",children:a})})]})}a.s(["default",()=>v],78170)}];

//# sourceMappingURL=_41c6e396._.js.map