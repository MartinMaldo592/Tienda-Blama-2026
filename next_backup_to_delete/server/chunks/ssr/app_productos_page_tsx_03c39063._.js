module.exports=[13883,a=>{"use strict";var b=a.i(87924),c=a.i(72131);a.i(28517);var d=a.i(14119),e=a.i(40695),f=a.i(38246),g=a.i(87682),h=a.i(5522),i=a.i(97895);let j=(0,a.i(70106).default)("funnel",[["path",{d:"M10 20a1 1 0 0 0 .553.895l2 1A1 1 0 0 0 14 21v-7a2 2 0 0 1 .517-1.341L21.74 4.67A1 1 0 0 0 21 3H3a1 1 0 0 0-.742 1.67l7.225 7.989A2 2 0 0 1 10 14z",key:"sc7q7i"}]]);var k=a.i(23025),l=a.i(15618),m=a.i(87532),n=a.i(38784),o=a.i(33508),p=a.i(50944),q=a.i(88652),r=a.i(26653);function s(){return(0,b.jsx)(c.Suspense,{fallback:(0,b.jsx)("div",{className:"p-6 text-muted-foreground",children:"Cargando..."}),children:(0,b.jsx)(t,{})})}function t(){let a=(0,p.useRouter)(),s=(0,p.useSearchParams)(),t=s?.toString()??"",[u,v]=(0,c.useState)([]),[w,x]=(0,c.useState)(0),[y,z]=(0,c.useState)([]),[A,B]=(0,c.useState)(!0),[C,D]=(0,c.useState)("all"),[E,F]=(0,c.useState)(""),[G,H]=(0,c.useState)("name-asc"),[I,J]=(0,c.useState)(""),[K,L]=(0,c.useState)(""),[M,N]=(0,c.useState)(!1),[O,P]=(0,c.useState)(()=>!1),[Q,R]=(0,c.useState)(null),[S,T]=(0,c.useState)(()=>20),{addItem:U,items:V,updateQuantity:W}=(0,d.useCartStore)();async function X(a){B(!0);let{productos:b,totalCount:c}=await (0,r.listProducts)({cat:a.cat,q:a.q,sort:a.sort,min:a.min,max:a.max,stock:a.stock,page:a.page,pageSize:S});v(b),x(c),B(!1)}function Y(b,c="replace"){let d=new URLSearchParams(s?.toString());for(let[a,c]of Object.entries(b))c?d.set(a,c):d.delete(a);let e=d.toString(),f=e?`/productos?${e}`:"/productos";"push"===c?a.push(f):a.replace(f)}(0,c.useEffect)(()=>{let a=!0;return(async()=>{let b=await (0,r.listCategories)();a&&z(b||[])})(),()=>{a=!1}},[]),(0,c.useEffect)(()=>{},[]);let Z=(0,c.useMemo)(()=>{let a=new URLSearchParams(t),b=a.get("cat")??"all",c=a.get("q")??"",d=a.get("sort")??"name-asc",e=a.get("min")??"",f=a.get("max")??"",g="1"===a.get("stock"),h=Math.max(1,Number.parseInt(a.get("page")??"1",10)||1);return{cat:b,q:c,sort:["name-asc","name-desc","price-asc","price-desc","newest"].includes(d)?d:"name-asc",min:e,max:f,stock:g,page:h}},[t]);(0,c.useEffect)(()=>{X(Z)},[Z,S]),(0,c.useEffect)(()=>{D(Z.cat||"all"),F(Z.q||""),H(Z.sort),J(Z.min||""),L(Z.max||""),N(!!Z.stock)},[Z]),(0,c.useEffect)(()=>{let a=setTimeout(()=>{Y({q:E||void 0,page:void 0},"replace")},250);return()=>clearTimeout(a)},[E]);let $=Z.page,_=Math.max(1,Math.ceil(w/S));return(0,c.useEffect)(()=>{$>_&&Y({page:void 0},"replace")},[$,_]),(0,b.jsxs)("div",{className:"min-h-screen bg-background",children:[(0,b.jsx)("div",{className:"container mx-auto px-4 pt-10 pb-6 text-center",children:(0,b.jsx)("h1",{className:"text-3xl font-bold",children:"Productos"})}),(0,b.jsxs)("div",{className:"container mx-auto px-4 pb-8",children:[(0,b.jsx)("div",{className:"mb-6 max-w-xl mx-auto",children:(0,b.jsxs)("div",{className:"relative",children:[(0,b.jsx)(m.Search,{className:"absolute left-3 top-3 h-4 w-4 text-muted-foreground"}),(0,b.jsx)(h.Input,{placeholder:"Buscar productos...",className:"pl-9",value:E,onChange:a=>F(a.target.value)})]})}),(0,b.jsxs)("div",{className:"flex flex-col lg:flex-row gap-4 justify-between items-start lg:items-center border-b border-border pb-4 mb-6",children:[(0,b.jsxs)("div",{className:"flex flex-wrap items-center gap-4",children:[(0,b.jsx)("span",{className:"text-sm font-medium",children:"Filtrar:"}),(0,b.jsxs)("div",{className:"relative",children:[(0,b.jsxs)(e.Button,{variant:"cat"===Q||"all"!==C?"default":"outline",size:"sm",className:"gap-2 h-9",onClick:()=>R("cat"===Q?null:"cat"),children:["Categoría ",(0,b.jsx)(j,{className:"h-3 w-3"})]}),"cat"===Q&&(0,b.jsx)("div",{className:"absolute top-full left-0 pt-2 w-56 z-20",children:(0,b.jsx)("div",{className:"bg-white border border-border shadow-lg rounded-md p-2",children:(0,b.jsxs)("div",{className:"space-y-1 max-h-60 overflow-y-auto",children:[(0,b.jsx)("button",{onClick:()=>{D("all"),Y({cat:void 0,page:void 0},"replace"),R(null)},className:`w-full text-left text-sm px-2 py-1.5 rounded-sm hover:bg-accent ${"all"===C?"bg-accent/50 font-medium":""}`,children:"Todas"}),y.map(a=>(0,b.jsx)("button",{onClick:()=>{D(a.id.toString()),Y({cat:a.id.toString(),page:void 0},"replace"),R(null)},className:`w-full text-left text-sm px-2 py-1.5 rounded-sm hover:bg-accent ${C===a.id.toString()?"bg-accent/50 font-medium":""}`,children:a.nombre},a.id))]})})})]}),(0,b.jsxs)("div",{className:"relative",children:[(0,b.jsxs)(e.Button,{variant:"stock"===Q||M?"default":"outline",size:"sm",className:"gap-2 h-9",onClick:()=>R("stock"===Q?null:"stock"),children:["Disponibilidad ",(0,b.jsx)(j,{className:"h-3 w-3"})]}),"stock"===Q&&(0,b.jsx)("div",{className:"absolute top-full left-0 pt-2 w-48 z-20",children:(0,b.jsx)("div",{className:"bg-white border border-border shadow-lg rounded-md p-3",children:(0,b.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,b.jsx)("input",{type:"checkbox",id:"stock-filter",className:"h-4 w-4 rounded border-gray-300 text-primary focus:ring-primary",checked:M,onChange:a=>{let b=a.target.checked;N(b),Y({stock:b?"1":void 0,page:void 0},"push")}}),(0,b.jsx)("label",{htmlFor:"stock-filter",className:"text-sm cursor-pointer select-none",children:"Solo en stock"})]})})})]}),(0,b.jsxs)("div",{className:"relative",children:[(0,b.jsxs)(e.Button,{variant:"price"===Q||I||K?"default":"outline",size:"sm",className:"gap-2 h-9",onClick:()=>R("price"===Q?null:"price"),children:["Precio ",(0,b.jsx)(j,{className:"h-3 w-3"})]}),"price"===Q&&(0,b.jsx)("div",{className:"absolute top-full left-0 pt-2 w-64 z-20",children:(0,b.jsx)("div",{className:"bg-white border border-border shadow-lg rounded-md p-3",children:(0,b.jsxs)("div",{className:"flex items-center gap-2",children:[(0,b.jsxs)("div",{className:"space-y-1 flex-1",children:[(0,b.jsx)("label",{className:"text-xs text-muted-foreground",children:"Mín"}),(0,b.jsx)(h.Input,{className:"h-8 text-xs",placeholder:"0",value:I,onChange:a=>J(a.target.value),onBlur:()=>Y({min:I||void 0,page:void 0},"push")})]}),(0,b.jsxs)("div",{className:"space-y-1 flex-1",children:[(0,b.jsx)("label",{className:"text-xs text-muted-foreground",children:"Máx"}),(0,b.jsx)(h.Input,{className:"h-8 text-xs",placeholder:"9999",value:K,onChange:a=>L(a.target.value),onBlur:()=>Y({max:K||void 0,page:void 0},"push")})]})]})})})]}),Q&&(0,b.jsx)("div",{className:"fixed inset-0 z-10 bg-transparent",onClick:()=>R(null)})]}),(0,b.jsxs)("div",{className:"flex flex-wrap items-center gap-4 w-full lg:w-auto justify-between lg:justify-end",children:[(0,b.jsxs)("div",{className:"flex items-center gap-2",children:[(0,b.jsx)("span",{className:"text-sm font-medium whitespace-nowrap",children:"Ordenar por:"}),(0,b.jsxs)(g.Select,{value:G,onValueChange:a=>{H(a),Y({sort:a},"replace")},children:[(0,b.jsx)(g.SelectTrigger,{className:"w-[180px] h-9 text-sm",children:(0,b.jsx)(g.SelectValue,{placeholder:"Seleccionar"})}),(0,b.jsxs)(g.SelectContent,{children:[(0,b.jsx)(g.SelectItem,{value:"name-asc",children:"Alfabéticamente, A-Z"}),(0,b.jsx)(g.SelectItem,{value:"name-desc",children:"Alfabéticamente, Z-A"}),(0,b.jsx)(g.SelectItem,{value:"price-asc",children:"Precio, menor a mayor"}),(0,b.jsx)(g.SelectItem,{value:"price-desc",children:"Precio, mayor a menor"}),(0,b.jsx)(g.SelectItem,{value:"newest",children:"Más nuevos"})]})]})]}),(0,b.jsxs)("span",{className:"text-sm text-muted-foreground whitespace-nowrap",children:[w," productos"]})]})]}),("all"!==C||M||I||K||E)&&(0,b.jsxs)("div",{className:"flex flex-wrap items-center gap-2 mb-6",children:[E&&(0,b.jsxs)(e.Button,{variant:"secondary",size:"sm",className:"h-7 text-xs rounded-full gap-1",onClick:()=>F(""),children:["Búsqueda: ",E,(0,b.jsx)(o.X,{className:"h-3 w-3"})]}),"all"!==C&&(0,b.jsxs)(e.Button,{variant:"secondary",size:"sm",className:"h-7 text-xs rounded-full gap-1",onClick:()=>{D("all"),Y({cat:void 0,page:void 0},"replace")},children:["Categoría: ",y.find(a=>a.id.toString()===C)?.nombre||C,(0,b.jsx)(o.X,{className:"h-3 w-3"})]}),M&&(0,b.jsxs)(e.Button,{variant:"secondary",size:"sm",className:"h-7 text-xs rounded-full gap-1",onClick:()=>{N(!1),Y({stock:void 0,page:void 0},"push")},children:["Solo Stock",(0,b.jsx)(o.X,{className:"h-3 w-3"})]}),(I||K)&&(0,b.jsxs)(e.Button,{variant:"secondary",size:"sm",className:"h-7 text-xs rounded-full gap-1",onClick:()=>{J(""),L(""),Y({min:void 0,max:void 0,page:void 0},"push")},children:["Precio: ",I||"0"," - ",K||"∞",(0,b.jsx)(o.X,{className:"h-3 w-3"})]}),(0,b.jsx)(e.Button,{variant:"ghost",size:"sm",className:"h-7 text-xs text-muted-foreground hover:text-foreground",onClick:()=>{F(""),D("all"),N(!1),J(""),L(""),Y({cat:void 0,q:void 0,stock:void 0,min:void 0,max:void 0,page:void 0},"replace")},children:"Limpiar todo"})]}),A?(0,b.jsxs)("div",{className:"text-center py-20",children:[(0,b.jsx)("div",{className:"animate-spin h-8 w-8 border-4 border-primary border-t-transparent rounded-full mx-auto mb-4"}),(0,b.jsx)("p",{className:"text-muted-foreground",children:"Cargando productos..."})]}):0===w?(0,b.jsxs)("div",{className:"text-center py-20",children:[(0,b.jsx)("p",{className:"text-muted-foreground text-lg",children:"No se encontraron productos."}),E&&(0,b.jsx)(e.Button,{variant:"link",onClick:()=>F(""),children:"Limpiar búsqueda"})]}):(0,b.jsx)("div",{className:"grid grid-cols-2 md:grid-cols-3 lg:grid-cols-4 gap-4 md:gap-6",children:u.map(a=>{var c;let d=(c=a.id,V.filter(a=>a.id===c).reduce((a,b)=>a+Number(b.quantity||0),0)),g=Array.isArray(a.videos)&&a.videos.filter(Boolean).length>0;return(0,b.jsxs)("div",{className:"bg-card rounded-xl shadow-sm border border-border overflow-hidden group hover:shadow-lg transition-all",children:[(0,b.jsxs)("div",{className:"aspect-square bg-popover relative overflow-hidden",children:[(0,b.jsx)(f.default,{href:`/productos/${(0,i.slugify)(a.nombre)}-${a.id}`,className:"absolute inset-0",children:Array.isArray(a.imagenes)&&a.imagenes.filter(Boolean).length>0||a.imagen_url?(0,b.jsx)(q.ProductImageCarousel,{images:Array.isArray(a.imagenes)?(a.imagenes||[]).filter(Boolean).slice(0,10):a.imagen_url?[a.imagen_url]:[],alt:a.nombre,className:"group-hover:scale-105 transition-transform duration-300",autoPlay:!0,intervalMs:2500}):(0,b.jsx)("div",{className:"w-full h-full flex items-center justify-center text-muted-foreground",children:"Sin imagen"})}),a.stock<=0&&(0,b.jsx)("div",{className:"absolute inset-0 bg-foreground/60 flex items-center justify-center",children:(0,b.jsx)("span",{className:"text-sidebar-primary-foreground font-bold",children:"Agotado"})}),g&&(0,b.jsx)("div",{className:"absolute left-2 bottom-2",children:(0,b.jsx)("span",{className:"inline-flex items-center rounded-full bg-black/70 px-2 py-1 text-[11px] font-bold text-white",children:"Video"})})]}),(0,b.jsxs)("div",{className:"p-4",children:[(0,b.jsx)(f.default,{href:`/productos/${(0,i.slugify)(a.nombre)}-${a.id}`,className:"hover:underline",children:(0,b.jsx)("h3",{className:"font-semibold text-foreground mb-1 line-clamp-2",children:a.nombre})}),(0,b.jsx)("p",{className:"text-xl font-bold text-primary mb-3",children:(0,i.formatCurrency)(a.precio)}),a.stock>0?0===d?(0,b.jsxs)(e.Button,{className:"w-full gap-2",onClick:()=>U(a),children:[(0,b.jsx)(n.ShoppingCart,{className:"h-4 w-4"}),"Agregar"]}):(0,b.jsxs)("div",{className:"flex items-center justify-between bg-popover rounded-lg p-1",children:[(0,b.jsx)(e.Button,{variant:"ghost",size:"icon",className:"h-8 w-8",onClick:()=>W(a.id,d-1,null),children:(0,b.jsx)(k.Minus,{className:"h-4 w-4"})}),(0,b.jsx)("span",{className:"font-bold",children:d}),(0,b.jsx)(e.Button,{variant:"ghost",size:"icon",className:"h-8 w-8",onClick:()=>W(a.id,d+1,null),children:(0,b.jsx)(l.Plus,{className:"h-4 w-4"})})]}):(0,b.jsx)(e.Button,{disabled:!0,className:"w-full",children:"Sin Stock"})]})]},a.id)})}),!A&&w>0&&_>1&&(0,b.jsxs)("div",{className:"flex items-center justify-center gap-2 mt-10",children:[(0,b.jsx)(e.Button,{variant:"outline",size:"sm",disabled:$<=1,onClick:()=>Y({page:String(Math.max(1,$-1))},"push"),children:"Anterior"}),Array.from({length:_}).slice(0,100).map((a,c)=>{let d=c+1,f=1===d||d===_,g=1>=Math.abs(d-$);return f||g?(0,b.jsx)(e.Button,{variant:d===$?"default":"outline",size:"sm",onClick:()=>Y({page:1===d?void 0:String(d)},"push"),children:d},d):2===d&&$>3?(0,b.jsx)("span",{className:"px-2 text-muted-foreground",children:"…"},"gap-left"):d===_-1&&$<_-2?(0,b.jsx)("span",{className:"px-2 text-muted-foreground",children:"…"},"gap-right"):null}),(0,b.jsx)(e.Button,{variant:"outline",size:"sm",disabled:$>=_,onClick:()=>Y({page:String(Math.min(_,$+1))},"push"),children:"Siguiente"})]})]})]})}a.s(["default",()=>s],13883)}];

//# sourceMappingURL=app_productos_page_tsx_03c39063._.js.map