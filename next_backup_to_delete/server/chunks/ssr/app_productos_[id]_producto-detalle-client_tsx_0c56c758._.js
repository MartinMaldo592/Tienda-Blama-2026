module.exports=[57857,a=>{"use strict";var b=a.i(87924),c=a.i(72131),d=a.i(38246),e=a.i(50944),f=a.i(40695),g=a.i(3130),h=a.i(97895),i=a.i(88652);a.i(28517);var j=a.i(14119),k=a.i(23833),l=a.i(26653),m=a.i(210),n=a.i(16201),o=a.i(13749),p=a.i(50522),q=a.i(70106);let r=(0,q.default)("copy",[["rect",{width:"14",height:"14",x:"8",y:"8",rx:"2",ry:"2",key:"17jyea"}],["path",{d:"M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2",key:"zix9uf"}]]);var s=a.i(11156),t=a.i(23025),u=a.i(15618),v=a.i(69520);let w=(0,q.default)("send",[["path",{d:"M14.536 21.686a.5.5 0 0 0 .937-.024l6.5-19a.496.496 0 0 0-.635-.635l-19 6.5a.5.5 0 0 0-.024.937l7.93 3.18a2 2 0 0 1 1.112 1.11z",key:"1ffxy3"}],["path",{d:"m21.854 2.147-10.94 10.939",key:"12cjpa"}]]);var x=a.i(4416);let y=(0,q.default)("share-2",[["circle",{cx:"18",cy:"5",r:"3",key:"gq8acd"}],["circle",{cx:"6",cy:"12",r:"3",key:"w7nqdw"}],["circle",{cx:"18",cy:"19",r:"3",key:"1xt0gg"}],["line",{x1:"8.59",x2:"15.42",y1:"13.51",y2:"17.49",key:"47mynk"}],["line",{x1:"15.41",x2:"8.59",y1:"6.51",y2:"10.49",key:"1n3mei"}]]);var z=a.i(38784),A=a.i(10227),B=a.i(21374);let C=(0,q.default)("message-circle",[["path",{d:"M2.992 16.342a2 2 0 0 1 .094 1.167l-1.065 3.29a1 1 0 0 0 1.236 1.168l3.413-.998a2 2 0 0 1 1.099.092 10 10 0 1 0-4.777-4.719",key:"1sd12s"}]]),D=(0,q.default)("file-text",[["path",{d:"M6 22a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h8a2.4 2.4 0 0 1 1.704.706l3.588 3.588A2.4 2.4 0 0 1 20 8v12a2 2 0 0 1-2 2z",key:"1oefj6"}],["path",{d:"M14 2v5a1 1 0 0 0 1 1h5",key:"wfsgrz"}],["path",{d:"M10 9H8",key:"b1mrlr"}],["path",{d:"M16 13H8",key:"t4e002"}],["path",{d:"M16 17H8",key:"z1uh3a"}]]),E=(0,q.default)("ruler",[["path",{d:"M21.3 15.3a2.4 2.4 0 0 1 0 3.4l-2.6 2.6a2.4 2.4 0 0 1-3.4 0L2.7 8.7a2.41 2.41 0 0 1 0-3.4l2.6-2.6a2.41 2.41 0 0 1 3.4 0Z",key:"icamh8"}],["path",{d:"m14.5 12.5 2-2",key:"inckbg"}],["path",{d:"m11.5 9.5 2-2",key:"fmmyf7"}],["path",{d:"m8.5 6.5 2-2",key:"vc6u1g"}],["path",{d:"m17.5 15.5 2-2",key:"wo5hmg"}]]),F=(0,q.default)("palette",[["path",{d:"M12 22a1 1 0 0 1 0-20 10 9 0 0 1 10 9 5 5 0 0 1-5 5h-2.25a1.75 1.75 0 0 0-1.4 2.8l.3.4a1.75 1.75 0 0 1-1.4 2.8z",key:"e79jfc"}],["circle",{cx:"13.5",cy:"6.5",r:".5",fill:"currentColor",key:"1okk4w"}],["circle",{cx:"17.5",cy:"10.5",r:".5",fill:"currentColor",key:"f64h9f"}],["circle",{cx:"6.5",cy:"12.5",r:".5",fill:"currentColor",key:"qy21gx"}],["circle",{cx:"8.5",cy:"7.5",r:".5",fill:"currentColor",key:"fotxhn"}]]),G=(0,q.default)("droplets",[["path",{d:"M7 16.3c2.2 0 4-1.83 4-4.05 0-1.16-.57-2.26-1.71-3.19S7.29 6.75 7 5.3c-.29 1.45-1.14 2.84-2.29 3.76S3 11.1 3 12.25c0 2.22 1.8 4.05 4 4.05z",key:"1ptgy4"}],["path",{d:"M12.56 6.6A10.97 10.97 0 0 0 14 3.02c.5 2.5 2 4.9 4 6.5s3 3.5 3 5.5a6.98 6.98 0 0 1-11.91 4.97",key:"1sl1rz"}]]),H=(0,q.default)("lightbulb",[["path",{d:"M15 14c.2-1 .7-1.7 1.5-2.5 1-.9 1.5-2.2 1.5-3.5A6 6 0 0 0 6 8c0 1 .2 2.2 1.5 3.5.7.7 1.3 1.5 1.5 2.5",key:"1gvzjb"}],["path",{d:"M9 18h6",key:"x1upvd"}],["path",{d:"M10 22h4",key:"ceow96"}]]),I=(0,q.default)("shield",[["path",{d:"M20 13c0 5-3.5 7.5-7.66 8.95a1 1 0 0 1-.67-.01C7.5 20.5 4 18 4 13V6a1 1 0 0 1 1-1c2 0 4.5-1.2 6.24-2.72a1.17 1.17 0 0 1 1.52 0C14.51 3.81 17 5 19 5a1 1 0 0 1 1 1z",key:"oel41y"}]]),J=(0,q.default)("sparkles",[["path",{d:"M11.017 2.814a1 1 0 0 1 1.966 0l1.051 5.558a2 2 0 0 0 1.594 1.594l5.558 1.051a1 1 0 0 1 0 1.966l-5.558 1.051a2 2 0 0 0-1.594 1.594l-1.051 5.558a1 1 0 0 1-1.966 0l-1.051-5.558a2 2 0 0 0-1.594-1.594l-5.558-1.051a1 1 0 0 1 0-1.966l5.558-1.051a2 2 0 0 0 1.594-1.594z",key:"1s2grr"}],["path",{d:"M20 2v4",key:"1rf3ol"}],["path",{d:"M22 4h-4",key:"gwowj6"}],["circle",{cx:"4",cy:"20",r:"2",key:"6kqj1y"}]]);var K=a.i(38632);let L=(0,q.default)("circle-play",[["path",{d:"M9 9.003a1 1 0 0 1 1.517-.859l4.997 2.997a1 1 0 0 1 0 1.718l-4.997 2.997A1 1 0 0 1 9 14.996z",key:"kmsa83"}],["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}]]),M=(0,q.default)("star-half",[["path",{d:"M12 18.338a2.1 2.1 0 0 0-.987.244L6.396 21.01a.53.53 0 0 1-.77-.56l.881-5.139a2.12 2.12 0 0 0-.611-1.879L2.16 9.795a.53.53 0 0 1 .294-.906l5.165-.755a2.12 2.12 0 0 0 1.597-1.16l2.309-4.679A.53.53 0 0 1 12 2",key:"2ksp49"}]]);var N=a.i(50725),O=a.i(7291),P=a.i(5522),Q=a.i(46893),R=a.i(17171),S=a.i(54161);function T({value:a}){let c=Math.max(0,Math.min(5,Math.round(a)));return(0,b.jsx)("div",{className:"flex items-center gap-0.5",children:Array.from({length:5}).map((a,d)=>(0,b.jsx)(B.Star,{className:"h-4 w-4 "+(d<c?"fill-yellow-400 text-yellow-400":"text-muted-foreground")},d))})}function U({productId:a,section:d="all"}){let[e,g]=(0,c.useState)(!0),[h,i]=(0,c.useState)([]),[j,k]=(0,c.useState)([]),[l,m]=(0,c.useState)(!1),[n,o]=(0,c.useState)(!1),[p,q]=(0,c.useState)(5),[r,s]=(0,c.useState)(""),[t,u]=(0,c.useState)(""),[v,w]=(0,c.useState)(""),[x,y]=(0,c.useState)(""),[z,A]=(0,c.useState)(""),[C,D]=(0,c.useState)(""),[E,F]=(0,c.useState)(""),[G,H]=(0,c.useState)([]),[I,J]=(0,c.useState)(!1),[K,L]=(0,c.useState)(null),[M,N]=(0,c.useState)(""),[U,V]=(0,c.useState)(""),[W,X]=(0,c.useState)(""),[Y,Z]=(0,c.useState)(!1),[$,_]=(0,c.useState)(null),aa=(0,c.useRef)(null),ab=(0,c.useMemo)(()=>{let a=h.length,b=0===a?0:h.reduce((a,b)=>a+Number(b.rating||0),0)/a;return{count:a,avg:b}},[h]);async function ac(){if(!t.trim()||t.trim().length<10)return void L("Escribe una reseña más larga");J(!0),L(null);try{let b=new FormData;b.set("productId",String(a)),b.set("rating",String(p)),b.set("title",r),b.set("body",t),b.set("customerName",v),b.set("customerCity",x),b.set("orderId",z),b.set("dni",C),b.set("phone",E),G.slice(0,3).forEach(a=>b.append("photos",a));let c=await fetch("/api/reviews/submit",{method:"POST",body:b}),d=await c.json().catch(()=>null);if(!c.ok)throw Error(String(d?.error||"No se pudo enviar la reseña"));s(""),u(""),H([]);let e=!!d?.verified;L(e?"Reseña enviada. Se marcará como comprador verificado cuando sea aprobada.":"Reseña enviada. Se publicará cuando sea aprobada."),m(!1),await aa.current?.()}catch(a){L(a?.message||"Error enviando reseña")}finally{J(!1)}}async function ad(){if(!M.trim()||M.trim().length<8)return void _("Escribe una pregunta más específica");Z(!0),_(null);try{let b=await fetch("/api/questions/submit",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({productId:a,question:M,askerName:U,askerPhone:W})}),c=await b.json().catch(()=>null);if(!b.ok)throw Error(String(c?.error||"No se pudo enviar la pregunta"));N(""),_("Pregunta enviada. Se publicará cuando sea respondida/aprobada."),o(!1)}catch(a){_(a?.message||"Error enviando pregunta")}finally{Z(!1)}}return(0,c.useEffect)(()=>{let b=!1;async function c(){g(!0);let[c,d]=await Promise.all([O.supabase.from("product_reviews").select("id, rating, title, body, customer_name, customer_city, verified, created_at, photo_urls").eq("product_id",a).eq("approved",!0).order("created_at",{ascending:!1}).limit(20),O.supabase.from("product_questions").select("id, question, asker_name, created_at, product_answers(id, answer, answered_by, created_at)").eq("product_id",a).eq("published",!0).order("created_at",{ascending:!1}).limit(30)]);b||(i(c.data||[]),k(d.data||[]),g(!1))}return aa.current=c,c(),()=>{b=!0}},[a]),(0,b.jsxs)("div",{className:"space-y-6",children:[("all"===d||"reviews"===d)&&(0,b.jsxs)("div",{className:"space-y-4",children:[(0,b.jsxs)("div",{className:"flex items-start justify-between gap-4",children:[(0,b.jsxs)("div",{children:[(0,b.jsx)("div",{className:"text-lg font-bold",children:"Reseñas"}),(0,b.jsxs)("div",{className:"mt-1 flex items-center gap-2 text-sm",children:[(0,b.jsx)(T,{value:ab.avg}),(0,b.jsx)("span",{className:"text-muted-foreground",children:ab.count>0?`${ab.avg.toFixed(1)} (${ab.count} rese\xf1as)`:"Aún no hay reseñas"})]})]}),(0,b.jsx)(S.Badge,{variant:"secondary",children:"Sin cuenta"})]}),e?(0,b.jsx)("div",{className:"text-sm text-muted-foreground",children:"Cargando reseñas..."}):0===h.length?(0,b.jsx)("div",{className:"text-sm text-muted-foreground",children:"Sé el primero en dejar una reseña."}):(0,b.jsx)("div",{className:"space-y-4",children:h.map(a=>(0,b.jsxs)("div",{className:"rounded-xl border bg-card p-4",children:[(0,b.jsxs)("div",{className:"flex items-start justify-between gap-3",children:[(0,b.jsxs)("div",{className:"space-y-1",children:[(0,b.jsxs)("div",{className:"flex items-center gap-2",children:[(0,b.jsx)(T,{value:a.rating}),a.verified?(0,b.jsx)(S.Badge,{children:"Comprador verificado"}):(0,b.jsx)(S.Badge,{variant:"outline",children:"Cliente"})]}),(0,b.jsx)("div",{className:"text-sm font-semibold",children:a.title||"Reseña"}),(0,b.jsx)("div",{className:"text-sm text-muted-foreground whitespace-pre-line",children:a.body})]}),(0,b.jsxs)("div",{className:"text-xs text-muted-foreground text-right",children:[(0,b.jsx)("div",{children:a.customer_name||""}),(0,b.jsx)("div",{children:a.customer_city||""}),(0,b.jsx)("div",{children:new Date(a.created_at).toLocaleDateString()})]})]}),Array.isArray(a.photo_urls)&&a.photo_urls.length>0?(0,b.jsx)("div",{className:"mt-3 flex gap-2 overflow-x-auto",children:a.photo_urls.slice(0,6).map((a,c)=>(0,b.jsx)("img",{src:a,alt:"Foto del cliente",className:"h-20 w-20 rounded-lg border object-cover",loading:"lazy"},c))}):null]},a.id))}),(0,b.jsxs)("div",{className:"pt-2 border-t space-y-3",children:[(0,b.jsxs)("div",{className:"flex items-center justify-between gap-3",children:[(0,b.jsx)("div",{className:"text-sm font-semibold",children:"Dejar una reseña"}),l?(0,b.jsx)(f.Button,{type:"button",variant:"outline",onClick:()=>m(!1),children:"Cancelar"}):(0,b.jsx)(f.Button,{type:"button",variant:"outline",onClick:()=>{L(null),m(!0)},children:"Añadir reseña"})]}),K?(0,b.jsx)("div",{className:"text-sm text-muted-foreground",children:K}):null,l?(0,b.jsxs)("div",{className:"space-y-3",children:[(0,b.jsx)("div",{className:"flex items-center gap-2",children:Array.from({length:5}).map((a,c)=>{let d=c+1,e=d<=p;return(0,b.jsx)("button",{type:"button",onClick:()=>q(d),className:"rounded-md p-1","aria-label":`Puntaje ${d}`,children:(0,b.jsx)(B.Star,{className:"h-5 w-5 "+(e?"fill-yellow-400 text-yellow-400":"text-muted-foreground")})},d)})}),(0,b.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-3",children:[(0,b.jsxs)("div",{className:"space-y-1",children:[(0,b.jsx)(R.Label,{children:"Tu nombre (opcional)"}),(0,b.jsx)(P.Input,{value:v,onChange:a=>w(a.target.value),placeholder:"Ej: Juan"})]}),(0,b.jsxs)("div",{className:"space-y-1",children:[(0,b.jsx)(R.Label,{children:"Ciudad (opcional)"}),(0,b.jsx)(P.Input,{value:x,onChange:a=>y(a.target.value),placeholder:"Ej: Lima"})]}),(0,b.jsxs)("div",{className:"space-y-1 md:col-span-2",children:[(0,b.jsx)(R.Label,{children:"Título (opcional)"}),(0,b.jsx)(P.Input,{value:r,onChange:a=>s(a.target.value),placeholder:"Ej: Excelente calidad"})]}),(0,b.jsxs)("div",{className:"space-y-1 md:col-span-2",children:[(0,b.jsx)(R.Label,{children:"Tu reseña"}),(0,b.jsx)(Q.Textarea,{value:t,onChange:a=>u(a.target.value),placeholder:"Cuéntanos tu experiencia..."})]})]}),(0,b.jsxs)("div",{className:"rounded-xl border bg-popover p-4 space-y-2",children:[(0,b.jsx)("div",{className:"text-sm font-semibold",children:"Comprador verificado (opcional)"}),(0,b.jsx)("div",{className:"text-xs text-muted-foreground",children:"Si tienes tu número de pedido, ingrésalo junto con tu DNI y teléfono para marcar la reseña como verificada."}),(0,b.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-3",children:[(0,b.jsxs)("div",{className:"space-y-1",children:[(0,b.jsx)(R.Label,{children:"Pedido ID"}),(0,b.jsx)(P.Input,{value:z,onChange:a=>A(a.target.value),placeholder:"Ej: 123"})]}),(0,b.jsxs)("div",{className:"space-y-1",children:[(0,b.jsx)(R.Label,{children:"DNI"}),(0,b.jsx)(P.Input,{value:C,onChange:a=>D(a.target.value),placeholder:"12345678"})]}),(0,b.jsxs)("div",{className:"space-y-1",children:[(0,b.jsx)(R.Label,{children:"Teléfono"}),(0,b.jsx)(P.Input,{value:E,onChange:a=>F(a.target.value),placeholder:"999999999"})]})]})]}),(0,b.jsxs)("div",{className:"space-y-2",children:[(0,b.jsx)(R.Label,{children:"Fotos (opcional, máx 3)"}),(0,b.jsx)(P.Input,{type:"file",accept:"image/*",multiple:!0,onChange:a=>{H(Array.from(a.target.files||[]).slice(0,3))}}),(0,b.jsx)("div",{className:"text-xs text-muted-foreground",children:"Las fotos se subirán cuando envíes la reseña."})]}),(0,b.jsx)(f.Button,{type:"button",onClick:ac,disabled:I,className:"w-full md:w-auto",children:I?"Enviando...":"Enviar reseña"})]}):null]})]}),("all"===d||"questions"===d)&&(0,b.jsxs)("div",{className:"space-y-4",children:[(0,b.jsxs)("div",{className:"flex items-start justify-between gap-4",children:[(0,b.jsxs)("div",{children:[(0,b.jsx)("div",{className:"text-lg font-bold",children:"Preguntas y respuestas"}),(0,b.jsx)("div",{className:"text-sm text-muted-foreground",children:"Resuelve dudas antes de comprar"})]}),(0,b.jsx)(S.Badge,{variant:"secondary",children:"Sin cuenta"})]}),e?(0,b.jsx)("div",{className:"text-sm text-muted-foreground",children:"Cargando preguntas..."}):0===j.length?(0,b.jsx)("div",{className:"text-sm text-muted-foreground",children:"Aún no hay preguntas publicadas."}):(0,b.jsx)("div",{className:"space-y-3",children:j.map(a=>(0,b.jsxs)("div",{className:"rounded-xl border bg-card p-4",children:[(0,b.jsx)("div",{className:"text-sm font-semibold",children:a.question}),(0,b.jsxs)("div",{className:"mt-1 text-xs text-muted-foreground",children:[a.asker_name?`Por ${a.asker_name} • `:"",new Date(a.created_at).toLocaleDateString()]}),Array.isArray(a.product_answers)&&a.product_answers.length>0?(0,b.jsxs)("div",{className:"mt-3 rounded-lg bg-popover p-3",children:[(0,b.jsx)("div",{className:"text-xs font-semibold",children:"Respuesta"}),(0,b.jsx)("div",{className:"text-sm text-muted-foreground whitespace-pre-line",children:a.product_answers[0].answer})]}):null]},a.id))}),(0,b.jsxs)("div",{className:"pt-2 border-t space-y-3",children:[(0,b.jsxs)("div",{className:"flex items-center justify-between gap-3",children:[(0,b.jsx)("div",{className:"text-sm font-semibold",children:"Hacer una pregunta"}),n?(0,b.jsx)(f.Button,{type:"button",variant:"outline",onClick:()=>o(!1),children:"Cancelar"}):(0,b.jsx)(f.Button,{type:"button",variant:"outline",onClick:()=>{_(null),o(!0)},children:"Hacer una pregunta"})]}),$?(0,b.jsx)("div",{className:"text-sm text-muted-foreground",children:$}):null,n?(0,b.jsxs)("div",{className:"space-y-3",children:[(0,b.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-3",children:[(0,b.jsxs)("div",{className:"space-y-1",children:[(0,b.jsx)(R.Label,{children:"Tu nombre (opcional)"}),(0,b.jsx)(P.Input,{value:U,onChange:a=>V(a.target.value),placeholder:"Ej: Ana"})]}),(0,b.jsxs)("div",{className:"space-y-1",children:[(0,b.jsx)(R.Label,{children:"Teléfono (opcional)"}),(0,b.jsx)(P.Input,{value:W,onChange:a=>X(a.target.value),placeholder:"999999999"})]}),(0,b.jsxs)("div",{className:"space-y-1 md:col-span-2",children:[(0,b.jsx)(R.Label,{children:"Pregunta"}),(0,b.jsx)(Q.Textarea,{value:M,onChange:a=>N(a.target.value),placeholder:"Ej: ¿Qué talla recomiendas?"})]})]}),(0,b.jsx)(f.Button,{type:"button",onClick:ad,disabled:Y,className:"w-full md:w-auto",children:Y?"Enviando...":"Enviar pregunta"})]}):null]})]})]})}var V=a.i(31865),W=a.i(26116),X=a.i(97942),Y=a.i(33508);let Z=X.Root;X.Trigger;let $=X.Portal;X.Close;let _=c.forwardRef(({className:a,...c},d)=>(0,b.jsx)(X.Overlay,{ref:d,className:(0,h.cn)("fixed inset-0 z-50 bg-black/80  data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0",a),...c}));_.displayName=X.Overlay.displayName;let aa=c.forwardRef(({className:a,children:c,...d},e)=>(0,b.jsxs)($,{children:[(0,b.jsx)(_,{}),(0,b.jsxs)(X.Content,{ref:e,className:(0,h.cn)("fixed left-[50%] top-[50%] z-50 grid w-full max-w-lg translate-x-[-50%] translate-y-[-50%] gap-4 border bg-background p-6 shadow-lg duration-200 data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[state=closed]:slide-out-to-left-1/2 data-[state=closed]:slide-out-to-top-[48%] data-[state=open]:slide-in-from-left-1/2 data-[state=open]:slide-in-from-top-[48%] sm:rounded-lg",a),...d,children:[c,(0,b.jsxs)(X.Close,{className:"absolute right-4 top-4 rounded-sm opacity-70 ring-offset-background transition-opacity hover:opacity-100 focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:pointer-events-none data-[state=open]:bg-accent data-[state=open]:text-muted-foreground",children:[(0,b.jsx)(Y.X,{className:"h-4 w-4"}),(0,b.jsx)("span",{className:"sr-only",children:"Close"})]})]})]}));aa.displayName=X.Content.displayName;let ab=({className:a,...c})=>(0,b.jsx)("div",{className:(0,h.cn)("flex flex-col space-y-1.5 text-center sm:text-left",a),...c});ab.displayName="DialogHeader";let ac=c.forwardRef(({className:a,...c},d)=>(0,b.jsx)(X.Title,{ref:d,className:(0,h.cn)("text-lg font-semibold leading-none tracking-tight",a),...c}));ac.displayName=X.Title.displayName,c.forwardRef(({className:a,...c},d)=>(0,b.jsx)(X.Description,{ref:d,className:(0,h.cn)("text-sm text-muted-foreground",a),...c})).displayName=X.Description.displayName;var ad=a.i(96221),ae=a.i(24987),af=a.i(46842),ag=a.i(63519),ah=a.i(87682);a.i(61368);var ai=a.i(90078),aj=a.i(54813);let ak=["places"];function al({isOpen:a,onClose:c,product:d,variant:e}){let{isLoaded:f}=(0,V.useLoadScript)({googleMapsApiKey:"AIzaSyDXKR5IfCmDBbWWSqggb-ODoc7gTWKb1-o",libraries:ak});return a?(0,b.jsx)(Z,{open:a,onOpenChange:c,children:(0,b.jsx)(aa,{className:"max-w-md w-full p-0 gap-0 overflow-hidden rounded-xl max-h-[90vh] flex flex-col",children:(0,b.jsxs)("div",{className:"overflow-y-auto flex-1 p-6",children:[(0,b.jsx)(ab,{className:"mb-4 text-center",children:(0,b.jsxs)(ac,{className:"text-base font-bold uppercase leading-tight",children:["Envíos contraentrega en Lima y ",(0,b.jsx)("br",{})," otras provincias envíos por agencia"]})}),(0,b.jsxs)("div",{className:"mb-6 rounded-lg border bg-blue-50/50 p-3 flex gap-3 items-center",children:[(0,b.jsx)("div",{className:"h-16 w-16 shrink-0 bg-white rounded-md border p-1",children:d?.imagen_url&&(0,b.jsx)("img",{src:d.imagen_url,alt:d.nombre,className:"h-full w-full object-contain"})}),(0,b.jsxs)("div",{className:"flex-1 min-w-0",children:[(0,b.jsxs)("div",{className:"text-sm font-bold text-foreground line-clamp-2",children:[d?.nombre,e&&` - ${e.etiqueta}`]}),(0,b.jsx)("div",{className:"flex items-center gap-2 mt-1",children:(0,b.jsx)("span",{className:"bg-green-500 text-white text-[10px] font-bold px-2 py-0.5 rounded-full",children:"ENVÍO GRATIS"})})]}),(0,b.jsxs)("div",{className:"text-right",children:[d?.precio_antes&&d.precio_antes>d.precio&&(0,b.jsx)("div",{className:"text-xs text-muted-foreground line-through",children:(0,h.formatCurrency)(d.precio_antes)}),(0,b.jsx)("div",{className:"text-lg font-bold text-foreground",children:(0,h.formatCurrency)(e?.precio??d?.precio)})]})]}),f?(0,b.jsx)(an,{product:d,variant:e,onClose:c}):(0,b.jsx)("div",{className:"flex justify-center py-8",children:(0,b.jsx)(ad.Loader2,{className:"h-8 w-8 animate-spin text-primary"})})]})})}):null}let am=({icon:a,...c})=>(0,b.jsxs)("div",{className:"flex w-full items-center rounded-md border text-sm overflow-hidden h-10 ring-offset-background focus-within:ring-2 focus-within:ring-ring focus-within:ring-offset-2",children:[(0,b.jsx)("div",{className:"flex h-full w-10 items-center justify-center bg-muted/50 border-r",children:(0,b.jsx)(a,{className:"h-4 w-4 text-muted-foreground"})}),(0,b.jsx)("input",{...c,className:`flex h-full w-full bg-background px-3 py-2 placeholder:text-muted-foreground focus:outline-none disabled:cursor-not-allowed disabled:opacity-50 ${c.className||""}`})]});function an({product:a,variant:d,onClose:e}){let[g,i]=(0,c.useState)(""),[j,k]=(0,c.useState)(""),[l,m]=(0,c.useState)(""),[n,o]=(0,c.useState)(""),[p,q]=(0,c.useState)(""),[r,t]=(0,c.useState)("Lima"),[u,v]=(0,c.useState)(""),[w,x]=(0,c.useState)("lima"),[y,z]=(0,c.useState)(!1),A=Number(d?.precio??a?.precio??0),B=+A,{ready:C,value:D,setValue:E,suggestions:{status:F,data:G},clearSuggestions:H}=(0,W.default)({requestOptions:{componentRestrictions:{country:"pe"}}}),I=async a=>{E(a,!1),H(),o(a)},J=async b=>{b.preventDefault(),z(!0);let c=j.replace(/\D/g,"");if(9!==c.length){alert("El celular debe tener 9 dígitos"),z(!1);return}let f=l.replace(/\D/g,"");if(8!==f.length){alert("El DNI debe tener 8 dígitos"),z(!1);return}let h=[{id:Number(a.id),quantity:1,precio:A,nombre:String(a.nombre),producto_variante_id:d?.id?Number(d.id):null,variante_nombre:d?.etiqueta?String(d.etiqueta):null}],i=`${r}, ${u}. ${D||n}`.trim();(0,ai.buildWhatsAppPreviewMessage)({name:g,dni:f,phone:c,address:i,reference:p,locationLink:"",items:h,subtotal:B,discount:0,total:B,shippingMethod:w});try{let{orderId:a}=await (0,aj.createCheckoutOrder)({name:g,phone:c,dni:f,address:i,reference:p,locationLink:"",items:h,shippingMethod:w}),b=String(a).padStart(6,"0"),d=(0,ai.buildWhatsAppFinalMessage)({orderIdFormatted:b,name:g,dni:f,phone:c,address:i,reference:p,locationLink:"",items:h,subtotal:B,discount:0,total:B,shippingMethod:w}),j=(0,ai.buildWhatsAppUrl)("+51958279604",d);(0,ai.setLastOrderSuccessMarker)(b),window.open(j,"_blank"),e()}catch(a){alert("Error al procesar: "+a.message)}finally{z(!1)}};return(0,b.jsxs)("form",{onSubmit:J,className:"space-y-4",children:[(0,b.jsxs)("div",{className:"space-y-1",children:[(0,b.jsxs)(R.Label,{className:"text-sm font-bold",children:["Nombre y Apellidos ",(0,b.jsx)("span",{className:"text-destructive",children:"*"})]}),(0,b.jsx)(am,{icon:af.User,required:!0,placeholder:"Ej: Juan Pérez",value:g,onChange:a=>i(a.target.value)})]}),(0,b.jsxs)("div",{className:"space-y-1",children:[(0,b.jsxs)(R.Label,{className:"text-sm font-bold",children:["DNI ",(0,b.jsx)("span",{className:"text-destructive",children:"*"})]}),(0,b.jsx)(am,{icon:s.CreditCard,required:!0,placeholder:"DNI",maxLength:8,value:l,onChange:a=>m(a.target.value.replace(/\D/g,""))})]}),(0,b.jsxs)("div",{className:"space-y-1",children:[(0,b.jsxs)(R.Label,{className:"text-sm font-bold",children:["Teléfono / Whatsapp ",(0,b.jsx)("span",{className:"text-destructive",children:"*"})]}),(0,b.jsx)(am,{icon:ag.Phone,required:!0,placeholder:"Ej: 999 999 999",maxLength:11,value:j,onChange:a=>{let b=a.target.value.replace(/\D/g,""),c=b;b.length>3&&(c=b.slice(0,3)+" "+b.slice(3)),b.length>6&&(c=c.slice(0,7)+" "+b.slice(6)),k(c)}})]}),(0,b.jsxs)("div",{className:"space-y-1",children:[(0,b.jsxs)(R.Label,{className:"text-sm font-bold",children:["Provincia ",(0,b.jsx)("span",{className:"text-destructive",children:"*"})]}),(0,b.jsxs)("div",{className:"flex w-full items-center rounded-md border text-sm overflow-hidden h-10 ring-offset-background focus-within:ring-2 focus-within:ring-ring focus-within:ring-offset-2",children:[(0,b.jsx)("div",{className:"flex h-full w-10 items-center justify-center bg-muted/50 border-r",children:(0,b.jsx)(ae.MapPin,{className:"h-4 w-4 text-muted-foreground"})}),(0,b.jsxs)(ah.Select,{value:r,onValueChange:t,children:[(0,b.jsx)(ah.SelectTrigger,{className:"w-full h-full border-0 bg-transparent focus:ring-0 focus:ring-offset-0 rounded-none shadow-none px-3",children:(0,b.jsx)(ah.SelectValue,{placeholder:"Selecciona"})}),(0,b.jsxs)(ah.SelectContent,{position:"popper",className:"max-h-[200px]",children:[(0,b.jsx)(ah.SelectItem,{value:"Amazonas",children:"Amazonas"}),(0,b.jsx)(ah.SelectItem,{value:"Áncash",children:"Áncash"}),(0,b.jsx)(ah.SelectItem,{value:"Apurímac",children:"Apurímac"}),(0,b.jsx)(ah.SelectItem,{value:"Arequipa",children:"Arequipa"}),(0,b.jsx)(ah.SelectItem,{value:"Ayacucho",children:"Ayacucho"}),(0,b.jsx)(ah.SelectItem,{value:"Cajamarca",children:"Cajamarca"}),(0,b.jsx)(ah.SelectItem,{value:"Callao",children:"Callao"}),(0,b.jsx)(ah.SelectItem,{value:"Cusco",children:"Cusco"}),(0,b.jsx)(ah.SelectItem,{value:"Huancavelica",children:"Huancavelica"}),(0,b.jsx)(ah.SelectItem,{value:"Huánuco",children:"Huánuco"}),(0,b.jsx)(ah.SelectItem,{value:"Ica",children:"Ica"}),(0,b.jsx)(ah.SelectItem,{value:"Junín",children:"Junín"}),(0,b.jsx)(ah.SelectItem,{value:"La Libertad",children:"La Libertad"}),(0,b.jsx)(ah.SelectItem,{value:"Lambayeque",children:"Lambayeque"}),(0,b.jsx)(ah.SelectItem,{value:"Lima",children:"Lima"}),(0,b.jsx)(ah.SelectItem,{value:"Lima Provincias",children:"Lima Provincias"}),(0,b.jsx)(ah.SelectItem,{value:"Loreto",children:"Loreto"}),(0,b.jsx)(ah.SelectItem,{value:"Madre de Dios",children:"Madre de Dios"}),(0,b.jsx)(ah.SelectItem,{value:"Moquegua",children:"Moquegua"}),(0,b.jsx)(ah.SelectItem,{value:"Pasco",children:"Pasco"}),(0,b.jsx)(ah.SelectItem,{value:"Piura",children:"Piura"}),(0,b.jsx)(ah.SelectItem,{value:"Puno",children:"Puno"}),(0,b.jsx)(ah.SelectItem,{value:"San Martín",children:"San Martín"}),(0,b.jsx)(ah.SelectItem,{value:"Tacna",children:"Tacna"}),(0,b.jsx)(ah.SelectItem,{value:"Tumbes",children:"Tumbes"}),(0,b.jsx)(ah.SelectItem,{value:"Ucayali",children:"Ucayali"})]})]})]})]}),(0,b.jsxs)("div",{className:"space-y-1",children:[(0,b.jsxs)(R.Label,{className:"text-sm font-bold",children:["Distrito o Ciudad ",(0,b.jsx)("span",{className:"text-destructive",children:"*"})]}),(0,b.jsx)(am,{icon:ae.MapPin,required:!0,placeholder:"Ej: Miraflores",value:u,onChange:a=>v(a.target.value)})]}),(0,b.jsxs)("div",{className:"space-y-1 relative",children:[(0,b.jsxs)(R.Label,{className:"text-sm font-bold",children:["Dirección ",(0,b.jsx)("span",{className:"text-destructive",children:"*"})]}),(0,b.jsxs)("div",{className:"flex w-full items-center rounded-md border text-sm overflow-hidden h-10 ring-offset-background focus-within:ring-2 focus-within:ring-ring focus-within:ring-offset-2",children:[(0,b.jsx)("div",{className:"flex h-full w-10 items-center justify-center bg-muted/50 border-r",children:(0,b.jsx)(ae.MapPin,{className:"h-4 w-4 text-muted-foreground"})}),(0,b.jsx)("input",{value:D,onChange:a=>E(a.target.value),disabled:!C,placeholder:"Ej: Av. Larco 123",className:"flex h-full w-full bg-background px-3 py-2 placeholder:text-muted-foreground focus:outline-none disabled:cursor-not-allowed disabled:opacity-50"}),"OK"===F&&(0,b.jsx)("ul",{className:"absolute z-10 w-full bg-popover border rounded-md shadow-lg mt-1 max-h-40 overflow-auto",children:G.map(({place_id:a,description:c})=>(0,b.jsx)("li",{onClick:()=>I(c),className:"px-4 py-2 hover:bg-muted cursor-pointer text-xs",children:c},a))})]})]}),(0,b.jsxs)("div",{className:"space-y-1",children:[(0,b.jsx)(R.Label,{className:"text-sm font-bold",children:"Referencia"}),(0,b.jsx)(am,{icon:ae.MapPin,placeholder:"Ej: Al costado del grifo",value:p,onChange:a=>q(a.target.value)})]}),(0,b.jsxs)("div",{children:[(0,b.jsxs)(R.Label,{className:"mb-2 block text-sm font-bold",children:["Método de envió gratuito ",(0,b.jsx)("span",{className:"text-destructive",children:"*"})]}),(0,b.jsxs)("div",{className:"space-y-2",children:[(0,b.jsxs)("label",{className:"flex items-center gap-3 p-3 rounded-lg border cursor-pointer hover:bg-muted/50 transition-colors has-[:checked]:border-primary has-[:checked]:bg-primary/5",children:[(0,b.jsx)("input",{type:"radio",name:"shipping",value:"lima",checked:"lima"===w,onChange:a=>x(a.target.value),className:"h-4 w-4 accent-black"}),(0,b.jsx)("span",{className:"text-sm font-medium",children:"Lima"})]}),(0,b.jsxs)("label",{className:"flex items-center gap-3 p-3 rounded-lg border cursor-pointer hover:bg-muted/50 transition-colors has-[:checked]:border-primary has-[:checked]:bg-primary/5",children:[(0,b.jsx)("input",{type:"radio",name:"shipping",value:"provincia",checked:"provincia"===w,onChange:a=>x(a.target.value),className:"h-4 w-4 accent-black"}),(0,b.jsx)("span",{className:"text-sm font-medium",children:"Provincia"})]})]})]}),(0,b.jsxs)("div",{className:"bg-muted/30 -mx-6 -mb-6 p-4 mt-6 border-t space-y-3",children:[(0,b.jsxs)("div",{className:"space-y-1 text-sm",children:[(0,b.jsxs)("div",{className:"flex justify-between text-muted-foreground",children:[(0,b.jsx)("span",{children:"Subtotal"}),(0,b.jsx)("span",{children:(0,h.formatCurrency)(B)})]}),(0,b.jsxs)("div",{className:"flex justify-between text-muted-foreground",children:[(0,b.jsx)("span",{children:"Envío"}),(0,b.jsx)("span",{children:"Gratis"})]}),(0,b.jsxs)("div",{className:"flex justify-between font-bold text-lg text-foreground pt-2 border-t mt-2",children:[(0,b.jsx)("span",{children:"Total"}),(0,b.jsx)("span",{children:(0,h.formatCurrency)(B)})]})]}),(0,b.jsx)(f.Button,{type:"submit",disabled:y,className:"w-full h-12 text-base font-bold bg-black hover:bg-gray-800 text-white shadow-lg",children:y?(0,b.jsx)(ad.Loader2,{className:"animate-spin"}):`CONFIRMO MI PEDIDO POR - ${(0,h.formatCurrency)(B)}`})]})]})}function ao(){let a,q,O,P=(0,e.useParams)(),Q=(0,e.useRouter)(),R=P.id,S=(0,c.useMemo)(()=>(function(a){let b=Number(a);if(Number.isFinite(b)&&b>0)return b;let c=String(a).match(/(\d+)(?:\D*)$/);return c&&c[1]?Number(c[1]):0})(R),[R]),T=(0,k.useCartAnimationStore)(a=>a.startAnimation),[V,W]=(0,c.useState)(!0),[X,Y]=(0,c.useState)(null),[Z,$]=(0,c.useState)([]),[_,aa]=(0,c.useState)([]),[ab,ac]=(0,c.useState)(null),[ad,ae]=(0,c.useState)(!1),[af,ag]=(0,c.useState)([]),ah=(0,c.useRef)(null),ai=(0,c.useRef)(null),[aj,ak]=(0,c.useState)(!1),[am,an]=(0,c.useState)(!1),[ao,ap]=(0,c.useState)(!1),[aq,ar]=(0,c.useState)(0),[as,at]=(0,c.useState)("description"),[au,av]=(0,c.useState)(!1),[aw,ax]=(0,c.useState)(!1),{addItem:ay,items:az,updateQuantity:aA}=(0,j.useCartStore)();(0,c.useEffect)(()=>{if(!ao)return;let a=window.setTimeout(()=>{ap(!1)},1600);return()=>window.clearTimeout(a)},[ao]);let aB=(0,c.useMemo)(()=>{let a=ab??null,b=az.find(b=>b.id===S&&(b.producto_variante_id??null)===a);return b?.quantity||0},[az,S,ab]);async function aC(){if(W(!0),!S){Y(null),W(!1);return}let{producto:a,variantes:b,especificaciones:c}=await (0,l.getProductDetail)(S);Y(a);let d=Array.isArray(b)?b:[];$(d),d.length>0?ac(a=>null!=a&&d.some(b=>Number(b.id)===Number(a))?a:Number(d[0].id)):ac(null),aa(Array.isArray(c)?c:[]),W(!1)}async function aD(a){ae(!0);try{let b=await (0,l.getRecommendedProducts)(a);ag(Array.isArray(b)?b:[])}finally{ae(!1)}}(0,c.useEffect)(()=>{R&&aC()},[R]),(0,c.useEffect)(()=>{X?.id&&aD(Number(X.id))},[X?.id]);let aE=(0,c.useMemo)(()=>{let a=((Array.isArray(X?.imagenes)?X.imagenes:[])||[]).filter(Boolean).filter(a=>{let b=String(a||"").toLowerCase();return!(b.endsWith(".mp4")||b.endsWith(".webm")||b.endsWith(".mov")||b.endsWith(".m4v"))}).slice(0,10);if(a.length>0)return a;let b=X?.imagen_url?String(X.imagen_url):"",c=b.toLowerCase();return b&&!(c.endsWith(".mp4")||c.endsWith(".webm")||c.endsWith(".mov")||c.endsWith(".m4v"))?[b]:[]},[X]),aF=(0,c.useMemo)(()=>{let a,b,c=[...((Array.isArray(X?.videos)?X.videos:[])||[]).map(a=>String(a||"").trim()).filter(Boolean),...Array.isArray(X?.imagenes)?X.imagenes.map(a=>String(a||"").trim()).filter(a=>{let b=a.toLowerCase();return b.endsWith(".mp4")||b.endsWith(".webm")||b.endsWith(".mov")||b.endsWith(".m4v")}):[],...X?.imagen_url&&((b=(a=String(X.imagen_url||"").trim()).toLowerCase()).endsWith(".mp4")||b.endsWith(".webm")||b.endsWith(".mov")||b.endsWith(".m4v"))?[a]:[]],d=[];for(let a of c)if(a&&(d.includes(a)||d.push(a),d.length>=6))break;return d},[X]),[aG,aH]=(0,c.useState)(null);if((0,c.useEffect)(()=>{aH(a=>a&&aF.includes(a)?a:aF[0]||null)},[aF.join("|")]),V)return(0,b.jsx)("div",{className:"p-10 text-center text-muted-foreground",children:"Cargando producto..."});if(!X)return(0,b.jsxs)("div",{className:"space-y-4",children:[(0,b.jsxs)(f.Button,{variant:"ghost",className:"gap-2",onClick:()=>Q.push("/productos"),children:[(0,b.jsx)(m.ArrowLeft,{className:"h-4 w-4"})," Volver"]}),(0,b.jsxs)("div",{className:"bg-white rounded-xl shadow-sm border p-8 text-center",children:[(0,b.jsx)("p",{className:"text-lg font-semibold",children:"Producto no encontrado"}),(0,b.jsx)("p",{className:"text-sm text-muted-foreground mt-1",children:"Puede que haya sido eliminado o no exista."})]})]});let aI=ab&&Z.find(a=>Number(a.id)===Number(ab))||null,aJ=aI?Number(aI.stock??0):Number(X.stock||0),aK=aJ>0,aL=aK&&aJ<=5,aM=Number(aI?.precio??X?.precio??0),aN=Number(aI?.precio_antes??X?.precio_antes??0),aO=Number.isFinite(aN)&&aN>0&&Number.isFinite(aM)&&aM>0&&aN>aM,aP=aO?Math.round((1-aM/aN)*100):0,aQ=a=>{let b=ah.current;b&&b.scrollBy({left:a,behavior:"smooth"})},aR=X?.categorias?.nombre?String(X.categorias.nombre):"—",aS=X?.categoria_id?String(X.categoria_id):null,aT=async()=>{try{await navigator.clipboard.writeText(""),an(!0),setTimeout(()=>an(!1),1200)}catch(a){}},aU=async()=>{try{let a=navigator;if(a?.share)return void await a.share({title:String(X?.nombre||"Producto"),text:String(X?.nombre||"Producto"),url:""})}catch(a){}ak(a=>!a)};return(0,b.jsxs)("div",{className:"space-y-6 max-w-5xl mx-auto pb-24 md:pb-0",children:[(0,b.jsx)(al,{isOpen:aw,onClose:()=>ax(!1),product:X,variant:aI}),(0,b.jsx)("div",{className:"flex items-center justify-between gap-3",children:(0,b.jsx)(f.Button,{variant:"ghost",className:"gap-2",asChild:!0,children:(0,b.jsxs)(d.default,{href:"/productos",children:[(0,b.jsx)(m.ArrowLeft,{className:"h-4 w-4"})," Volver a productos"]})})}),(0,b.jsxs)("div",{className:"text-sm text-muted-foreground",children:[(0,b.jsx)(d.default,{href:"/",className:"hover:underline",children:"Inicio"}),(0,b.jsx)("span",{className:"mx-2",children:"/"}),(0,b.jsx)(d.default,{href:"/productos",className:"hover:underline",children:"Productos"}),(0,b.jsx)("span",{className:"mx-2",children:"/"}),aS?(0,b.jsx)(d.default,{href:`/productos?cat=${encodeURIComponent(aS)}`,className:"hover:underline",children:aR}):(0,b.jsx)("span",{children:aR}),(0,b.jsx)("span",{className:"mx-2",children:"/"}),(0,b.jsx)("span",{className:"text-foreground font-semibold",children:String(X.nombre)})]}),(0,b.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[(0,b.jsxs)("div",{className:"space-y-4",children:[(0,b.jsx)(g.Card,{className:"overflow-hidden shadow-sm border",children:(0,b.jsx)("div",{className:"aspect-square bg-popover relative group",ref:ai,children:au&&aG?(0,b.jsx)("div",{className:"absolute inset-0 flex items-center justify-center bg-black",children:(0,b.jsx)("video",{src:aG,controls:!0,playsInline:!0,className:"w-full h-full object-contain"},aG)}):(0,b.jsxs)(b.Fragment,{children:[aE.length>0?(0,b.jsx)(i.ProductImageCarousel,{images:aE,alt:X.nombre}):(0,b.jsx)("div",{className:"absolute inset-0 flex items-center justify-center text-muted-foreground",children:"Sin imagen"}),!aK&&(0,b.jsx)("div",{className:"absolute inset-0 bg-foreground/60 flex items-center justify-center",children:(0,b.jsx)("span",{className:"text-sidebar-primary-foreground font-bold",children:"Agotado"})})]})})}),au&&aF.length>1&&(0,b.jsx)("div",{className:"flex flex-wrap gap-2",children:aF.map((a,c)=>(0,b.jsxs)("button",{type:"button",onClick:()=>aH(a),className:"rounded-lg border px-3 py-2 text-xs font-semibold transition-colors "+(aG===a?"border-primary bg-primary/10":"border-border hover:bg-popover"),children:["Video ",c+1]},a))}),aF.length>0&&(0,b.jsx)(f.Button,{className:`w-full gap-2 h-12 text-base font-bold shadow-md transition-all duration-300 ${au?"bg-white text-gray-900 border-2 border-gray-200 hover:bg-gray-50 hover:border-gray-300":"bg-gradient-to-r from-red-600 to-red-500 text-white hover:from-red-700 hover:to-red-600 hover:shadow-lg hover:scale-[1.01] border-0"}`,onClick:()=>av(!au),children:au?(0,b.jsxs)(b.Fragment,{children:[(0,b.jsx)(K.Image,{className:"h-5 w-5"}),"Ver Galería de Fotos"]}):(0,b.jsxs)(b.Fragment,{children:[(0,b.jsx)(L,{className:"h-5 w-5 animate-pulse"}),"Ver Videos del Producto"]})})]}),(0,b.jsxs)("div",{className:"space-y-4",children:[(0,b.jsx)(g.Card,{className:"shadow-sm border",children:(0,b.jsxs)(g.CardContent,{className:"p-6 space-y-3",children:[(0,b.jsxs)("div",{className:"space-y-1",children:[(0,b.jsx)("div",{className:"flex items-center gap-1 mb-2",children:(0,b.jsx)("div",{className:"flex items-center",children:(q=Math.floor(a=Number(X.calificacion??5)),O=a%1>=.4,(0,b.jsxs)(b.Fragment,{children:[Array.from({length:q}).map((a,c)=>(0,b.jsx)(B.Star,{className:"h-4 w-4 fill-amber-400 text-amber-400"},`full-${c}`)),O&&(0,b.jsx)(M,{className:"h-4 w-4 fill-amber-400 text-amber-400"}),Array.from({length:5-q-!!O}).map((a,c)=>(0,b.jsx)(B.Star,{className:"h-4 w-4 text-muted-foreground/30"},`empty-${c}`)),(0,b.jsx)("span",{className:"text-sm font-semibold text-muted-foreground ml-2",children:a.toFixed(1)})]}))})}),(0,b.jsx)("h1",{className:"text-2xl md:text-3xl font-bold text-foreground",children:X.nombre}),(0,b.jsx)("div",{className:"text-sm text-muted-foreground",children:X.categorias?.nombre?(0,b.jsxs)("span",{children:["Categoría: ",X.categorias.nombre]}):(0,b.jsx)("span",{children:"Categoría: —"})})]}),Z.length>0&&(0,b.jsxs)("div",{className:"space-y-2",children:[(0,b.jsx)("div",{className:"text-sm font-semibold text-foreground",children:"Variantes"}),(0,b.jsx)("div",{className:"grid grid-cols-2 sm:grid-cols-3 gap-2",children:Z.map(a=>{let c=Number(a.id),d=(ab??null)===c,e=Number(a.stock??0);return(0,b.jsxs)("button",{type:"button",onClick:()=>ac(c),className:"rounded-lg border px-3 py-2 text-left transition-colors "+(d?"border-primary bg-primary/10":"border-border hover:bg-popover"),children:[(0,b.jsx)("div",{className:"text-sm font-semibold text-foreground line-clamp-1",children:String(a.etiqueta||"Variante")}),(0,b.jsx)("div",{className:"text-xs text-muted-foreground",children:e>0?`${e} disponibles`:"Sin stock"})]},c)})})]}),(0,b.jsxs)("div",{className:"flex items-center justify-between gap-3",children:[(0,b.jsxs)("div",{children:[(0,b.jsx)("div",{className:"text-sm text-muted-foreground",children:"Precio"}),(0,b.jsxs)("div",{className:"flex items-end gap-3 flex-wrap",children:[(0,b.jsx)("div",{className:"text-3xl font-extrabold text-primary tracking-tight",children:(0,h.formatCurrency)(aM)}),aO&&(0,b.jsxs)("div",{className:"flex items-center gap-2",children:[(0,b.jsx)("div",{className:"text-base text-muted-foreground line-through",children:(0,h.formatCurrency)(aN)}),(0,b.jsxs)("span",{className:"inline-flex items-center rounded-full bg-gradient-to-r from-rose-600 to-orange-500 px-2.5 py-1 text-xs font-extrabold text-white shadow-md ring-1 ring-white/30",children:["-",aP,"%"]})]})]})]}),(0,b.jsxs)("div",{className:"text-right",children:[(0,b.jsx)("div",{className:"text-sm text-muted-foreground",children:"Stock"}),(0,b.jsx)("div",{className:`text-sm font-semibold ${aK?"text-green-700":"text-red-700"}`,children:aK?`${aJ} disponibles`:"Sin stock"})]})]}),aL&&(0,b.jsx)("div",{className:"rounded-lg border border-amber-200 bg-amber-50 px-3 py-2 text-sm text-amber-900",children:(0,b.jsxs)("span",{className:"font-semibold",children:["Quedan ",aJ," unidades"]})}),(0,b.jsxs)("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-2 rounded-lg border bg-card p-3",children:[(0,b.jsxs)("div",{className:"flex items-center gap-2 text-xs text-muted-foreground",children:[(0,b.jsx)(A.Truck,{className:"h-4 w-4 text-foreground"}),(0,b.jsx)("span",{children:"Entrega gratuita en 24h solo Lima Metropolitana"})]}),(0,b.jsxs)("div",{className:"flex items-center gap-2 text-xs text-muted-foreground",children:[(0,b.jsx)(s.CreditCard,{className:"h-4 w-4 text-foreground"}),(0,b.jsx)("span",{children:"Pago contraentrega / Pagas al recibir tu pedido"})]}),(0,b.jsxs)("div",{className:"flex items-center gap-2 text-xs text-muted-foreground",children:[(0,b.jsx)(v.RefreshCw,{className:"h-4 w-4 text-foreground"}),(0,b.jsx)("span",{children:"Cambios y devoluciones"})]}),(0,b.jsxs)("div",{className:"flex items-center gap-2 text-xs text-muted-foreground",children:[(0,b.jsx)(x.ShieldCheck,{className:"h-4 w-4 text-foreground"}),(0,b.jsx)("span",{children:"Compra segura"})]})]}),aK?0===aB?(0,b.jsxs)("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-2",children:[(0,b.jsxs)(f.Button,{className:"w-full gap-2 h-11 border-2 border-transparent bg-gradient-to-r from-orange-500 to-amber-500 hover:from-orange-600 hover:to-amber-600 text-white shadow-lg transform hover:scale-[1.02] transition-all duration-200 font-extrabold text-base tracking-wide",onClick:()=>ax(!0),children:[(0,b.jsx)("span",{className:"drop-shadow-sm",children:"COMPRAR AHORA"}),(0,b.jsx)(p.ChevronRight,{className:"h-5 w-5 animate-pulse"})]}),(0,b.jsxs)(f.Button,{className:"w-full gap-2 h-11",onClick:()=>{if(ay(X,aI),ai.current&&aE.length>0){let a=ai.current.getBoundingClientRect();T(aE[0],a)}ar(Date.now()),ap(!0)},children:[(0,b.jsx)(z.ShoppingCart,{className:"h-4 w-4"})," Agregar al carrito"]})]}):(0,b.jsxs)("div",{className:"w-full flex items-center justify-between bg-popover rounded-lg p-2",children:[(0,b.jsx)(f.Button,{variant:"ghost",size:"icon",className:"h-10 w-10",onClick:()=>aA(Number(X.id),aB-1,ab??null),children:(0,b.jsx)(t.Minus,{className:"h-4 w-4"})}),(0,b.jsxs)("div",{className:"text-center",children:[(0,b.jsx)("div",{className:"text-xs text-muted-foreground",children:"Cantidad"}),(0,b.jsx)("div",{className:"text-lg font-bold",children:aB})]}),(0,b.jsx)(f.Button,{variant:"ghost",size:"icon",className:"h-10 w-10",onClick:()=>aA(Number(X.id),aB+1,ab??null),children:(0,b.jsx)(u.Plus,{className:"h-4 w-4"})})]}):(0,b.jsx)(f.Button,{disabled:!0,className:"w-full h-11",children:"Sin stock"}),aK&&aB>0&&(0,b.jsxs)(f.Button,{className:"w-full h-11 border-2 border-transparent bg-gradient-to-r from-orange-500 to-amber-500 hover:from-orange-600 hover:to-amber-600 text-white shadow-lg transform hover:scale-[1.02] transition-all duration-200 font-extrabold text-base tracking-wide",onClick:()=>ax(!0),children:[(0,b.jsx)("span",{className:"drop-shadow-sm",children:"COMPRAR AHORA"}),(0,b.jsx)(p.ChevronRight,{className:"h-5 w-5 animate-pulse"})]}),(0,b.jsxs)("div",{className:"relative pt-2",children:[(0,b.jsxs)(f.Button,{variant:"outline",className:"w-full gap-2 h-11 border-2 border-muted hover:border-primary hover:text-primary transition-colors",onClick:aU,children:[(0,b.jsx)(y,{className:"h-4 w-4"}),"Compartir este producto"]}),aj&&(0,b.jsx)("div",{className:"absolute bottom-full mb-2 left-0 w-full rounded-md border bg-popover p-4 shadow-md animate-in fade-in zoom-in-95 slide-in-from-bottom-2 z-50",children:(0,b.jsxs)("div",{className:"grid grid-cols-2 gap-2",children:[(0,b.jsxs)(f.Button,{variant:"outline",className:"gap-2 w-full",onClick:aT,children:[am?(0,b.jsx)(n.CheckCircle,{className:"h-4 w-4 text-green-500"}):(0,b.jsx)(r,{className:"h-4 w-4"}),"Copiar"]}),(0,b.jsxs)(f.Button,{variant:"outline",className:"gap-2 w-full",onClick:()=>{let a=`${String(X?.nombre||"Producto")}: `,b=`https://api.whatsapp.com/send/?text=${encodeURIComponent(a)}`;window.open(b,"_blank")},children:[(0,b.jsx)(w,{className:"h-4 w-4"}),"WhatsApp"]})]})})]}),(0,b.jsxs)("div",{className:"pt-4 text-xs text-muted-foreground",children:["ID: #",String(X.id).padStart(6,"0")," • ",new Date(X.created_at).toLocaleString()]})]})}),(0,b.jsxs)("div",{className:"mt-12",children:[(0,b.jsxs)("div",{className:"flex flex-wrap items-center justify-center gap-2 mb-8 select-none p-1 bg-muted/30 rounded-full w-fit mx-auto border",children:[X?.descripcion&&(0,b.jsxs)("button",{type:"button",onClick:()=>at("description"),className:`
                                        relative px-5 py-2 rounded-full text-sm font-medium transition-all duration-200 flex items-center gap-2
                                        ${"description"===as?"bg-white text-foreground shadow-sm ring-1 ring-border":"text-muted-foreground hover:text-foreground hover:bg-muted/50"}
                                    `,children:[(0,b.jsx)(D,{className:"h-4 w-4"}),(0,b.jsx)("span",{children:"Descripción"})]}),(X?.materiales||X?.tamano||X?.color||X?.cuidados||X?.uso)&&(0,b.jsxs)("button",{type:"button",onClick:()=>at("details"),className:`
                                        relative px-5 py-2 rounded-full text-sm font-medium transition-all duration-200 flex items-center gap-2
                                        ${"details"===as?"bg-white text-foreground shadow-sm ring-1 ring-border":"text-muted-foreground hover:text-foreground hover:bg-muted/50"}
                                    `,children:[(0,b.jsx)(J,{className:"h-4 w-4"}),(0,b.jsx)("span",{children:"Detalles"})]}),_.length>0&&(0,b.jsxs)("button",{type:"button",onClick:()=>at("specs"),className:`
                                        relative px-5 py-2 rounded-full text-sm font-medium transition-all duration-200 flex items-center gap-2
                                        ${"specs"===as?"bg-white text-foreground shadow-sm ring-1 ring-border":"text-muted-foreground hover:text-foreground hover:bg-muted/50"}
                                    `,children:[(0,b.jsx)(E,{className:"h-4 w-4"}),(0,b.jsx)("span",{children:"Especificaciones"})]}),(0,b.jsxs)("button",{type:"button",onClick:()=>at("reviews"),className:`
                                    relative px-5 py-2 rounded-full text-sm font-medium transition-all duration-200 flex items-center gap-2
                                    ${"reviews"===as?"bg-white text-foreground shadow-sm ring-1 ring-border":"text-muted-foreground hover:text-foreground hover:bg-muted/50"}
                                `,children:[(0,b.jsx)(B.Star,{className:"h-4 w-4"}),(0,b.jsx)("span",{children:"Valoraciones"})]}),(0,b.jsxs)("button",{type:"button",onClick:()=>at("questions"),className:`
                                    relative px-5 py-2 rounded-full text-sm font-medium transition-all duration-200 flex items-center gap-2
                                    ${"questions"===as?"bg-white text-foreground shadow-sm ring-1 ring-border":"text-muted-foreground hover:text-foreground hover:bg-muted/50"}
                                `,children:[(0,b.jsx)(C,{className:"h-4 w-4"}),(0,b.jsx)("span",{children:"Preguntas"})]})]}),(0,b.jsxs)("div",{className:"min-h-[300px] animate-in fade-in slide-in-from-bottom-4 duration-500",children:["description"===as&&X?.descripcion&&(0,b.jsx)("div",{className:"space-y-6 animate-in fade-in zoom-in-95 duration-300",children:(0,b.jsxs)("div",{className:"bg-card border rounded-2xl p-8 shadow-sm relative overflow-hidden",children:[(0,b.jsx)("div",{className:"absolute top-0 right-0 p-8 opacity-5",children:(0,b.jsx)(J,{className:"w-32 h-32 text-primary"})}),(0,b.jsxs)("h3",{className:"text-xl font-bold mb-6 flex items-center gap-2 text-primary",children:[(0,b.jsx)("span",{className:"p-2 bg-primary/10 rounded-lg",children:(0,b.jsx)(D,{className:"h-5 w-5"})}),"Descripción del Producto"]}),(0,b.jsx)("div",{className:"prose prose-sm md:prose-base text-muted-foreground whitespace-pre-line leading-relaxed max-w-none",children:X.descripcion})]})}),"details"===as&&(0,b.jsx)("div",{className:"space-y-8 animate-in fade-in zoom-in-95 duration-300",children:(0,b.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[X?.materiales&&(0,b.jsxs)("div",{className:"bg-card border rounded-xl p-5 hover:shadow-md transition-shadow duration-300 flex gap-4 items-start group",children:[(0,b.jsx)("div",{className:"p-3 bg-blue-50 dark:bg-blue-900/20 text-blue-600 dark:text-blue-400 rounded-xl group-hover:scale-110 transition-transform",children:(0,b.jsx)(I,{className:"h-6 w-6"})}),(0,b.jsxs)("div",{children:[(0,b.jsx)("h4",{className:"font-semibold text-foreground mb-1",children:"Materiales"}),(0,b.jsx)("p",{className:"text-sm text-muted-foreground leading-relaxed",children:X.materiales})]})]}),X?.tamano&&(0,b.jsxs)("div",{className:"bg-card border rounded-xl p-5 hover:shadow-md transition-shadow duration-300 flex gap-4 items-start group",children:[(0,b.jsx)("div",{className:"p-3 bg-emerald-50 dark:bg-emerald-900/20 text-emerald-600 dark:text-emerald-400 rounded-xl group-hover:scale-110 transition-transform",children:(0,b.jsx)(E,{className:"h-6 w-6"})}),(0,b.jsxs)("div",{children:[(0,b.jsx)("h4",{className:"font-semibold text-foreground mb-1",children:"Medidas"}),(0,b.jsx)("p",{className:"text-sm text-muted-foreground leading-relaxed",children:X.tamano})]})]}),X?.color&&(0,b.jsxs)("div",{className:"bg-card border rounded-xl p-5 hover:shadow-md transition-shadow duration-300 flex gap-4 items-start group",children:[(0,b.jsx)("div",{className:"p-3 bg-purple-50 dark:bg-purple-900/20 text-purple-600 dark:text-purple-400 rounded-xl group-hover:scale-110 transition-transform",children:(0,b.jsx)(F,{className:"h-6 w-6"})}),(0,b.jsxs)("div",{children:[(0,b.jsx)("h4",{className:"font-semibold text-foreground mb-1",children:"Color"}),(0,b.jsx)("p",{className:"text-sm text-muted-foreground leading-relaxed",children:X.color})]})]}),X?.cuidados&&(0,b.jsxs)("div",{className:"bg-card border rounded-xl p-5 hover:shadow-md transition-shadow duration-300 flex gap-4 items-start group",children:[(0,b.jsx)("div",{className:"p-3 bg-sky-50 dark:bg-sky-900/20 text-sky-600 dark:text-sky-400 rounded-xl group-hover:scale-110 transition-transform",children:(0,b.jsx)(G,{className:"h-6 w-6"})}),(0,b.jsxs)("div",{children:[(0,b.jsx)("h4",{className:"font-semibold text-foreground mb-1",children:"Cuidados"}),(0,b.jsx)("p",{className:"text-sm text-muted-foreground leading-relaxed",children:X.cuidados})]})]}),X?.uso&&(0,b.jsxs)("div",{className:"md:col-span-2 bg-card border rounded-xl p-5 hover:shadow-md transition-shadow duration-300 flex gap-4 items-start group",children:[(0,b.jsx)("div",{className:"p-3 bg-amber-50 dark:bg-amber-900/20 text-amber-600 dark:text-amber-400 rounded-xl group-hover:scale-110 transition-transform",children:(0,b.jsx)(H,{className:"h-6 w-6"})}),(0,b.jsxs)("div",{children:[(0,b.jsx)("h4",{className:"font-semibold text-foreground mb-1",children:"Uso Recomendado"}),(0,b.jsx)("p",{className:"text-sm text-muted-foreground leading-relaxed",children:X.uso})]})]})]})}),"specs"===as&&_.length>0&&(0,b.jsx)("div",{className:"space-y-8 animate-in fade-in zoom-in-95 duration-300",children:(0,b.jsxs)("div",{className:"rounded-2xl border bg-card overflow-hidden shadow-sm",children:[(0,b.jsx)("div",{className:"bg-muted/50 p-4 border-b",children:(0,b.jsxs)("h3",{className:"font-bold text-foreground flex items-center gap-2",children:[(0,b.jsx)(D,{className:"h-5 w-5 text-muted-foreground"}),"Especificaciones Técnicas"]})}),(0,b.jsx)("div",{className:"divide-y",children:_.map((a,c)=>(0,b.jsxs)("div",{className:"p-4 flex items-start justify-between gap-4 hover:bg-muted/30 transition-colors",children:[(0,b.jsx)("div",{className:"text-sm font-semibold text-foreground w-1/3",children:String(a.clave||"")}),(0,b.jsx)("div",{className:"text-sm text-muted-foreground text-right w-2/3 whitespace-pre-line",children:String(a.valor||"")})]},a.id))})]})}),"reviews"===as&&(0,b.jsx)("div",{className:"space-y-6",children:(0,b.jsx)("div",{className:"rounded-2xl border bg-card overflow-hidden shadow-sm p-6 md:p-8",children:(0,b.jsx)(U,{productId:Number(X.id),section:"reviews"})})}),"questions"===as&&(0,b.jsx)("div",{className:"space-y-6",children:(0,b.jsx)("div",{className:"rounded-2xl border bg-card overflow-hidden shadow-sm p-6 md:p-8",children:(0,b.jsx)(U,{productId:Number(X.id),section:"questions"})})})]})]})]})]}),(0,b.jsxs)("div",{className:"pt-2",children:[(0,b.jsxs)("div",{className:"flex items-end justify-between gap-3",children:[(0,b.jsxs)("div",{children:[(0,b.jsx)("h2",{className:"text-xl md:text-2xl font-bold text-foreground",children:"Más comprados"}),(0,b.jsx)("p",{className:"text-sm text-muted-foreground",children:"Productos populares para completar tu compra"})]}),(0,b.jsx)(d.default,{href:"/productos",className:"text-sm font-semibold text-primary hover:underline",children:"Ver más"})]}),ad?(0,b.jsx)("div",{className:"relative mt-4",children:(0,b.jsx)("div",{className:"flex gap-4 overflow-x-auto pb-2",children:Array.from({length:8}).map((a,c)=>(0,b.jsx)("div",{className:"min-w-[220px] max-w-[220px] h-[280px] rounded-xl border bg-card animate-pulse"},c))})}):0===af.length?(0,b.jsx)("div",{className:"mt-4 rounded-xl border bg-card p-6 text-sm text-muted-foreground",children:"No hay recomendaciones disponibles en este momento."}):(0,b.jsxs)("div",{className:"relative mt-4",children:[(0,b.jsx)("div",{className:"absolute left-0 top-0 bottom-0 w-10 bg-gradient-to-r from-background to-transparent pointer-events-none"}),(0,b.jsx)("div",{className:"absolute right-0 top-0 bottom-0 w-10 bg-gradient-to-l from-background to-transparent pointer-events-none"}),(0,b.jsx)("div",{className:"absolute left-2 top-1/2 -translate-y-1/2 z-10 hidden md:block",children:(0,b.jsx)(f.Button,{type:"button",variant:"secondary",size:"icon",className:"h-9 w-9 rounded-full shadow-sm",onClick:()=>aQ(-520),"aria-label":"Ver anteriores",children:(0,b.jsx)(o.ChevronLeft,{className:"h-4 w-4"})})}),(0,b.jsx)("div",{className:"absolute right-2 top-1/2 -translate-y-1/2 z-10 hidden md:block",children:(0,b.jsx)(f.Button,{type:"button",variant:"secondary",size:"icon",className:"h-9 w-9 rounded-full shadow-sm",onClick:()=>aQ(520),"aria-label":"Ver siguientes",children:(0,b.jsx)(p.ChevronRight,{className:"h-4 w-4"})})}),(0,b.jsx)("div",{ref:ah,className:"flex gap-4 overflow-x-auto scroll-smooth snap-x snap-mandatory pb-2",children:af.map(a=>(0,b.jsx)("div",{className:"snap-start min-w-[220px] max-w-[220px]",children:(0,b.jsx)(N.ProductCard,{product:a})},a.id))})]})]}),(0,b.jsx)("div",{className:"md:hidden fixed bottom-0 left-0 right-0 z-40 border-t bg-background/95 backdrop-blur",children:(0,b.jsxs)("div",{className:"max-w-5xl mx-auto px-4 py-3 flex items-center justify-between gap-3",children:[(0,b.jsxs)("div",{children:[(0,b.jsx)("div",{className:"text-xs text-muted-foreground",children:"Precio del producto"}),(0,b.jsx)("div",{className:"text-lg font-extrabold text-primary leading-none",children:(0,h.formatCurrency)(aM)})]}),(0,b.jsxs)("div",{className:"flex gap-2 flex-1",children:[(0,b.jsx)(f.Button,{variant:"outline",size:"icon",className:"h-11 w-11 border-primary text-primary hover:bg-primary hover:text-white transition-colors",disabled:!aK,onClick:()=>{if(ay(X,aI),ai.current&&aE.length>0){let a=ai.current.getBoundingClientRect();T(aE[0],a)}ar(Date.now()),ap(!0)},children:(0,b.jsx)(z.ShoppingCart,{className:"h-5 w-5"})}),(0,b.jsxs)(f.Button,{className:"h-11 flex-1 gap-2 border-2 border-transparent bg-gradient-to-r from-orange-500 to-amber-500 hover:from-orange-600 hover:to-amber-600 text-white shadow-lg font-extrabold text-base tracking-wide",disabled:!aK,onClick:()=>ax(!0),children:["COMPRAR AHORA ",(0,b.jsx)(p.ChevronRight,{className:"h-5 w-5 animate-pulse"})]})]})]})}),ao&&(0,b.jsx)("div",{className:"md:hidden fixed inset-x-0 bottom-20 z-50 flex justify-center px-4",children:(0,b.jsx)("div",{className:"w-full max-w-sm rounded-xl border border-border bg-card shadow-lg p-3 animate-in fade-in slide-in-from-bottom-4 duration-300",children:(0,b.jsxs)("div",{className:"flex items-center gap-3",children:[(0,b.jsx)("div",{className:"h-9 w-9 rounded-full bg-green-100 flex items-center justify-center text-green-700",children:(0,b.jsx)(n.CheckCircle,{className:"h-5 w-5"})}),(0,b.jsx)("div",{className:"flex-1",children:(0,b.jsx)("div",{className:"font-semibold text-foreground leading-snug",children:"Producto añadido al carrito"})})]})},aq)})]})}a.s(["default",()=>ao],57857)}];

//# sourceMappingURL=app_productos_%5Bid%5D_producto-detalle-client_tsx_0c56c758._.js.map